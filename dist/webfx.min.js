!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).webfx={})}(this,(function(t){"use strict";var e=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};const n=Object.assign,i=Object.prototype.hasOwnProperty;function o(t,e,n=" "){for(;t.length<e;)t=n+t;return t}const s=["B","KB","MB","GB"];function r(t,e,n){return t<e||"number"!=typeof t||isNaN(t)?e:t>n?n:t}function a(t,e){for(let n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),n--)}function l(t,e){if(t instanceof Array)return t.map(e);var n=0,i=new Array(t.length);for(var o of t)i[n]=e(o,n),n++;return i}function d(t,e){var n=0;for(var i of t)e(i,n++)}function h(t,e){for(const n of t)n instanceof Array?h(n,e):e(n)}function c(t,e){if(t instanceof Array)return t.find(e);var n=0;for(var i of t)if(e(i,n++))return i;return null}function u(t,e,o){if(e){if(!o)return n(t,e);for(const n in e)if(i.call(e,n)&&(!o||o.indexOf(n)>=0)){const i=e[n];t[n]=i}}return t}function m(t,e,n){if(e)for(const o in e)if(i.call(e,o)&&(!n||n.indexOf(o)>=0)){const n=e[o];o.startsWith("on")&&t[o]instanceof g?t[o].add(n):t[o]=n}return t}Array.prototype.remove=function(t){a(this,t)};const g=class{constructor(){this._cbs=void 0,this._cbs_invoking=void 0,this._hook=void 0,this._invoking=!1}get onChanged(){var t;return null!==(t=this._hook)&&void 0!==t||(this._hook=new g),this._hook}get length(){return this._cbs?this._cbs.size:0}invoke(...t){var e;if(this._cbs){if(this._invoking)throw new Error("Cannot invoke callbacks during invocation");this._invoking=!0,this._cbs.forEach((e=>{try{e.apply(this,t)}catch(t){console.error("Error in callback",t)}})),null===(e=this._cbs_invoking)||void 0===e||e.clear(),this._invoking=!1}}add(t){var e,n;return void 0===this._cbs&&(this._cbs=new Set),this._invoking?(null!==(e=this._cbs_invoking)&&void 0!==e||(this._cbs_invoking=new Set),this._cbs_invoking.add(t)):this._cbs.add(t),null===(n=this._hook)||void 0===n||n.invoke(!0,t),t}remove(t){var e,n;void 0!==this._cbs&&(this._invoking&&(null===(e=this._cbs_invoking)||void 0===e||e.delete(t)),this._cbs.delete(t),null===(n=this._hook)||void 0===n||n.invoke(!1,t))}};class p{constructor(t){this._value=void 0,this._onChanged=void 0,this._value=t}get onChanged(){return this._onChanged||(this._onChanged=new g),this._onChanged}get value(){return this._value}set value(t){this._value=t,this._onChanged&&this.onChanged.invoke(this)}static from(t){const e=new p;return e._value=t,e}}class v{constructor(e){this.parentView=void 0,this._position=void 0,this._domctx=new E,this._dom=void 0,this._baseView=void 0,this._mountState=t.MountState.Unmounted,this._onActive=void 0,this._childViews=void 0,this._domctx.view=this,e&&this.domExprCreated(e)}static getView(t){return t instanceof v?t:new v(t)}get position(){return this._position}get dom(){return this.ensureDom(),this._dom}get domCreated(){return!!this._dom}get baseView(){return this._baseView}get mountState(){return this._mountState}get hidden(){return this.dom.hidden}set hidden(t){this.dom.hidden=t}ensureDom(){if(!this._dom){var t=this.createDom();this.domExprCreated(t)}}domExprCreated(t){var e=O(t,this._domctx);e instanceof v?(this._baseView=e,this._dom=e.dom):this._dom=e,this.postCreateDom(),this.updateDom()}createDom(){return document.createElement("div")}postCreateDom(){v.debugging&&this.dom.dataset&&(this.dom.dataset.webfx=t.MountState[this._mountState])}updateDom(){this._domctx.update()}mountStateChanged(e){if(e!=this._mountState){if(this._mountState=e,v.debugging&&!this._baseView&&this.domCreated&&this.dom.dataset&&(this.dom.dataset.webfx==t.MountState[e]&&console.trace("mountState on the DOM is changed by other view",e,this),this.dom.dataset.webfx=t.MountState[e]),this._baseView)this._baseView.mountStateChanged(e);else if(this._childViews)for(const t of this._childViews)t.mountStateChanged(e)}else console.trace("mountState unchanged",e,this)}getDomById(t){var e,n;return this.ensureDom(),null!==(n=null===(e=this._domctx.dict)||void 0===e?void 0:e[t])&&void 0!==n?n:null}updateWith(t){u(this,t),this.updateDom()}updateAllWith(t){u(this,t),this.updateAll()}toggleClass(t,e){H(this.dom,t,e)}getDOM(){return this.dom}addChild(t){const e=O(t,this._domctx);e instanceof v?this.appendView(e):this.dom.appendChild(e)}get onActive(){return this._onActive||(this._onActive=new g,this.dom.addEventListener("click",(t=>{this._onActive.invoke(t)})),this.dom.addEventListener("keydown",(t=>{this.handleKeyDown(t)}))),this._onActive}handleKeyDown(t){var e;if("Enter"===t.code){const n=this.dom.getBoundingClientRect();null===(e=this._onActive)||void 0===e||e.invoke(new MouseEvent("click",{clientX:n.x,clientY:n.y,relatedTarget:this.dom})),t.preventDefault()}}get childViews(){return this._baseView?this._baseView.childViews:(this._childViews||(this._childViews=[]),this._childViews)}appendView(t){this.addView(t)}addView(e,n){this._registerChild(e,n,!1),this._mountState==t.MountState.Mounted&&e.mountStateChanged(t.MountState.Mounting),this._insertToDom(e,n),this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(this._mountState)}_registerChild(e,n,i=!0){const o=this.childViews;if(e.parentView)throw new Error("the view is already in a container view");if(e.parentView=this,void 0===n)e._position=o.length,o.push(e);else{o.splice(n,0,e);for(let t=n;t<o.length;t++)o[t]._position=t}i&&this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(this._mountState)}removeView(e){e=this._ensureItem(e),this._removeFromDom(e);var n=e._position;e.parentView=e._position=void 0,this.childViews.splice(n,1);for(let t=n;t<this.childViews.length;t++)this.childViews[t]._position=t;this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(t.MountState.Unmounted)}removeAllView(){for(;this.childViews.length;)this.removeView(this.childViews.length-1)}removeFromParent(){this.parentView&&this.parentView.removeView(this)}updateAll(){if(this.updateDom(),this.baseView)return this.baseView.updateAll();this.updateChildren()}updateChildren(){if(this._childViews)for(const t of this._childViews)t.updateAll()}_insertToDom(t,e){var n;null==e?this.dom.appendChild(t.dom):this.dom.insertBefore(t.dom,(null===(n=this.childViews[e+1])||void 0===n?void 0:n.dom)||null)}_removeFromDom(t){t.domCreated&&t.dom.remove()}_ensureItem(t){if("number"==typeof t)t=this.childViews[t];else{if(!t)throw new Error("item is null or undefined.");if(t.parentView!==this)throw new Error("the item is not in this listview.")}return t}}function f(t){return t?t instanceof v?t.getDOM():t instanceof Node?t:t&&"getDOM"in t?t.getDOM():void 0:t}function w(t){var e=f(t);if(!e)throw console.error("getDOM():",t),new Error("getDOM(): unsupported parameter: "+t);return e}function x(t,e){y(t,e),w(t).appendChild(e.dom)}function b(t,e){if(t instanceof v)t.addChild(e);else if(t instanceof Node)y(t,e),t.appendChild(M(e));else{if(!("addChild"in t))throw console.error("addChild():",{parent:t,child:e}),new Error("addChild(): unsupported parent");t.addChild(e)}}function y(t,e){if(e instanceof v){const n={parent:t,child:e};t instanceof Node?console.trace("Should use `mountView()` to mount a view to DOM.",n):console.trace("Should use `View.addChild()` or `View.appendView()` to add a view into another view.",n)}}function _(e,n){n.mountStateChanged(t.MountState.Mounting),e.appendChild(n.dom),n.mountStateChanged(t.MountState.Mounted)}function C(e,n){n.dom.remove(),n.mountStateChanged(t.MountState.Unmounted)}v.debugging=!1,Node.prototype.getDOM=function(){return console.trace("webfx: Node.getDOM() is deprecated. Please use the exported function `getDOM()` instead."),this},Node.prototype.addChild=function(t){console.trace("webfx: Node.addChild() is deprecated. Please use the exported function `addChild()` instead."),b(this,t)},Node.prototype.appendView=function(t){console.trace("webfx: Node.appendView() is deprecated. Please use the exported function `appendView()` instead."),x(this,t)};class k extends v{addView(t,e){return super.addView(t,e)}removeView(t){super.removeView(t)}_insertToDom(t,e){super._insertToDom(t,e)}_removeFromDom(t){super._removeFromDom(t)}_ensureItem(t){return super._ensureItem(t)}get items(){return this.childViews}[Symbol.iterator](){return this.childViews[Symbol.iterator]()}get length(){return this.childViews.length}get(t){return this.childViews[t]}map(t){return l(this,t)}find(t){return c(this,t)}forEach(t){return d(this,t)}}var D;t.MountState=void 0,(D=t.MountState||(t.MountState={}))[D.Unmounted=0]="Unmounted",D[D.Mounting=1]="Mounting",D[D.Mounted=2]="Mounted";class E{constructor(){this.dict=void 0,this.actions=void 0,this.view=void 0}setDict(t,e){this.dict||(this.dict={}),this.dict[t]=e}addUpdateAction(t){this.actions||(this.actions=[]),this.actions.push(t)}update(){if(this.actions)for(const t of this.actions)t.run()}}class V{constructor(t,e){this.node=t,this.func=e}run(){this.node.textContent=this.func()}}class I{constructor(t,e){this.node=t,this.func=e}run(){this.node.hidden=this.func()}}class L{constructor(t,e){this.node=t,this.func=e}run(){this.func(this.node)}}function S(t,e){if("string"==typeof t)return document.createTextNode(t);if("function"==typeof t){const n=t();if(n&&"object"==typeof n)throw new Error("Unexpected function return value");{const i=document.createTextNode(n);return null==e||e.addUpdateAction(new V(i,t)),i}}return Node&&t instanceof Node?t:null}var T=function(t,e,n){var i;if(e--<0)throw new Error("ran out of TTL");var o=S(t,n);if(o)return o;if(t instanceof F&&!((t=t.buildView(n,e))instanceof v))return t;if(t instanceof v)return null===(i=null==n?void 0:n.view)||void 0===i||i._registerChild(t),t.getDOM();const s=t.tag;if(!s)throw new Error("no tag");var r=function(t){for(var e,n,i=/[#\.^]?[\w\-]+/y;e=i.exec(t);){var o=e[0],s=o[0];if("."===s)n.classList.add(o.substr(1));else if("#"===s)n.id=o.substr(1);else{if(n)throw new Error("unexpected multiple tags");n=document.createElement(o)}}return n}(s);for(var a in t)if(t.hasOwnProperty(a)){var l=t[a];A(a,l,r,n,e)}const d=t.init;return d&&d(r),r},A=function(t,e,n,i,o){if("child"===t)e instanceof Array?h(e,(function(t){n.appendChild(T(t,o,i))})):n.appendChild(T(e,o,i));else if("_id"===t||"_key"===t)i.setDict(e,n);else if("ref"===t)e.value=n;else if("text"===t)"function"==typeof e?i.addUpdateAction(new V(n,e)):n.textContent=e;else if("class"===t)n.className=e;else if("style"===t&&"object"==typeof e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const i=e[t];n.style[t]=i}}else"hidden"===t&&"function"==typeof e?i.addUpdateAction(new I(n,e)):"update"===t&&"function"==typeof e?i.addUpdateAction(new L(n,e)):"init"===t||(n[t]=e)};function M(t,e){return T(t,32,e||null)}function O(t,e){return t instanceof v?t:t instanceof F?t.buildView(e,64):M(t,e)}class F{constructor(t,e,n){this.tag=t,this.attrs=e,this.child=n}getDOM(){return this.buildDom(null,64)}buildDom(t,e){return w(this.buildView(t,e))}buildView(t,e){if(e--<0)throw new Error("ran out of TTL");let n;if("string"==typeof this.tag){const i=document.createElement(this.tag);if(n=i,this.attrs){for(const n in this.attrs)if(Object.prototype.hasOwnProperty.call(this.attrs,n)){const o=this.attrs[n];A(n,o,i,t,e)}const n=this.attrs.init;n&&n(i)}}else if(n=this.tag,this.attrs){let t=null;for(const e in this.attrs)if(Object.prototype.hasOwnProperty.call(this.attrs,e)){const i=this.attrs[e];"init"==e?t=i:"ref"==e?i.value=n:e.startsWith("on")&&n[e]instanceof g?n[e].add(i):n[e]=i}t&&t(n)}return this.child&&h(this.child,n instanceof v?t=>{n.addChild(P(t,e,n._domctx))}:i=>{var o;const s=P(i,e,t);s instanceof v?(n.appendChild(s.dom),null===(o=null==t?void 0:t.view)||void 0===o||o._registerChild(s)):b(n,s)}),n}addChild(t){null==this.child&&(this.child=[]),this.child.push(t)}}function P(t,e,n){if(e--<0)throw new Error("ran out of TTL");if(t instanceof v)return t;var i=S(t,n);if(i)return i;if(t instanceof F)return t.buildView(n,e);throw console.error("Unknown node type",t),new Error("Unknown node type")}function z(t,e,...n){if("string"==typeof t)return new F(t,e,n);{const i=(null==e?void 0:e.args)?new t(...e.args):new t;return new F(i,e,n)}}const B=z;function N(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function H(t,e,n){var i=t.classList;return i.toggle?i.toggle(e,n):(void 0===n&&(n=!i.contains(e)),n?i.add(e):i.remove(e),n)}function U(t,e){const{className:n="fading-out",duration:i=500,remove:o=!0}=e||{};t.classList.add(n);var s=null,r=(e=!0)=>{r&&(r=null,t.removeEventListener("transitionend",a),t.classList.remove(n),o&&e&&t.remove(),e&&(null==s||s()))},a=function(t){t.eventPhase===Event.AT_TARGET&&(null==r||r())};return t.addEventListener("transitionend",a),setTimeout(r,i),{get finished(){return!r},onFinished(t){return r?s=t:t(),this},cancel(t=!1){null==r||r(t)}}}class j{constructor(t){this.callback=t,this.cancelFunc=void 0}timeout(t){this.tryCancel();var e=setTimeout(this.callback,t);this.cancelFunc=()=>window.clearTimeout(e)}interval(t){this.tryCancel();var e=setInterval(this.callback,t);this.cancelFunc=()=>window.clearInterval(e)}animationFrame(){this.tryCancel();var t=requestAnimationFrame(this.callback);this.cancelFunc=()=>cancelAnimationFrame(t)}tryCancel(){this.cancelFunc&&(this.cancelFunc(),this.cancelFunc=void 0)}}function R(t,e,n){var i=!1,o=function(t){if("track"===e({type:"mouse",ev:t,point:t,action:"down"})){var n=function(t){e({type:"mouse",ev:t,point:t,action:"move"})},i=function(t){document.removeEventListener("mousemove",n,!0),document.removeEventListener("mouseup",i,!0),e({type:"mouse",ev:t,point:t,action:"up"})};document.addEventListener("mousemove",n,!0),document.addEventListener("mouseup",i,!0)}},s=function(o){var s=o.changedTouches[0],r=e({type:"touch",touch:"start",ev:o,point:s,action:i?"move":"down"});if(!i&&"track"===r){i=!0;var a=function(t){var n=t.changedTouches[0];e({type:"touch",touch:"move",ev:t,point:n,action:"move"})},l=function(n){0===n.touches.length&&(i=!1,t.removeEventListener("touchmove",a),t.removeEventListener("touchend",l),t.removeEventListener("touchcancel",l));var o=n.changedTouches[0];e({type:"touch",touch:"end",ev:n,point:o,action:i?"move":"up"})};t.addEventListener("touchmove",a,n),t.addEventListener("touchend",l,n),t.addEventListener("touchcancel",l,n)}};return t.addEventListener("mousedown",o,n),t.addEventListener("touchstart",s,n),{remove:()=>{t.removeEventListener("mousedown",o,n),t.removeEventListener("touchstart",s,n)}}}function K(t,e,n){return t.addEventListener(e,n),{remove:()=>t.removeEventListener(e,n)}}function W(t,e,n){return e.forEach((e=>t.addEventListener(e,n))),{remove:()=>e.forEach((e=>t.removeEventListener(e,n)))}}function $(t,e){var n;document.head.appendChild(M({tag:null!==(n=null==e?void 0:e.tag)&&void 0!==n?n:"style",text:t}))}class q{constructor(){this.data={},this.curLang="en",this.missing=new Map}get(t,e){return this.get2(t,e)||t}get2(t,e,n){n=n||this.curLang;var i=this.data[n];if(!i)return console.log("i18n missing lang: "+n),null;var o=i[t];if(!o)return this.missing.has(t)||(this.missing.set(t,1),console.log("i18n missing key: "+t)),null;if(e)for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];o=o.replace("{"+t+"}",n)}return o}add2dArray(t){const e=[],n=t[0];for(const t of n)e.push(this.data[t]=this.data[t]||{});for(let n=1;n<t.length;n++){const i=t[n],o=i[0];for(let t=0;t<i.length;t++){const n=i[t];e[t][o]=n}}}renderElements(t){console.log("i18n elements rendering"),t.forEach((t=>{for(const n of t.childNodes)if(n.nodeType===Node.TEXT_NODE){var e=this.get2(n.beforeI18n||n.textContent);e?(n.beforeI18n=n.beforeI18n||n.textContent,n.textContent=e):(n.beforeI18n&&(n.textContent=n.beforeI18n),console.log("missing key for node",n))}}))}static detectLanguage(t){var e=null,n=-1,i=[];return(navigator.languages||[navigator.language]).forEach((t=>{i.push(t),t.indexOf("-")>0&&i.push(t.substr(0,t.indexOf("-")))})),t.forEach((t=>{var o=i.indexOf(t);(!e||-1!==o&&o<n)&&(e=t,n=o)})),e||t[0]}}function Y(t){var e=X(t);return function(n,...i){return 0===i.length?t.get(n[0]):e(n,...i).join("")}}function X(t){var e=new WeakMap,n=new Map;return function(i,...o){if(0===o.length)return[t.get(i[0])];let s=e.get(i);if(void 0===s){s="";for(let t=0;t<i.length;t++){s+=i[t],t<o.length&&(s+="{"+t+"}")}e.set(i,s)}const r=t.get(s);let a=n.get(r);return void 0===a&&(a=function(t){const e=[];let n=0,i="";for(let o=0;o<t.length;o++){const s=t[o];switch(s){case"{":if(0==n)n=1;else{if(1!=n)throw new Error(`Expected number, got '${s}' at ${o}`);n=0,i+="{"}break;case"}":if(3==n)n=0,e.push(+i),i="";else if(0==n)n=2;else{if(2!=n)throw new Error(`Expected number, got '${s}' at ${o}`);n=0,i+="}"}break;default:if(2==n)throw new Error(`Expected '}', got '${s}' at ${o}`);1==n&&(n=3,i&&e.push(i),i=""),i+=s}}if(0!=n)throw new Error("Unexpected end of template string");i&&e.push(i);return e}(r)),a.map((t=>"number"==typeof t?o[t]:t))}}var G=new q;const J=Y(G);function Q(){return':root {\n    --color-bg: white;\n    --color-text: black;\n    --color-text-gray: #666;\n    --color-bg-selection: hsl(5, 100%, 85%);\n    --color-primary: hsl(5, 100%, 67%);\n    --color-primary-darker: hsl(5, 100%, 60%);\n    --color-primary-dark: hsl(5, 100%, 40%);\n    --color-primary-dark-depends: hsl(5, 100%, 40%);\n    --color-primary-verydark: hsl(5, 100%, 20%);\n    --color-primary-light: hsl(5, 100%, 83%);\n    --color-primary-lighter: hsl(5, 100%, 70%);\n    --color-fg-11: #111111;\n    --color-fg-22: #222222;\n    --color-fg-33: #333333;\n    --color-bg-cc: #cccccc;\n    --color-bg-dd: #dddddd;\n    --color-bg-ee: #eeeeee;\n    --color-bg-f8: #f8f8f8;\n    --color-shadow: rgba(0, 0, 0, .5);\n}\n\n.no-selection {\n    user-select: none;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n}\n\n/* listview item */\n\n.item {\n    display: block;\n    position: relative;\n    padding: 10px;\n    /* background: #ddd; */\n    /* animation: showing .3s forwards; */\n    text-decoration: none;\n    line-height: 1.2;\n}\n\na.item {\n    color: inherit;\n}\n\n.clickable, .item {\n    cursor: pointer;\n    transition: transform .3s;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.item:hover, .dragover {\n    background: var(--color-bg-ee);\n}\n\n.keyboard-input .item:focus {\n    outline-offset: -2px;\n}\n\n.dragover-placeholder {\n    /* border-top: 2px solid gray; */\n    position: relative;\n}\n\n.dragover-placeholder::before {\n    content: "";\n    display: block;\n    position: absolute;\n    transform: translate(0, -1px);\n    height: 2px;\n    width: 100%;\n    background: gray;\n    z-index: 100;\n    pointer-events: none;\n}\n\n.clickable:active, .item:active {\n    transition: transform .07s;\n    transform: scale(.97);\n}\n\n.item:active {\n    background: var(--color-bg-dd);\n}\n\n.item.no-transform:active {\n    transform: none;\n}\n\n.item.active {\n    background: var(--color-bg-dd);\n}\n\n.loading-indicator {\n    position: relative;\n    margin: .3em;\n    margin-top: 3em;\n    margin-bottom: 1em;\n    text-align: center;\n    white-space: pre-wrap;\n    cursor: default;\n    animation: loading-fadein .3s;\n}\n\n.loading-indicator-text {\n    margin: 0 auto;\n}\n\n.loading-indicator.running .loading-indicator-inner {\n    display: inline-block;\n    position: relative;\n    vertical-align: bottom;\n}\n\n.loading-indicator.running .loading-indicator-inner::after {\n    content: "";\n    height: 1px;\n    margin: 0%;\n    background: var(--color-text);\n    display: block;\n    animation: fadein .5s 1s backwards;\n}\n\n.loading-indicator.running .loading-indicator-text {\n    margin: 0 .5em;\n    animation: fadein .3s, loading-first .3s .5s cubic-bezier(0.55, 0.055, 0.675, 0.19) reverse, loading-second .3s .8s cubic-bezier(0.55, 0.055, 0.675, 0.19), loading .25s 1.1s cubic-bezier(0.55, 0.055, 0.675, 0.19) alternate-reverse infinite;\n}\n\n.loading-indicator.error {\n    color: red;\n}\n\n.loading-indicator.fading-out {\n    transition: max-height;\n    animation: loading-fadein .3s reverse;\n}\n\n@keyframes loading-fadein {\n    0% {\n        opacity: 0;\n        max-height: 0;\n    }\n    100% {\n        opacity: 1;\n        max-height: 200px;\n    }\n}\n\n@keyframes fadein {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity: 1;\n    }\n}\n\n@keyframes loading-first {\n    0% {\n        transform: translate(0, -2em) scale(1) rotate(360deg);\n    }\n    100% {\n        transform: translate(0, 0) scale(1) rotate(0deg);\n    }\n}\n\n@keyframes loading-second {\n    0% {\n        transform: translate(0, -2em);\n    }\n    100% {\n        transform: translate(0, 0);\n    }\n}\n\n@keyframes loading {\n    0% {\n        transform: translate(0, -1em);\n    }\n    100% {\n        transform: translate(0, 0);\n    }\n}\n\n@keyframes showing {\n    0% {\n        opacity: .3;\n        transform: translate(-20px, 0)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n@keyframes showing-top {\n    0% {\n        opacity: .3;\n        transform: translate(0, -20px)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n@keyframes showing-right {\n    0% {\n        opacity: .3;\n        transform: translate(20px, 0)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n.overlay {\n    background: rgba(0, 0, 0, .2);\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    animation: fadein .3s;\n    z-index: 10001;\n    overflow: hidden;\n    contain: strict;\n    will-change: transform;\n}\n\n.overlay.fixed {\n    position: fixed;\n}\n\n.overlay.nobg {\n    background: none;\n    will-change: auto;\n}\n\n.overlay.centerChild {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.overlay.clickThrough {\n    pointer-events: none;\n}\n\n.dialog * {\n    box-sizing: border-box;\n}\n\n.dialog {\n    font-size: 14px;\n    position: relative;\n    overflow: auto;\n    background: var(--color-bg);\n    border-radius: 5px;\n    box-shadow: 0 0 12px var(--color-shadow);\n    animation: dialogin .2s ease-out;\n    z-index: 10001;\n    display: flex;\n    flex-direction: column;\n    max-height: 100%;\n    contain: content;\n    will-change: transform;\n    pointer-events: auto;\n}\n\n.dialog.resize {\n    resize: both;\n}\n\n.fading-out .dialog {\n    transition: transform .3s ease-in;\n    transform: scale(.85);\n}\n\n.dialog-title, .dialog-content, .dialog-bottom {\n    padding: 10px;\n}\n\n.dialog-title {\n    background: var(--color-bg-ee);\n}\n\n.dialog-content {\n    flex: 1;\n    padding: 5px 10px;\n    overflow: auto;\n}\n\n.dialog-content.flex {\n    display: flex;\n    flex-direction: column;\n}\n\n.dialog-bottom {\n    padding: 5px 10px;\n}\n\n@keyframes dialogin {\n    0% {\n        transform: scale(.85);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n.input-label {\n    font-size: 80%;\n    color: var(--color-text-gray);\n    margin: 5px 0 3px 0;\n}\n\n.input-text {\n    display: block;\n    width: 100%;\n    padding: 5px;\n    border: solid 1px gray;\n    background: var(--color-bg);\n    color: var(--color-text);\n}\n\n.dialog .input-text {\n    margin: 5px 0;\n}\n\ntextarea.input-text {\n    resize: vertical;\n}\n\n.labeled-input {\n    display: flex;\n    flex-direction: column;\n}\n\n.labeled-input .input-text {\n    flex: 1;\n}\n\n.labeled-input:focus-within .input-label {\n    color: var(--color-primary-darker);\n}\n\n.input-text:focus {\n    border-color: var(--color-primary-darker);\n}\n\n.input-text:active {\n    border-color: var(--color-primary-dark);\n}\n\n.btn {\n    display: block;\n    text-align: center;\n    transition: all .2s;\n    padding: 0 .4em;\n    min-width: 3em;\n    line-height: 1.5em;\n    background: var(--color-primary);\n    color: white;\n    text-shadow: 0 0 4px var(--color-primary-verydark);\n    box-shadow: 0 0 3px var(--color-shadow);\n    cursor: pointer;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    position: relative;\n    overflow: hidden;\n}\n\n.btn:hover {\n    transition: all .05s;\n    background: var(--color-primary-darker);\n}\n\n.btn.btn-down, .btn:active {\n    transition: all .05s;\n    background: var(--color-primary-dark);\n    box-shadow: 0 0 1px var(--color-shadow);\n}\n\n.btn.disabled {\n    background: var(--color-primary-light);\n}\n\n.dialog .btn {\n    margin: 10px 0;\n}\n\n.btn-big {\n    padding: 5px;\n}\n\n.btn-inline {\n    display: inline;\n}\n\n.textbtn {\n    display: inline-block;\n    color: var(--color-text-gray);\n    margin: 0 5px;\n}\n\n.textbtn.active {\n    color: var(--color-text);\n}\n\n*[hidden] {\n    display: none !important;\n}\n\n.context-menu {\n    position: absolute;\n    overflow-y: auto;\n    background: var(--color-bg);\n    border: solid 1px #777;\n    box-shadow: 0 0px 12px var(--color-shadow);\n    min-width: 100px;\n    max-width: 450px;\n    outline: none;\n    z-index: 10001;\n    animation: context-menu-in .2s ease-out forwards;\n    will-change: transform;\n}\n\n.context-menu .item.dangerous {\n    transition: color .3s, background .3s;\n    color: red;\n}\n\n.context-menu .item.dangerous:hover {\n    transition: color .1s, background .1s;\n    background: red;\n    color: white;\n}\n\n@keyframes context-menu-in {\n    0% {\n        transform: scale(.9);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n*.menu-shown {\n    background: var(--color-bg-dd);\n}\n\n.menu-info {\n    white-space: pre-wrap;\n    color: var(--color-text-gray);\n    padding: 5px 10px;\n    /* animation: showing .3s; */\n    cursor: default;\n}\n\n.toasts-container {\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    padding: 5px;\n    width: 300px;\n    z-index: 10001;\n    overflow: hidden;\n}\n\n.toast {\n    margin: 5px;\n    padding: 10px;\n    border-radius: 5px;\n    box-shadow: 0 0 10px var(--color-shadow);\n    background: var(--color-bg);\n    white-space: pre-wrap;\n    animation: showing-right .3s;\n}\n\n.fading-out {\n    transition: opacity .3s;\n    opacity: 0;\n    pointer-events: none;\n}\n\n.anchor-bottom {\n    transform: translate(-50%, -100%);\n}\n\n.tooltip {\n    position: absolute;\n    background: var(--color-bg);\n    box-shadow: 0 0 5px var(--color-shadow);\n    border-radius: 5px;\n    padding: .2em .25em;\n}\n'}let Z=!1;class tt extends v{constructor(){super(...arguments),this._text="",this.textFunc=null}get text(){var t,e;return null!==(e=null===(t=this.dom)||void 0===t?void 0:t.textContent)&&void 0!==e?e:this._text}set text(t){"function"==typeof t?(this._text=t(),this.textFunc=t):(this._text=t,this.textFunc=null),this.domCreated&&(this.dom.textContent=this._text)}postCreateDom(){super.postCreateDom(),this._text&&(this.dom.textContent=this._text)}updateDom(){super.updateDom(),this.textFunc&&(this.dom.textContent=this.textFunc())}}class et extends tt{constructor(t){super(),this.clickable=!0,this.active=!1,this.right=!1,m(this,t)}createDom(){return{tag:"span.textbtn.no-selection"}}updateDom(){super.updateDom(),this.dom.tabIndex=this.clickable?0:-1,this.toggleClass("clickable",this.clickable),this.toggleClass("active",this.active),this.dom.style.float=this.right?"right":"left"}}const nt=et;function it(t,e){let{x:n=0,y:i=0,anchor:o="bottom"}=e;t.style.left=n+"px",t.style.top=i+"px",t.classList.contains("anchor-"+o)||(t.classList.forEach((e=>{e.startsWith("anchor-")&&t.classList.remove(e)})),t.classList.add("anchor-"+o))}var ot=new class{constructor(){this._currentItem=null,this._currentArray=null,this.onDragStart=new g,this.onDragEnd=new g}get currentItem(){var t,e,n;return null!==(n=null!==(t=this._currentItem)&&void 0!==t?t:null===(e=this._currentArray)||void 0===e?void 0:e[0])&&void 0!==n?n:null}get currentArray(){return this._currentItem?[this._currentItem]:this._currentArray}start(t){this._currentItem=t,console.log("drag start",t),this.onDragStart.invoke()}startArray(t){this._currentArray=t,console.log("drag start array",t),this.onDragStart.invoke()}end(){this._currentItem=null,this._currentArray=null,console.log("drag end"),this.onDragEnd.invoke()}};t.FlagsInput=void 0,function(t){t.FlagsInput=class extends k{constructor(t){super(),null==t||t.forEach((t=>{var n=t instanceof e?t:new e({text:Object.prototype.toString.call(t)});this.addView(n)}))}createDom(){return{tag:"div.flags-input"}}};class e extends tt{get parentInput(){return this.parentView}constructor(t){super(),m(this,t)}createDom(){return{tag:"div.flags-input-item"}}}t.Flag=e}(t.FlagsInput||(t.FlagsInput={}));class st extends v{createDom(){return{tag:"div.overlay"}}setCenterChild(t){return this.setFlags({centerChild:t})}setNoBg(t){return this.setFlags({nobg:t})}setFixed(t){return this.setFlags({fixed:t})}setFlags(t){for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&this.toggleClass(e,t[e]);return this}}var rt=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};class at extends v{constructor(){super(),this.parent=at.defaultParent,this.overlay=(new st).setFlags({centerChild:!0,nobg:!0}),this.header=new v({tag:"div.dialog-title.clearfix"}),this.content=new v({tag:"div.dialog-content"}),this.shown=!1,this.btnTitle=new et({active:!0,clickable:!1}),this.btnClose=new et({text:J`Close`,right:!0}),this.title="Dialog",this.allowClose=!0,this.showCloseButton=!0,this.onShown=new g,this.onClose=new g,this.focusTrap=new v({tag:"div.focustrap",tabIndex:0}),this.btnClose.onActive.add((()=>this.allowClose&&this.close()))}get domheader(){return this.header.dom}static get defaultParent(){return at._defaultParent||(at._defaultParent=new lt),at._defaultParent}static set defaultParent(t){at._defaultParent=t}get width(){return this.dom.style.width}set width(t){this.dom.style.width=t}get contentFlex(){return this.content.dom.classList.contains("flex")}set contentFlex(t){this.content.toggleClass("flex",!!t)}get resizable(){return this.dom.classList.contains("resize")}set resizable(t){this.toggleClass("resize",!!t)}createDom(){return{tag:"div.dialog",tabIndex:0,style:"width: 300px",child:[this.header,this.content,this.focusTrap]}}postCreateDom(){super.postCreateDom(),this.addBtn(this.btnTitle),this.addBtn(this.btnClose),this.overlay.appendView(this),this.overlay.dom.addEventListener("mousedown",(t=>{this.allowClose&&0===t.button&&t.target===this.overlay.dom&&(t.preventDefault(),this.close())})),this.overlay.dom.addEventListener("keydown",(t=>{if(this.allowClose&&27===t.keyCode)t.preventDefault(),this.close();else if(t.target===this.dom&&"Tab"===t.code&&t.shiftKey){t.preventDefault();let e=this.dom.querySelectorAll("a, [tabindex]");e.length>=2&&e[e.length-2].focus&&e[e.length-2].focus()}}));{let t;R(this.header.dom,(e=>{if("down"===e.action){if(e.ev.target!==this.header.dom&&e.ev.target!==this.btnTitle.dom)return;e.ev.preventDefault();const n=this.overlay.dom.getBoundingClientRect(),i=this.dom.getBoundingClientRect();return t={x:e.point.pageX-n.x-i.x,y:e.point.pageY-n.y-i.y},"track"}if("move"===e.action){e.ev.preventDefault();const n=this.overlay.dom.getBoundingClientRect(),i=r(e.point.pageX,n.left,n.right),o=r(e.point.pageY,n.top,n.bottom);this.setOffset(i-t.x,o-t.y)}}))}this.focusTrap.dom.addEventListener("focus",(t=>{this.dom.focus()}))}updateDom(){super.updateDom(),this.btnTitle.updateWith({text:this.title}),this.btnTitle.hidden=!this.title,this.btnClose.hidden=!(this.allowClose&&this.showCloseButton)}addBtn(t){this.ensureDom(),this.header.appendView(t)}addContent(t,e){this.ensureDom(),e&&this.content.removeAllView(),this.content.addChild(t)}addChild(t){this.addContent(t)}setOffset(t,e){this.dom.style.left=t?t+"px":"",this.dom.style.top=e?e+"px":"",this.overlay.setCenterChild(!1)}getOffset(){return{x:this.dom.style.left?parseFloat(this.dom.style.left):0,y:this.dom.style.top?parseFloat(this.dom.style.top):0}}center(){this.setOffset(0,0),this.overlay.setCenterChild(!0)}show(t){var e;this.shown||(this.shown=!0,null===(e=this._cancelFadeout)||void 0===e||e.call(this,!0),this.ensureDom(),this.parent.onDialogShowing(this),this.setTransformOrigin(t),this.dom.focus(),(this.autoFocus||this).dom.focus(),this.onShown.invoke())}setTransformOrigin(t){if(t){const e=this.dom.getBoundingClientRect();this.dom.style.transformOrigin=`${t.x-e.x}px ${t.y-e.y}px`}else this.dom.style.transformOrigin=""}close(){this.shown&&(this.shown=!1,this.setTransformOrigin(void 0),this.onClose.invoke(),this._cancelFadeout=U(this.overlay.dom).onFinished((()=>{var t;return null===(t=this.overlay.parentView)||void 0===t?void 0:t.removeView(this.overlay)})).cancel,at.defaultParent.onDialogClosing(this))}waitClose(){return new Promise((t=>{var e=this.onClose.add((()=>{this.onClose.remove(e),t()}))}))}}at._defaultParent=null;class lt{constructor(e=document.body){this.bgOverlay=new st,this.dialogCount=0,this.fixed=!1,this._cancelFadeout=null,this.view=v.getView(e),e===document.body&&(this.fixed=!0,this.view.mountStateChanged(t.MountState.Mounted))}onDialogShowing(t){var e;0==this.dialogCount++&&(null===(e=this._cancelFadeout)||void 0===e||e.call(this,!0),this.bgOverlay.setFlags({fixed:this.fixed,clickThrough:!0}),this.view.appendView(this.bgOverlay)),t.overlay.setFlags({fixed:this.fixed}),this.view.appendView(t.overlay)}onDialogClosing(t){0==--this.dialogCount&&(this._cancelFadeout=U(this.bgOverlay.dom).onFinished((()=>this.view.removeView(this.bgOverlay))).cancel)}}class dt extends v{constructor(t){super(),this.multiline=!1,this.type="text",this.placeholder="",m(this,t)}get value(){return this.dom.value}set value(t){this.dom.value=t}createDom(){return this.multiline?{tag:"textarea.input-text"}:{tag:"input.input-text"}}updateDom(){super.updateDom(),this.dom instanceof HTMLInputElement&&(this.dom.type=this.type,this.dom.placeholder=this.placeholder)}}class ht extends v{constructor(t){super(),this.label="",m(this,t)}get dominput(){return this.input.dom}createDom(){return{tag:"div.labeled-input",child:[{tag:"div.input-label",text:()=>this.label},this.input]}}updateDom(){super.updateDom(),this.input.domCreated&&this.input.updateDom()}}class ct extends v{constructor(){super(...arguments),this.dragging=void 0,this._selected=!1,this.onSelectedChanged=new g,this.enterctr=0,this.dragoverPlaceholder=null}get listview(){return this.parentView instanceof ut?this.parentView:null}get selectionHelper(){var t;return null===(t=this.listview)||void 0===t?void 0:t.selectionHelper}get dragData(){return this.dom.textContent}get selected(){return this._selected}set selected(t){this._selected=t,this.domCreated&&this.updateDom(),this.onSelectedChanged.invoke()}remove(){this.listview&&this.listview.remove(this)}postCreateDom(){super.postCreateDom(),this.dom.setAttribute("role","listitem"),this.dom.addEventListener("click",(t=>{var e,n,i;(null===(e=this.listview)||void 0===e?void 0:e.selectionHelper.handleItemClicked(this,t))||null===(i=null===(n=this.listview)||void 0===n?void 0:n.onItemClicked)||void 0===i||i.call(n,this)})),this.dom.addEventListener("keydown",(t=>{var e,n,i,o,s,r;if("Enter"===t.code){if(t.altKey){const t=this.dom.getBoundingClientRect(),o=new MouseEvent("contextmenu",{clientX:t.left,clientY:t.top,relatedTarget:this.dom});null===(i=null!==(e=this.onContextMenu)&&void 0!==e?e:null===(n=this.listview)||void 0===n?void 0:n.onContextMenu)||void 0===i||i(this,o)}else{if(null===(o=this.listview)||void 0===o?void 0:o.selectionHelper.handleItemClicked(this,t))return;null===(r=null===(s=this.listview)||void 0===s?void 0:s.onItemClicked)||void 0===r||r.call(s,this)}t.preventDefault()}else if(!this.listview||"ArrowUp"!==t.code&&"ArrowDown"!==t.code)if(!this.listview||"PageUp"!==t.code&&"PageDown"!==t.code)!this.listview||"Home"!==t.code&&"End"!==t.code?this.listview&&this.listview.selectionHelper.handleItemKeyDown(this,t):(this.listview.get("Home"==t.code?0:this.listview.length-1).dom.focus(),t.preventDefault());else{const e="PageUp"===t.code?-1:1,n=this.listview.scrollBox,i=e>0?this.dom.offsetTop+n.offsetHeight:this.dom.offsetTop+this.dom.offsetHeight-n.offsetHeight,o=this.listview.length;let s=this;for(;e>0?i>s.dom.offsetTop+s.dom.offsetHeight:i<s.dom.offsetTop;){const t=s.position+e;if(t<0||t>=o)break;s=this.listview.get(t)}s&&s!==this&&(s.dom.focus(),t.preventDefault())}else{const e="ArrowUp"===t.code?-1:1,n=this.listview.get(this.position+e);n&&(n.dom.focus(),t.preventDefault())}})),this.dom.addEventListener("contextmenu",(t=>{var e,n,i;null===(i=null!==(e=this.onContextMenu)&&void 0!==e?e:null===(n=this.listview)||void 0===n?void 0:n.onContextMenu)||void 0===i||i(this,t)})),this.dom.addEventListener("dragstart",(t=>{var e,n;if(null!==(e=this.dragging)&&void 0!==e?e:null===(n=this.listview)||void 0===n?void 0:n.dragging){var i=[];this.selected&&this.selectionHelper?(i=[...this.selectionHelper.selectedItems]).sort(((t,e)=>t.position-e.position)):i=[this],ot.startArray(i),t.dataTransfer.setData("text/plain",i.map((t=>t.dragData)).join("\r\n")),i.forEach((t=>t.dom.style.opacity=".5"))}else t.preventDefault()})),this.dom.addEventListener("dragend",(t=>{var e=ot.currentArray;ot.end(),t.preventDefault(),e.forEach((t=>t.dom.style.opacity=""))})),this.dom.addEventListener("dragover",(t=>{this.dragHandler(t,"dragover")})),this.dom.addEventListener("dragenter",(t=>{this.dragHandler(t,"dragenter")})),this.dom.addEventListener("dragleave",(t=>{this.dragHandler(t,"dragleave")})),this.dom.addEventListener("drop",(t=>{this.dragHandler(t,"drop")}))}dragHandler(t,e){var n,i,o,s,r,a,l,d;const h=ot.currentItem;let c=ot.currentArray;const u="drop"===e,m={source:h,target:this,sourceItems:c,event:t,drop:u,accept:!1};if(h instanceof ct&&(null===(n=this.listview)||void 0===n?void 0:n.moveByDragging)&&h.listview===this.listview){t.preventDefault();const e=c.indexOf(this)>=0,n=t.clientY-this.dom.getBoundingClientRect().top>this.dom.offsetHeight/2;if(e&&u||(m.accept=n?"move-after":"move"),u){if(-1===c.indexOf(this)){let t=this.position;n&&t++;for(const e of c)e!==this&&(t>e.position&&t--,this.listview.move(e,t),t++)}}else t.dataTransfer.dropEffect="move"}const g=null!==(i=this.onDragover)&&void 0!==i?i:null===(o=this.listview)||void 0===o?void 0:o.onDragover;!m.accept&&g&&(g(m),(u||m.accept)&&t.preventDefault());const p=null!==(s=this.onContextMenu)&&void 0!==s?s:null===(r=this.listview)||void 0===r?void 0:r.onContextMenu;if(!m.accept&&c&&c.indexOf(this)>=0&&p&&(u?p(this,t):t.preventDefault()),"dragenter"===e||"dragover"==e||"dragleave"===e||u){"dragenter"===e?this.enterctr++:"dragleave"===e?this.enterctr--:"drop"===e&&(this.enterctr=0);let t=this.enterctr>0;this.toggleClass("dragover",t);let n=t&&("move"===m.accept||"move-after"===m.accept)&&m.accept;if(n!=(null!==(l=null===(a=this.dragoverPlaceholder)||void 0===a?void 0:a[1])&&void 0!==l&&l)&&(null===(d=this.dragoverPlaceholder)||void 0===d||d[0].remove(),this.dragoverPlaceholder=null,n)){this.dragoverPlaceholder=[M({tag:"div.dragover-placeholder"}),n];var v=this.dom;"move-after"===m.accept&&(v=v.nextElementSibling),this.dom.parentElement.insertBefore(this.dragoverPlaceholder[0],v)}}}}class ut extends k{constructor(t){super(t),this.onItemClicked=null,this.dragging=!1,this.moveByDragging=!1,this.selectionHelper=new mt,this._scrollBox=null,this.onItemMoved=null,this.onDragover=null,this.onContextMenu=null,this.selectionHelper.itemProvider=this}get scrollBox(){return this._scrollBox||this.dom}set scrollBox(t){this._scrollBox=t}postCreateDom(){super.postCreateDom(),this.dom.setAttribute("role","list")}add(t,e){this.addView(t,e),this.dragging&&(t.dom.draggable=!0)}remove(t,e){t=this._ensureItem(t),!e&&t.selected&&this.selectionHelper.toggleItemSelection(t),this.removeView(t)}move(t,e){var n;t=this._ensureItem(t),this.remove(t,!0),this.add(t,e),null===(n=this.onItemMoved)||void 0===n||n.call(this,t,t.position)}removeAll(){for(;this.length;)this.remove(this.length-1)}clear(){this.removeAll(),N(this.dom)}ReplaceChild(t){this.clear(),this.dom.appendChild(t.getDOM())}}class mt{constructor(){this._enabled=!1,this.onEnabledChanged=new g,this.itemProvider=null,this.ctrlForceSelect=!1,this.selectedItems=[],this.onSelectedItemsChanged=new g,this.lastToggledItem=null}get enabled(){return this._enabled}set enabled(t){if(!!t!=!!this._enabled){for(this._enabled=t;this.selectedItems.length;)this.toggleItemSelection(this.selectedItems[0],!1);this.lastToggledItem=null,this.onEnabledChanged.invoke()}}get count(){return this.selectedItems.length}handleItemClicked(t,e){if(!this.enabled){if(!this.ctrlForceSelect||!e.ctrlKey)return!1;this.enabled=!0}if(e.shiftKey&&this.lastToggledItem&&this.itemProvider){var n=!!this.lastToggledItem.selected,i=t.position,o=this.lastToggledItem.position;i>o&&([i,o]=[o,i]);for(let t=i;t<=o;t++)this.toggleItemSelection(this.itemProvider.get(t),n);this.lastToggledItem=t}else this.toggleItemSelection(t);return e.preventDefault(),!0}handleItemKeyDown(t,e){if(!this.enabled)return!1;if(this.itemProvider&&e.ctrlKey&&"KeyA"===e.code){const t=this.itemProvider.length;for(let e=0;e<t;e++)this.toggleItemSelection(this.itemProvider.get(e),!0);return e.preventDefault(),!0}return!1}toggleItemSelection(t,e){void 0!==e&&e===!!t.selected||(t.selected?(t.selected=!1,this.selectedItems.remove(t),this.onSelectedItemsChanged.invoke("remove",t)):(t.selected=!0,this.selectedItems.push(t),this.onSelectedItemsChanged.invoke("add",t)),this.lastToggledItem=t,0===this.count&&this.ctrlForceSelect&&(this.enabled=!1))}}var gt=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}l((i=i.apply(t,e||[])).next())}))};class pt extends ct{constructor(t){super(),this.text="",this.cls="normal",this.keepOpen=!1,m(this,t)}createDom(){return{tag:"div.item.no-selection",tabIndex:0}}postCreateDom(){super.postCreateDom(),this.onActive.add((t=>{this.parentView instanceof vt&&(this.keepOpen||this.parentView.keepOpen||this.parentView.close())}))}updateDom(){super.updateDom(),this.dom.textContent=this.text,this.cls!==this._lastcls&&(this._lastcls&&this.dom.classList.remove(this._lastcls),this.cls&&this.dom.classList.add(this.cls))}}class vt extends ut{constructor(t){super({tag:"div.context-menu",tabIndex:0}),this.keepOpen=!1,this.useOverlay=!0,this._visible=!1,this.overlay=null,this.onClose=new g,this._originalFocused=null,null==t||t.forEach((t=>this.add(t)))}get visible(){return this._visible}postCreateDom(){super.postCreateDom(),this.dom.addEventListener("focusout",(t=>{!this.dom.contains(t.relatedTarget)&&this.close()})),this.dom.addEventListener("keydown",(t=>{"Escape"===t.code&&(t.preventDefault(),this.close())}))}show(t){this._visible?console.trace("[ContextMenu] show() called when it's already visible."):("ev"in t&&(t={x:t.ev.clientX,y:t.ev.clientY}),this._visible=!0,this.useOverlay?(this.overlay||(this.overlay=(new st).setFixed(!0),this.overlay.dom.style.background="rgba(0, 0, 0, .1)",this.overlay.dom.addEventListener("mousedown",(t=>{t.eventPhase===Event.AT_TARGET&&(t.preventDefault(),this.close())}))),this.overlay.appendView(this),_(document.body,this.overlay)):_(document.body,this),this._originalFocused=document.activeElement,this.setPosition(t),this.dom.focus())}setPosition(t){if(this._visible){this.dom.style.left="0",this.dom.style.top="0";var e=document.body.offsetWidth,n=document.body.offsetHeight;if(this.useOverlay){const t=this.overlay.dom;e=t.offsetWidth,n=t.offsetHeight}this.dom.style.maxHeight=n+"px";var i=this.dom.offsetWidth,o=this.dom.offsetHeight,s=t.x,r=t.y;s+i>e&&(s-=i),r+o>n&&(r-=o),s<0&&(s=t.x>e/2?0:e-i),r<0&&(r=t.y>n/2?0:n-o),this.dom.style.left=s+"px",this.dom.style.top=r+"px",this.dom.style.transformOrigin=`${t.x-s}px ${t.y-r}px`}else console.trace("[ContextMenu] setPosition() called when it's not visible.")}close(){var t,e;this._visible&&(this._visible=!1,this.onClose.invoke(),null===(e=null===(t=this._originalFocused)||void 0===t?void 0:t.focus)||void 0===e||e.call(t),this._originalFocused=null,this.overlay&&U(this.overlay.dom).onFinished((()=>C(document.body,this.overlay))),U(this.dom).onFinished((()=>!this.overlay&&C(document.body,this))))}}class ft extends tt{constructor(t){super(),m(this,t)}createDom(){return{tag:"div.section-action.clickable",tabIndex:0}}}class wt extends v{constructor(){super(...arguments),this.parentDom=null,this.toasts=[]}createDom(){return{tag:"div.toasts-container"}}addToast(t){0===this.toasts.length&&this.show(),this.toasts.push(t)}removeToast(t){this.toasts.remove(t),0===this.toasts.length&&this.remove()}show(){(this.parentDom||document.body).appendChild(this.dom)}remove(){this.dom.remove()}}wt.default=new wt;class xt extends v{constructor(t){super(),this.text="",this.shown=!1,this.timer=new j((()=>this.close())),m(this,t),this.container||(this.container=wt.default)}show(t){this.shown||(this.container.addToast(this),this.container.appendView(this),this.shown=!0),t?this.timer.timeout(t):this.timer.tryCancel()}close(){this.shown&&(this.shown=!1,U(this.dom).onFinished((()=>this.container.removeToast(this))))}createDom(){return{tag:"div.toast"}}updateDom(){super.updateDom(),this.dom.textContent=this.text}static show(t,e){var n=new xt({text:t});return n.show(e),n}}t.AutoResetEvent=class{constructor(){this._whenNotify=null,this._callback=null}wait(){return this._whenNotify||(this._whenNotify=new Promise((t=>{this._callback=()=>{this._callback=this._whenNotify=null,t()}}))),this._whenNotify}set(){this._callback&&this._callback()}},t.BuildDOMCtx=E,t.ButtonView=class extends tt{constructor(t){super(),this.disabled=!1,this.type="normal",m(this,t),this.updateDom()}createDom(){return{tag:"div.btn",tabIndex:0}}updateDom(){super.updateDom(),this.toggleClass("disabled",this.disabled),this.toggleClass("btn-big","big"===this.type),this.toggleClass("btn-inline","inline"===this.type)}},t.Callbacks=g,t.CancelToken=class{constructor(){this.cancelled=!1,this.onCancelled=new g}cancel(){this.cancelled||(this.cancelled=!0,this.onCancelled.invoke())}throwIfCancelled(){if(this.cancelled)throw new Error("operation cancelled.")}},t.ContainerView=k,t.ContextMenu=vt,t.DataUpdatingHelper=class{update(t){const e=this.items;var n={};for(const e of t)n[this.dataSelectId(e)]=e;var i={},o=[];for(const t of e){const e=this.selectId(t);void 0!==n[e]?i[e]=t:o.push(t)}for(let t=o.length-1;t>=0;t--)this.removeItem(o[t]);var s=0;for(const e of t){const t=i[this.dataSelectId(e)];void 0!==t?this.updateItem(t,e):this.addItem(e,s),s++}}updateOrRebuildAll(t){this.update(t),this.isSame(t)||this.rebuildAll(t)}isSame(t){var e=this.items[Symbol.iterator]();for(const i of t){var n=e.next();if(n.done)return!1;if(this.selectId(n.value)!==this.dataSelectId(i))return!1}return!!e.next().done}rebuildAll(t){var e=this.items;if(e instanceof Array)for(let t=e.length-1;t>=0;t--)this.removeItem(e[t]);else for(const t of e)this.removeItem(t);let n=0;for(const e of t)this.addItem(e,n++)}selectId(t){return t.id}dataSelectId(t){return t.id}addItem(t,e){}updateItem(t,e){}removeItem(t){}},t.Dialog=at,t.DialogParent=lt,t.EditableHelper=class{constructor(t){this.editing=!1,this.beforeEdit=null,this.onComplete=null,this.element=t}startEdit(t){if(!this.editing){this.editing=!0;var e=this.element,n=this.beforeEdit=e.textContent;H(e,"editing",!0);for(var i=M({tag:"input",type:"text",value:n});e.firstChild;)e.removeChild(e.firstChild);e.appendChild(i),i.select(),i.focus();var o=()=>{var n;this.editing=!1,H(e,"editing",!1),s.forEach((t=>t.remove())),i.remove(),null===(n=this.onComplete)||void 0===n||n.call(this,i.value),null==t||t(i.value)},s=[K(i,"keydown",(t=>{"Enter"===t.code&&(o(),t.preventDefault())})),K(i,"focusout",(t=>{o()}))]}}startEditAsync(){return new Promise((t=>this.startEdit(t)))}},t.EventRegistrations=class{constructor(){this.list=[]}add(t,e){return this.list.push({event:t,func:e}),t.add(e),e}removeAll(){for(;this.list.length;){var t=this.list.pop();t.event.remove(t.func)}}},t.I=J,t.I18n=q,t.InputStateTracker=class{constructor(t){this.dom=t,this.state={mouseDown:!1,mouseIn:!1,focusIn:!1},this._removeEvents=null,this._removePointerEvents=null,this.onChanged=new g,this._removeEvents=W(t,["mouseenter","mouseleave","focusin","focusout"],(t=>{switch(t.type){case"mouseenter":this.stateChanged("mouseIn",!0);break;case"mouseleave":this.stateChanged("mouseIn",!1);break;case"focusin":this.stateChanged("focusIn",!0);break;case"focusout":this.stateChanged("focusIn",!1)}})).remove,this._removePointerEvents=R(t,(t=>{if("down"==t.action)return this.stateChanged("mouseDown",!0),"track";"up"==t.action&&this.stateChanged("mouseDown",!1)})).remove}stateChanged(t,e){this.state[t]=e,this.onChanged.invoke(t)}removeListeners(){var t,e;null===(t=this._removeEvents)||void 0===t||t.call(this),null===(e=this._removePointerEvents)||void 0===e||e.call(this),this._removePointerEvents=this._removeEvents=null}},t.InputView=dt,t.ItemActiveHelper=class{constructor(t){this.funcSetActive=(t,e)=>t.toggleClass("active",e),this.current=null,m(this,t)}set(t){this.current!==t&&(this.current&&this.funcSetActive(this.current,!1),this.current=t,this.current&&this.funcSetActive(this.current,!0))}},t.JsxNode=F,t.LabeledInput=class extends ht{constructor(t){super(),m(this,t),this.input||(this.input=new dt)}get value(){return this.dominput.value}set value(t){this.dominput.value=t}updateDom(){this.input.type=this.type,super.updateDom()}},t.LabeledInputBase=ht,t.Lazy=class{constructor(t){this._func=t,this._value=void 0}get computed(){return!this._func}get rawValue(){return this._value}get value(){return this._func&&(this._value=this._func(),this._func=void 0),this._value}},t.LazyListView=class extends ut{constructor(){super(...arguments),this._loaded=0,this._lazy=!1,this._slowLoading=null,this._autoLoad=null}get loaded(){return this.loaded}get slowLoading(){return this._slowLoading}get autoLoad(){return this._autoLoad}get lazy(){return this._lazy}set lazy(t){this._lazy=t,t||this.ensureLoaded(this.length-1)}ensureLoaded(t){for(t>=this.length&&(t=this.length-1);this._loaded<=t;)this.dom.appendChild(this.items[this._loaded].dom),this._loaded++}loadNext(t=50){return this._loaded<this.length&&(this.ensureLoaded(Math.min(this.length-1,this._loaded+t-1)),!0)}slowlyLoad(t=30,e=50,n=!1){return n&&this.enableAutoLoad(t,e),this._slowLoading?this._slowLoading:this._loaded>=this.length?Promise.resolve(!0):this._slowLoading=new Promise((n=>{var i,o,s=()=>{this._slowLoading&&this.loadNext(e)?o():(this.lazy=!!this._autoLoad,i(),n(!!this._slowLoading),this._slowLoading=null)};if(-1==t&&window.requestIdleCallback){let t;i=()=>window.cancelIdleCallback(t),(o=()=>{t=window.requestIdleCallback(s)})()}else{-1==t&&(t=30);let e=setInterval(s,t);i=()=>clearInterval(e),o=()=>{}}}))}enableAutoLoad(t=30,e=50){this._autoLoad={interval:t,batchSize:e},this.slowlyLoad(t,e)}stopLoading(){this._slowLoading=null,this._autoLoad=null}unload(){this.stopLoading();for(let t=this._loaded-1;t>=0;t--)this.items[t].dom.remove();this.lazy=!0,this._loaded=0}_insertToDom(t,e){!this.lazy||e<this._loaded?(super._insertToDom(t,e),this._loaded++):this._autoLoad&&this.slowlyLoad(this._autoLoad.interval,this._autoLoad.batchSize)}_removeFromDom(t){t.position<this._loaded&&(super._removeFromDom(t),this._loaded--)}},t.ListView=ut,t.ListViewItem=ct,t.LoadingIndicator=class extends v{constructor(t){super(),this._status="running",this.onclick=null,t&&m(this,t)}get state(){return this._status}set state(t){this._status=t,["running","error","normal"].forEach((e=>this.toggleClass(e,t===e)))}get content(){return this._text}set content(t){this._text=t,this.ensureDom(),this._textdom.textContent=t}reset(){this.state="running",this.content=J`Loading`,this.onclick=null}error(t,e){this.state="error",this.content=J`Oh no! Something just goes wrong:`+"\r\n"+t,e&&(this.content+="\r\n"+J`[Click here to retry]`),this.onclick=e}action(t){return gt(this,void 0,void 0,(function*(){try{yield t()}catch(e){this.error(e,(()=>this.action(t)))}}))}createDom(){return{tag:"div.loading-indicator",child:[{tag:"div.loading-indicator-inner",child:[{tag:"div.loading-indicator-text",_id:"text"}]}],onclick:t=>{var e;return null===(e=this.onclick)||void 0===e?void 0:e.call(this,t)}}}postCreateDom(){this._textdom=this.getDomById("text"),this.reset()}},t.MenuInfoItem=class extends pt{constructor(t){super(t),this.text="",this.keepOpen=!0,m(this,t)}createDom(){return{tag:"div.menu-info"}}updateDom(){super.updateDom(),this.dom.textContent=this.text}},t.MenuItem=pt,t.MenuLinkItem=class extends pt{constructor(t){super(t),this.link="",this.download="",m(this,t)}createDom(){var t=super.createDom();return t.tag="a.item.no-selection",t.target="_blank",t}updateDom(){super.updateDom(),this.dom.href=this.link,this.dom.download=this.download}},t.MessageBox=class extends at{constructor(){super(...arguments),this.allowClose=!1,this.title="Message",this.result="none"}addResultBtns(t){for(const e of t)this.addBtnWithResult(new et({text:G.get("msgbox_"+e),right:!0}),e);return this}setTitle(t){return this.title=t,this.domCreated&&this.updateDom(),this}addText(t){return this.addContent(new tt({tag:"div.messagebox-text",text:t})),this}allowCloseWithResult(t,e){return this.result=t,this.allowClose=!0,this.showCloseButton=!!e,this.domCreated&&this.updateDom(),this}addBtnWithResult(t,e){return t.onActive.add((()=>{this.result=e,this.close()})),this.addBtn(t),this}showAndWaitResult(){return rt(this,void 0,void 0,(function*(){return this.show(),yield this.waitClose(),this.result}))}},t.Overlay=st,t.Ref=p,t.Section=class extends v{constructor(t){super(),this.titleView=new tt({tag:"span.section-title"}),this.headerView=new v({tag:"div.section-header",child:[this.titleView]}),this.ensureDom(),t&&(t.title&&this.setTitle(t.title),t.content&&this.setContent(t.content),t.actions&&t.actions.forEach((t=>this.addAction(t))))}createDom(){return{tag:"div.section",child:[this.headerView]}}setTitle(t){this.titleView.removeAllView(),this.titleView.addChild(t)}setContent(t){this.content&&this.removeView(this.content),this.content=v.getView(t),this.appendView(this.content)}addAction(t){var e=t instanceof v?t:new ft({text:t.text,onActive:t.onclick});this.headerView.appendView(e)}},t.SectionAction=ft,t.SelectionHelper=mt,t.Semaphore=class{constructor(t){this.queue=new Array,this.maxCount=1,this.runningCount=0,m(this,t)}enter(){if(this.runningCount===this.maxCount){var t,e=new Promise((e=>{t=e}));return this.queue.push(t),e}return this.runningCount++,Promise.resolve()}exit(){this.runningCount===this.maxCount&&this.queue.length?window.queueMicrotask?window.queueMicrotask(this.queue.shift()):setTimeout(this.queue.shift(),0):this.runningCount--}run(t){return e(this,void 0,void 0,(function*(){yield this.enter();try{yield t()}finally{this.exit()}}))}},t.TabBtn=nt,t.TextBtn=et,t.TextCompositionWatcher=class{constructor(t){this.onCompositingChanged=new g,this._isCompositing=!1,this.dom=w(t),this.dom.addEventListener("compositionstart",(t=>{this.isCompositing=!0})),this.dom.addEventListener("compositionend",(t=>{this.isCompositing=!1}))}get isCompositing(){return this._isCompositing}set isCompositing(t){this._isCompositing=t,this.onCompositingChanged.invoke()}},t.TextView=tt,t.Timer=j,t.Toast=xt,t.ToastsContainer=wt,t.ToolTip=class extends tt{constructor(){super(...arguments),this._shown=!1,this._timer=new j((()=>this.close())),this._cancelClose=null}createDom(){return{tag:"div.tooltip"}}get shown(){return this._shown}show(t){var e;if(this.shown)return;this._shown=!0,null===(e=this._cancelClose)||void 0===e||e.call(this);let{parent:n=document.body,timeout:i}=t;i&&this._timer.timeout(i);const o=this.dom;it(o,t),n.appendChild(o)}close(t){this.shown&&(this._timer.tryCancel(),this._shown=!1,this._cancelClose=U(this.dom,t).cancel)}},t.View=v,t.ViewToggle=class{constructor(t){this.shownKeys=[],this.toggleMode="remove",this.container=null,m(this,t),this.setShownKeys(this.shownKeys)}add(t,e){const n=this.items[t];n?n instanceof Array?this.items[t].push(e):this.items[t]=[n,e]:this.items[t]=e,this.toggleView(e,this.shownKeys.indexOf(t)>=0)}setShownKeys(t){this.shownKeys=t;const e=this.items;for(const n in e){const i=t.indexOf(n)>=0;if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];if(t)if(t instanceof Array)for(const e of t)this.toggleView(e,i);else t&&this.toggleView(t,i)}}}toggleView(t,e,n){if(n||(n=this.toggleMode),"display"==n)t.dom.style.display=e?"":"none";else if("hidden"==n)t.dom.hidden=!e;else{if("remove"!=n)throw new Error("Unknown toggle mode");e!=!!t.parentView&&(e?this.container.appendView(t):this.container.removeView(t))}}},t.addChild=b,t.appendView=x,t.arrayFind=c,t.arrayForeach=d,t.arrayInsert=function(t,e,n){void 0===n?t.push(e):t.splice(n,0,e)},t.arrayMap=l,t.arrayRemove=a,t.arraySum=function(t,e){var n=0;return d(t,(t=>{var i=e(t);i&&(n+=i)})),n},t.base64EncodeUtf8=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode("0x"+e)})))},t.buildDOM=M,t.buildView=O,t.clearChildren=N,t.createArrayBuilder=X,t.createName=function(t,e){for(let n=0;;n++){let i=t(n);if(!e(i))return i}},t.createStringBuilder=Y,t.dragManager=ot,t.fadeout=U,t.foreachFlaten=h,t.formatDateTime=function(t){var e=new Date;return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()?t.toLocaleTimeString():t.toLocaleString()},t.formatDuration=function(t){if("number"!=typeof t||isNaN(t))return"--:--";t=Math.round(t);var e=Math.floor(t/60);return t%=60,o(e.toString(),2,"0")+":"+o(t.toString(),2,"0")},t.formatFileSize=function(t){if("number"!=typeof t||isNaN(t))return"NaN";for(var e=0;e<s.length-1&&t>=1024;)e++,t/=1024;return t.toFixed(2)+" "+s[e]},t.getDOM=w,t.getWebfxCss=Q,t.i18n=G,t.injectCss=$,t.injectWebfxCss=function(){Z||($(':root {\n    --color-bg: white;\n    --color-text: black;\n    --color-text-gray: #666;\n    --color-bg-selection: hsl(5, 100%, 85%);\n    --color-primary: hsl(5, 100%, 67%);\n    --color-primary-darker: hsl(5, 100%, 60%);\n    --color-primary-dark: hsl(5, 100%, 40%);\n    --color-primary-dark-depends: hsl(5, 100%, 40%);\n    --color-primary-verydark: hsl(5, 100%, 20%);\n    --color-primary-light: hsl(5, 100%, 83%);\n    --color-primary-lighter: hsl(5, 100%, 70%);\n    --color-fg-11: #111111;\n    --color-fg-22: #222222;\n    --color-fg-33: #333333;\n    --color-bg-cc: #cccccc;\n    --color-bg-dd: #dddddd;\n    --color-bg-ee: #eeeeee;\n    --color-bg-f8: #f8f8f8;\n    --color-shadow: rgba(0, 0, 0, .5);\n}\n\n.no-selection {\n    user-select: none;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n}\n\n/* listview item */\n\n.item {\n    display: block;\n    position: relative;\n    padding: 10px;\n    /* background: #ddd; */\n    /* animation: showing .3s forwards; */\n    text-decoration: none;\n    line-height: 1.2;\n}\n\na.item {\n    color: inherit;\n}\n\n.clickable, .item {\n    cursor: pointer;\n    transition: transform .3s;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.item:hover, .dragover {\n    background: var(--color-bg-ee);\n}\n\n.keyboard-input .item:focus {\n    outline-offset: -2px;\n}\n\n.dragover-placeholder {\n    /* border-top: 2px solid gray; */\n    position: relative;\n}\n\n.dragover-placeholder::before {\n    content: "";\n    display: block;\n    position: absolute;\n    transform: translate(0, -1px);\n    height: 2px;\n    width: 100%;\n    background: gray;\n    z-index: 100;\n    pointer-events: none;\n}\n\n.clickable:active, .item:active {\n    transition: transform .07s;\n    transform: scale(.97);\n}\n\n.item:active {\n    background: var(--color-bg-dd);\n}\n\n.item.no-transform:active {\n    transform: none;\n}\n\n.item.active {\n    background: var(--color-bg-dd);\n}\n\n.loading-indicator {\n    position: relative;\n    margin: .3em;\n    margin-top: 3em;\n    margin-bottom: 1em;\n    text-align: center;\n    white-space: pre-wrap;\n    cursor: default;\n    animation: loading-fadein .3s;\n}\n\n.loading-indicator-text {\n    margin: 0 auto;\n}\n\n.loading-indicator.running .loading-indicator-inner {\n    display: inline-block;\n    position: relative;\n    vertical-align: bottom;\n}\n\n.loading-indicator.running .loading-indicator-inner::after {\n    content: "";\n    height: 1px;\n    margin: 0%;\n    background: var(--color-text);\n    display: block;\n    animation: fadein .5s 1s backwards;\n}\n\n.loading-indicator.running .loading-indicator-text {\n    margin: 0 .5em;\n    animation: fadein .3s, loading-first .3s .5s cubic-bezier(0.55, 0.055, 0.675, 0.19) reverse, loading-second .3s .8s cubic-bezier(0.55, 0.055, 0.675, 0.19), loading .25s 1.1s cubic-bezier(0.55, 0.055, 0.675, 0.19) alternate-reverse infinite;\n}\n\n.loading-indicator.error {\n    color: red;\n}\n\n.loading-indicator.fading-out {\n    transition: max-height;\n    animation: loading-fadein .3s reverse;\n}\n\n@keyframes loading-fadein {\n    0% {\n        opacity: 0;\n        max-height: 0;\n    }\n    100% {\n        opacity: 1;\n        max-height: 200px;\n    }\n}\n\n@keyframes fadein {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity: 1;\n    }\n}\n\n@keyframes loading-first {\n    0% {\n        transform: translate(0, -2em) scale(1) rotate(360deg);\n    }\n    100% {\n        transform: translate(0, 0) scale(1) rotate(0deg);\n    }\n}\n\n@keyframes loading-second {\n    0% {\n        transform: translate(0, -2em);\n    }\n    100% {\n        transform: translate(0, 0);\n    }\n}\n\n@keyframes loading {\n    0% {\n        transform: translate(0, -1em);\n    }\n    100% {\n        transform: translate(0, 0);\n    }\n}\n\n@keyframes showing {\n    0% {\n        opacity: .3;\n        transform: translate(-20px, 0)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n@keyframes showing-top {\n    0% {\n        opacity: .3;\n        transform: translate(0, -20px)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n@keyframes showing-right {\n    0% {\n        opacity: .3;\n        transform: translate(20px, 0)\n    }\n    100% {\n        opacity: 1;\n        transform: translate(0, 0)\n    }\n}\n\n.overlay {\n    background: rgba(0, 0, 0, .2);\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    animation: fadein .3s;\n    z-index: 10001;\n    overflow: hidden;\n    contain: strict;\n    will-change: transform;\n}\n\n.overlay.fixed {\n    position: fixed;\n}\n\n.overlay.nobg {\n    background: none;\n    will-change: auto;\n}\n\n.overlay.centerChild {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.overlay.clickThrough {\n    pointer-events: none;\n}\n\n.dialog * {\n    box-sizing: border-box;\n}\n\n.dialog {\n    font-size: 14px;\n    position: relative;\n    overflow: auto;\n    background: var(--color-bg);\n    border-radius: 5px;\n    box-shadow: 0 0 12px var(--color-shadow);\n    animation: dialogin .2s ease-out;\n    z-index: 10001;\n    display: flex;\n    flex-direction: column;\n    max-height: 100%;\n    contain: content;\n    will-change: transform;\n    pointer-events: auto;\n}\n\n.dialog.resize {\n    resize: both;\n}\n\n.fading-out .dialog {\n    transition: transform .3s ease-in;\n    transform: scale(.85);\n}\n\n.dialog-title, .dialog-content, .dialog-bottom {\n    padding: 10px;\n}\n\n.dialog-title {\n    background: var(--color-bg-ee);\n}\n\n.dialog-content {\n    flex: 1;\n    padding: 5px 10px;\n    overflow: auto;\n}\n\n.dialog-content.flex {\n    display: flex;\n    flex-direction: column;\n}\n\n.dialog-bottom {\n    padding: 5px 10px;\n}\n\n@keyframes dialogin {\n    0% {\n        transform: scale(.85);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n.input-label {\n    font-size: 80%;\n    color: var(--color-text-gray);\n    margin: 5px 0 3px 0;\n}\n\n.input-text {\n    display: block;\n    width: 100%;\n    padding: 5px;\n    border: solid 1px gray;\n    background: var(--color-bg);\n    color: var(--color-text);\n}\n\n.dialog .input-text {\n    margin: 5px 0;\n}\n\ntextarea.input-text {\n    resize: vertical;\n}\n\n.labeled-input {\n    display: flex;\n    flex-direction: column;\n}\n\n.labeled-input .input-text {\n    flex: 1;\n}\n\n.labeled-input:focus-within .input-label {\n    color: var(--color-primary-darker);\n}\n\n.input-text:focus {\n    border-color: var(--color-primary-darker);\n}\n\n.input-text:active {\n    border-color: var(--color-primary-dark);\n}\n\n.btn {\n    display: block;\n    text-align: center;\n    transition: all .2s;\n    padding: 0 .4em;\n    min-width: 3em;\n    line-height: 1.5em;\n    background: var(--color-primary);\n    color: white;\n    text-shadow: 0 0 4px var(--color-primary-verydark);\n    box-shadow: 0 0 3px var(--color-shadow);\n    cursor: pointer;\n    -ms-user-select: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    position: relative;\n    overflow: hidden;\n}\n\n.btn:hover {\n    transition: all .05s;\n    background: var(--color-primary-darker);\n}\n\n.btn.btn-down, .btn:active {\n    transition: all .05s;\n    background: var(--color-primary-dark);\n    box-shadow: 0 0 1px var(--color-shadow);\n}\n\n.btn.disabled {\n    background: var(--color-primary-light);\n}\n\n.dialog .btn {\n    margin: 10px 0;\n}\n\n.btn-big {\n    padding: 5px;\n}\n\n.btn-inline {\n    display: inline;\n}\n\n.textbtn {\n    display: inline-block;\n    color: var(--color-text-gray);\n    margin: 0 5px;\n}\n\n.textbtn.active {\n    color: var(--color-text);\n}\n\n*[hidden] {\n    display: none !important;\n}\n\n.context-menu {\n    position: absolute;\n    overflow-y: auto;\n    background: var(--color-bg);\n    border: solid 1px #777;\n    box-shadow: 0 0px 12px var(--color-shadow);\n    min-width: 100px;\n    max-width: 450px;\n    outline: none;\n    z-index: 10001;\n    animation: context-menu-in .2s ease-out forwards;\n    will-change: transform;\n}\n\n.context-menu .item.dangerous {\n    transition: color .3s, background .3s;\n    color: red;\n}\n\n.context-menu .item.dangerous:hover {\n    transition: color .1s, background .1s;\n    background: red;\n    color: white;\n}\n\n@keyframes context-menu-in {\n    0% {\n        transform: scale(.9);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n*.menu-shown {\n    background: var(--color-bg-dd);\n}\n\n.menu-info {\n    white-space: pre-wrap;\n    color: var(--color-text-gray);\n    padding: 5px 10px;\n    /* animation: showing .3s; */\n    cursor: default;\n}\n\n.toasts-container {\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    padding: 5px;\n    width: 300px;\n    z-index: 10001;\n    overflow: hidden;\n}\n\n.toast {\n    margin: 5px;\n    padding: 10px;\n    border-radius: 5px;\n    box-shadow: 0 0 10px var(--color-shadow);\n    background: var(--color-bg);\n    white-space: pre-wrap;\n    animation: showing-right .3s;\n}\n\n.fading-out {\n    transition: opacity .3s;\n    opacity: 0;\n    pointer-events: none;\n}\n\n.anchor-bottom {\n    transform: translate(-50%, -100%);\n}\n\n.tooltip {\n    position: absolute;\n    background: var(--color-bg);\n    box-shadow: 0 0 5px var(--color-shadow);\n    border-radius: 5px;\n    padding: .2em .25em;\n}\n',{tag:"style.webfx-injected-style"}),Z=!0)},t.jsx=B,t.jsxBuild=function(t,e){return P(t,64,e||new E)},t.jsxFactory=z,t.listenEvent=K,t.listenEvents=W,t.listenPointerEvents=R,t.mod=function(t,e){return t<0&&(t=e+t),t%e},t.mountView=_,t.numLimit=r,t.objectApply=u,t.objectInit=m,t.readBlobAsDataUrl=function(t){return new Promise(((e,n)=>{var i=new FileReader;i.onload=t=>{e(i.result)},i.onerror=t=>n(),i.readAsDataURL(t)}))},t.replaceChild=function(t,e){N(t),e&&t.appendChild(e)},t.setPosition=it,t.sleepAsync=function(t){return new Promise((e=>{setTimeout(e,t)}))},t.startBlockingDetect=function(t=20){var e=Date.now(),n=Date.now();setInterval((()=>{var i=Date.now();i-n>=t&&console.info(`[Blocking] ${(i-e)/1e3}s: blocked for ${i-n} ms`),n=i}),1)},t.strPadLeft=o,t.toggleClass=H,t.tryGetDOM=f,t.unmountView=C,t.version="1.10.1",Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=webfx.min.js.map
