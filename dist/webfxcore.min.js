!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@yuuza/i18n")):"function"==typeof define&&define.amd?define(["exports","@yuuza/i18n"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).webfx={},t.i18n)}(this,(function(t,e){"use strict";class n{constructor(e){this.parentView=void 0,this._position=void 0,this._domctx=new l,this._dom=void 0,this._baseView=void 0,this._mountState=t.MountState.Unmounted,this._onActive=void 0,this._childViews=void 0,this._domctx.view=this,e&&this.domExprCreated(e)}static getView(t){return t instanceof n?t:new n(t)}get position(){return this._position}get dom(){return this.ensureDom(),this._dom}get domCreated(){return!!this._dom}get baseView(){return this._baseView}get mountState(){return this._mountState}get hidden(){return this.dom.hidden}set hidden(t){this.dom.hidden=t}ensureDom(){if(!this._dom){var t=this.createDom();this.domExprCreated(t)}}domExprCreated(t){var e=_(t,this._domctx);e instanceof n?(this._baseView=e,this._dom=e.dom):this._dom=e,this.postCreateDom(),this.updateDom()}createDom(){return document.createElement("div")}postCreateDom(){n.debugging&&this.dom.dataset&&(this.dom.dataset.webfx=t.MountState[this._mountState])}updateDom(){this._domctx.update()}mountStateChanged(e){if(e!=this._mountState){if(this._mountState=e,n.debugging&&!this._baseView&&this.domCreated&&this.dom.dataset&&(this.dom.dataset.webfx==t.MountState[e]&&console.trace("mountState on the DOM is changed by other view",e,this),this.dom.dataset.webfx=t.MountState[e]),this._baseView)this._baseView.mountStateChanged(e);else if(this._childViews)for(const t of this._childViews)t.mountStateChanged(e)}else console.trace("mountState unchanged",e,this)}getDomById(t){var e,n;return this.ensureDom(),null!==(n=null===(e=this._domctx.dict)||void 0===e?void 0:e[t])&&void 0!==n?n:null}updateWith(t){Q(this,t),this.updateDom()}updateAllWith(t){Q(this,t),this.updateAll()}toggleClass(t,e){j(this.dom,t,e)}getDOM(){return this.dom}addChild(t){const e=_(t,this._domctx);e instanceof n?this.appendView(e):this.dom.appendChild(e)}get onActive(){return this._onActive||(this._onActive=new ot,this.dom.addEventListener("click",(t=>{this._onActive.invoke(t)})),this.dom.addEventListener("keydown",(t=>{this.handleKeyDown(t)}))),this._onActive}handleKeyDown(t){var e;if("Enter"===t.code){const n=this.dom.getBoundingClientRect();null===(e=this._onActive)||void 0===e||e.invoke(new MouseEvent("click",{clientX:n.x,clientY:n.y,relatedTarget:this.dom})),t.preventDefault()}}get childViews(){return this._baseView?this._baseView.childViews:(this._childViews||(this._childViews=[]),this._childViews)}appendView(t){this.addView(t)}addView(e,n){this._registerChild(e,n,!1),this._mountState==t.MountState.Mounted&&e.mountStateChanged(t.MountState.Mounting),this._insertToDom(e,n),this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(this._mountState)}_registerChild(e,n,i=!0){const o=this.childViews;if(e.parentView)throw new Error("the view is already in a container view");if(e.parentView=this,void 0===n)e._position=o.length,o.push(e);else{o.splice(n,0,e);for(let t=n;t<o.length;t++)o[t]._position=t}i&&this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(this._mountState)}removeView(e){e=this._ensureItem(e),this._removeFromDom(e);var n=e._position;e.parentView=e._position=void 0,this.childViews.splice(n,1);for(let t=n;t<this.childViews.length;t++)this.childViews[t]._position=t;this._mountState!=t.MountState.Unmounted&&e.mountStateChanged(t.MountState.Unmounted)}removeAllView(){for(;this.childViews.length;)this.removeView(this.childViews.length-1)}removeFromParent(){this.parentView&&this.parentView.removeView(this)}updateAll(){if(this.updateDom(),this.baseView)return this.baseView.updateAll();this.updateChildren()}updateChildren(){if(this._childViews)for(const t of this._childViews)t.updateAll()}_insertToDom(t,e){var n;null==e?this.dom.appendChild(t.dom):this.dom.insertBefore(t.dom,(null===(n=this.childViews[e+1])||void 0===n?void 0:n.dom)||null)}_removeFromDom(t){t.domCreated&&t.dom.remove()}_ensureItem(t){if("number"==typeof t)t=this.childViews[t];else{if(!t)throw new Error("item is null or undefined.");if(t.parentView!==this)throw new Error("the item is not in this listview.")}return t}}function i(t){return t?t instanceof n?t.getDOM():t instanceof Node?t:t&&"getDOM"in t?t.getDOM():void 0:t}function o(t){var e=i(t);if(!e)throw console.error("getDOM():",t),new Error("getDOM(): unsupported parameter: "+t);return e}function s(t,e){a(t,e),o(t).appendChild(e.dom)}function r(t,e){if(t instanceof n)t.addChild(e);else if(t instanceof Node)a(t,e),t.appendChild(y(e));else{if(!("addChild"in t))throw console.error("addChild():",{parent:t,child:e}),new Error("addChild(): unsupported parent");t.addChild(e)}}function a(t,e){if(e instanceof n){const n={parent:t,child:e};t instanceof Node?console.trace("Should use `mountView()` to mount a view to DOM.",n):console.trace("Should use `View.addChild()` or `View.appendView()` to add a view into another view.",n)}}n.debugging=!1,Node.prototype.getDOM=function(){return console.trace("webfx: Node.getDOM() is deprecated. Please use the exported function `getDOM()` instead."),this},Node.prototype.addChild=function(t){console.trace("webfx: Node.addChild() is deprecated. Please use the exported function `addChild()` instead."),r(this,t)},Node.prototype.appendView=function(t){console.trace("webfx: Node.appendView() is deprecated. Please use the exported function `appendView()` instead."),s(this,t)};class u extends n{addView(t,e){return super.addView(t,e)}removeView(t){super.removeView(t)}_insertToDom(t,e){super._insertToDom(t,e)}_removeFromDom(t){super._removeFromDom(t)}_ensureItem(t){return super._ensureItem(t)}get items(){return this.childViews}[Symbol.iterator](){return this.childViews[Symbol.iterator]()}get length(){return this.childViews.length}get(t){return this.childViews[t]}map(t){return J(this,t)}find(t){return H(this,t)}forEach(t){return K(this,t)}}var d;t.MountState=void 0,(d=t.MountState||(t.MountState={}))[d.Unmounted=0]="Unmounted",d[d.Mounting=1]="Mounting",d[d.Mounted=2]="Mounted";const h=()=>{},c=new Map;class l{constructor(){this.dict=void 0,this.actions=void 0,this.view=void 0,this.update=this._compileUpdate}setDict(t,e){this.dict||(this.dict={}),this.dict[t]=e}addUpdateAction(t){this.actions||(this.actions=[]),this.actions.push(t)}_compileUpdate(){if(!this.actions)return void(this.update=h);let t=[],e=[];for(const n of this.actions)n.compile(t,e);const n=`return function() {\n            ${t.join(";\n")}\n        }`;let i=c.get(n);i||(i=new Function(...e.map(((t,e)=>"v"+e)),n),c.set(n,i)),this.update=i.apply(null,e),this.update()}}class f{constructor(t,e){this.node=t,this.func=e}run(){this.node.textContent=this.func()}compile(t,e){t.push(`v${e.length}.textContent = v${e.length+1}()`),e.push(this.node,this.func)}}class m{constructor(t,e){this.node=t,this.func=e}run(){this.node.hidden=this.func()}compile(t,e){t.push(`v${e.length}.hidden = v${e.length+1}()`),e.push(this.node,this.func)}}class v{constructor(t,e){this.node=t,this.func=e}run(){this.func(this.node)}compile(t,e){t.push(`v${e.length+1}(v${e.length})`),e.push(this.node,this.func)}}function p(t,e){if("string"==typeof t)return document.createTextNode(t);if("function"==typeof t){const n=t();if(n&&"object"==typeof n)throw new Error("Unexpected function return value");{const i=document.createTextNode(n);return null==e||e.addUpdateAction(new f(i,t)),i}}return Node&&t instanceof Node?t:null}var w=function(t,e,i){var o;if(e--<0)throw new Error("ran out of TTL");var s=p(t,i);if(s)return s;if(t instanceof C&&!((t=t.buildView(i,e))instanceof n))return t;if(t instanceof n)return null===(o=null==i?void 0:i.view)||void 0===o||o._registerChild(t),t.getDOM();const r=t.tag;if(!r)throw new Error("no tag");var a=function(t){for(var e,n,i=/[#\.^]?[\w\-]+/y;e=i.exec(t);){var o=e[0],s=o[0];if("."===s)n.classList.add(o.substr(1));else if("#"===s)n.id=o.substr(1);else{if(n)throw new Error("unexpected multiple tags");n=document.createElement(o)}}return n}(r);for(var u in t)if(t.hasOwnProperty(u)){var d=t[u];g(u,d,a,i,e)}const h=t.init;return h&&h(a),a},g=function(t,e,n,i,o){if("child"===t)e instanceof Array?Y(e,(function(t){n.appendChild(w(t,o,i))})):n.appendChild(w(e,o,i));else if("_id"===t||"_key"===t)i.setDict(e,n);else if("ref"===t)e.value=n;else if("text"===t)"function"==typeof e?i.addUpdateAction(new f(n,e)):n.textContent=e;else if("class"===t)n.className=e;else if("style"===t&&"object"==typeof e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const i=e[t];n.style[t]=i}}else"hidden"===t&&"function"==typeof e?i.addUpdateAction(new m(n,e)):"update"===t&&"function"==typeof e?i.addUpdateAction(new v(n,e)):"init"===t||(n[t]=e)};function y(t,e){return w(t,32,e||null)}function _(t,e){return t instanceof n?t:t instanceof C?t.buildView(e,64):y(t,e)}class C{constructor(t,e,n){this.tag=t,this.attrs=e,this.child=n}getDOM(){return this.buildDom(null,64)}buildDom(t,e){return o(this.buildView(t,e))}buildView(t,e){if(e--<0)throw new Error("ran out of TTL");let i;if("string"==typeof this.tag){const n=document.createElement(this.tag);if(i=n,this.attrs){for(const i in this.attrs)if(Object.prototype.hasOwnProperty.call(this.attrs,i)){const o=this.attrs[i];g(i,o,n,t,e)}const i=this.attrs.init;i&&i(n)}}else if(i=this.tag,this.attrs){let t=null;for(const e in this.attrs)if(Object.prototype.hasOwnProperty.call(this.attrs,e)){const n=this.attrs[e];"init"==e?t=n:"ref"==e?n.value=i:e.startsWith("on")&&i[e]instanceof ot?i[e].add(n):i[e]=n}t&&t(i)}return this.child&&Y(this.child,i instanceof n?t=>{i.addChild(b(t,e,i._domctx))}:o=>{var s;const a=b(o,e,t);a instanceof n?(i.appendChild(a.dom),null===(s=null==t?void 0:t.view)||void 0===s||s._registerChild(a)):r(i,a)}),i}addChild(t){null==this.child&&(this.child=[]),this.child.push(t)}}function b(t,e,i){if(e--<0)throw new Error("ran out of TTL");if(t instanceof n)return t;var o=p(t,i);if(o)return o;if(t instanceof C)return t.buildView(i,e);throw console.error("Unknown node type",t),new Error("Unknown node type")}function E(t,e,...n){if("string"==typeof t)return new C(t,e,n);{const i=(null==e?void 0:e.args)?new t(...e.args):new t;return new C(i,e,n)}}const V=E;var S=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}u((i=i.apply(t,e||[])).next())}))};const D=Object.assign,x=Object.prototype.hasOwnProperty;function M(t,e,n=" "){for(;t.length<e;)t=n+t;return t}function k(t){if("number"!=typeof t||isNaN(t))return"--:--";t=Math.round(t);var e=Math.floor(t/60);return t%=60,M(e.toString(),2,"0")+":"+M(t.toString(),2,"0")}const I=["B","KB","MB","GB"];function A(t){if("number"!=typeof t||isNaN(t))return"NaN";for(var e=0;e<I.length-1&&t>=1024;)e++,t/=1024;return t.toFixed(2)+" "+I[e]}function L(t){var e=new Date;return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()?t.toLocaleTimeString():t.toLocaleString()}function O(t,e,n){return t<e||"number"!=typeof t||isNaN(t)?e:t>n?n:t}function T(t,e){for(let n=0;;n++){let i=t(n);if(!e(i))return i}}function N(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode("0x"+e)})))}function F(t){return new Promise((e=>{setTimeout(e,t)}))}function P(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function U(t,e){P(t),e&&t.appendChild(e)}function j(t,e,n){var i=t.classList;return i.toggle?i.toggle(e,n):(void 0===n&&(n=!i.contains(e)),n?i.add(e):i.remove(e),n)}function R(t,e){const{className:n="fading-out",duration:i=500,remove:o=!0}=e||{};t.classList.add(n);var s=null,r=(e=!0)=>{r&&(r=null,t.removeEventListener("transitionend",a),t.classList.remove(n),o&&e&&t.remove(),e&&(null==s||s()))},a=function(t){t.eventPhase===Event.AT_TARGET&&(null==r||r())};return t.addEventListener("transitionend",a),setTimeout(r,i),{get finished(){return!r},onFinished(t){return r?s=t:t(),this},cancel(t=!1){null==r||r(t)}}}function z(t,e,n){var i=!1,o=function(t){if("track"===e({type:"mouse",ev:t,point:t,action:"down"})){var n=function(t){e({type:"mouse",ev:t,point:t,action:"move"})},i=function(t){document.removeEventListener("mousemove",n,!0),document.removeEventListener("mouseup",i,!0),e({type:"mouse",ev:t,point:t,action:"up"})};document.addEventListener("mousemove",n,!0),document.addEventListener("mouseup",i,!0)}},s=function(o){var s=o.changedTouches[0],r=e({type:"touch",touch:"start",ev:o,point:s,action:i?"move":"down"});if(!i&&"track"===r){i=!0;var a=function(t){var n=t.changedTouches[0];e({type:"touch",touch:"move",ev:t,point:n,action:"move"})},u=function(n){0===n.touches.length&&(i=!1,t.removeEventListener("touchmove",a),t.removeEventListener("touchend",u),t.removeEventListener("touchcancel",u));var o=n.changedTouches[0];e({type:"touch",touch:"end",ev:n,point:o,action:i?"move":"up"})};t.addEventListener("touchmove",a,n),t.addEventListener("touchend",u,n),t.addEventListener("touchcancel",u,n)}};return t.addEventListener("mousedown",o,n),t.addEventListener("touchstart",s,n),{remove:()=>{t.removeEventListener("mousedown",o,n),t.removeEventListener("touchstart",s,n)}}}function B(t,e,n){return t.addEventListener(e,n),{remove:()=>t.removeEventListener(e,n)}}function q(t,e,n){return e.forEach((e=>t.addEventListener(e,n))),{remove:()=>e.forEach((e=>t.removeEventListener(e,n)))}}function $(t,e){var n;document.head.appendChild(y({tag:null!==(n=null==e?void 0:e.tag)&&void 0!==n?n:"style",text:t}))}function W(t,e){for(let n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),n--)}function G(t,e,n){void 0===n?t.push(e):t.splice(n,0,e)}function J(t,e){if(t instanceof Array)return t.map(e);var n=0,i=new Array(t.length);for(var o of t)i[n]=e(o,n),n++;return i}function K(t,e){var n=0;for(var i of t)e(i,n++)}function Y(t,e){for(const n of t)n instanceof Array?Y(n,e):e(n)}function H(t,e){if(t instanceof Array)return t.find(e);var n=0;for(var i of t)if(e(i,n++))return i;return null}function X(t,e){var n=0;return K(t,(t=>{var i=e(t);i&&(n+=i)})),n}function Q(t,e,n){if(e){if(!n)return D(t,e);for(const i in e)if(x.call(e,i)&&(!n||n.indexOf(i)>=0)){const n=e[i];t[i]=n}}return t}function Z(t,e,n){if(e)for(const i in e)if(x.call(e,i)&&(!n||n.indexOf(i)>=0)){const n=e[i];i.startsWith("on")&&t[i]instanceof ot?t[i].add(n):t[i]=n}return t}function tt(t,e){return t<0&&(t=e+t),t%e}function et(t){return new Promise(((e,n)=>{var i=new FileReader;i.onload=t=>{e(i.result)},i.onerror=t=>n(),i.readAsDataURL(t)}))}Array.prototype.remove=function(t){W(this,t)};class nt{constructor(t){this.callback=t,this.cancelFunc=void 0}timeout(t){this.tryCancel();var e=setTimeout(this.callback,t);this.cancelFunc=()=>window.clearTimeout(e)}interval(t){this.tryCancel();var e=setInterval(this.callback,t);this.cancelFunc=()=>window.clearInterval(e)}animationFrame(){this.tryCancel();var t=requestAnimationFrame(this.callback);this.cancelFunc=()=>cancelAnimationFrame(t)}tryCancel(){this.cancelFunc&&(this.cancelFunc(),this.cancelFunc=void 0)}}class it{constructor(t,e,n){if(this.onRender=null,this.key=t,!(e=this.type="string"==typeof e?it.types[e]:e)||!e.serialize||!e.deserialize)throw new Error("invalid 'type' arugment");this.readFromStorage(n)}readFromStorage(t){var e=this.key?localStorage.getItem(this.key):null;this.isInitial=!e,this.set(e?this.type.deserialize(e):t,!0)}render(t,e){e||t(this.data);const n=this.onRender,i=t;return n&&(t=function(t){n(t),i(t)}),this.onRender=t,this}bindToBtn(t,e){if(this.type!==it.types.bool)throw new Error("only for bool type");var n=document.createElement("span");t.insertBefore(n,t.firstChild),this.render((function(i){t.classList.toggle("disabled",!i),e=e||["❌","✅"],n.textContent=e[+i]}));var i=this;return t.addEventListener("click",(function(){i.toggle()})),this}remove(){localStorage.removeItem(this.key)}save(){this.isInitial=!1,localStorage.setItem(this.key,this.type.serialize(this.data))}set(t,e){this.data=t,this.isInitial=!1,this.onRender&&this.onRender(t),!e&&this.key&&this.save()}get(){return this.data}toggle(){if(this.type!==it.types.bool)throw new Error("only for bool type");this.set(!this.data)}loop(t){var e=this.data,n=t.findIndex((function(t){return t===e})),i=t[(n+1)%t.length];this.set(i)}}it.types={bool:{serialize:function(t){return t?"true":"false"},deserialize:function(t){return"true"===t||"false"!==t&&void 0}},str:{serialize:function(t){return t},deserialize:function(t){return t}},json:{serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return JSON.parse(t)}}};const ot=class extends Array{constructor(){super(...arguments),this._hook=void 0}get onChanged(){var t;return null!==(t=this._hook)&&void 0!==t||(this._hook=new ot),this._hook}invoke(...t){this.forEach((e=>{try{e.apply(this,t)}catch(t){console.error("Error in callback",t)}}))}add(t){var e;return this.push(t),null===(e=this._hook)||void 0===e||e.invoke(!0,t),t}remove(t){var e;super.remove(t),null===(e=this._hook)||void 0===e||e.invoke(!1,t)}};const st={strPadLeft:M,formatTime:k,formatFileSize:A,formatDateTime:L,numLimit:O,createName:T,base64EncodeUtf8:N,sleepAsync:F,clearChildren:P,replaceChild:U,toggleClass:j,fadeout:R,listenPointerEvents:z,listenEvent:B,listenEvents:q,injectCss:$,arrayRemove:W,arrayInsert:G,arrayMap:J,arrayForeach:K,arrayFind:H,arraySum:X,objectApply:Q,objectInit:Z,mod:tt,readBlobAsDataUrl:et,buildDOM:y,Timer:nt};t.AutoResetEvent=class{constructor(){this._whenNotify=null,this._callback=null}wait(){return this._whenNotify||(this._whenNotify=new Promise((t=>{this._callback=()=>{this._callback=this._whenNotify=null,t()}}))),this._whenNotify}set(){this._callback&&this._callback()}},t.BuildDOMCtx=l,t.Callbacks=ot,t.CancelToken=class{constructor(){this.cancelled=!1,this.onCancelled=new ot}cancel(){this.cancelled||(this.cancelled=!0,this.onCancelled.invoke())}throwIfCancelled(){if(this.cancelled)throw new Error("operation cancelled.")}},t.ContainerView=u,t.DataUpdatingHelper=class{update(t){const e=this.items;var n={};for(const e of t)n[this.dataSelectId(e)]=e;var i={},o=[];for(const t of e){const e=this.selectId(t);void 0!==n[e]?i[e]=t:o.push(t)}for(let t=o.length-1;t>=0;t--)this.removeItem(o[t]);var s=0;for(const e of t){const t=i[this.dataSelectId(e)];void 0!==t?this.updateItem(t,e):this.addItem(e,s),s++}}updateOrRebuildAll(t){this.update(t),this.isSame(t)||this.rebuildAll(t)}isSame(t){var e=this.items[Symbol.iterator]();for(const i of t){var n=e.next();if(n.done)return!1;if(this.selectId(n.value)!==this.dataSelectId(i))return!1}return!!e.next().done}rebuildAll(t){var e=this.items;if(e instanceof Array)for(let t=e.length-1;t>=0;t--)this.removeItem(e[t]);else for(const t of e)this.removeItem(t);let n=0;for(const e of t)this.addItem(e,n++)}selectId(t){return t.id}dataSelectId(t){return t.id}addItem(t,e){}updateItem(t,e){}removeItem(t){}},t.EventRegistrations=class{constructor(){this.list=[]}add(t,e){return this.list.push({event:t,func:e}),t.add(e),e}removeAll(){for(;this.list.length;){var t=this.list.pop();t.event.remove(t.func)}}},t.InputStateTracker=class{constructor(t){this.dom=t,this.state={mouseDown:!1,mouseIn:!1,focusIn:!1},this._removeEvents=null,this._removePointerEvents=null,this.onChanged=new ot,this._removeEvents=q(t,["mouseenter","mouseleave","focusin","focusout"],(t=>{switch(t.type){case"mouseenter":this.stateChanged("mouseIn",!0);break;case"mouseleave":this.stateChanged("mouseIn",!1);break;case"focusin":this.stateChanged("focusIn",!0);break;case"focusout":this.stateChanged("focusIn",!1)}})).remove,this._removePointerEvents=z(t,(t=>{if("down"==t.action)return this.stateChanged("mouseDown",!0),"track";"up"==t.action&&this.stateChanged("mouseDown",!1)})).remove}stateChanged(t,e){this.state[t]=e,this.onChanged.invoke(t)}removeListeners(){var t,e;null===(t=this._removeEvents)||void 0===t||t.call(this),null===(e=this._removePointerEvents)||void 0===e||e.call(this),this._removePointerEvents=this._removeEvents=null}},t.JsxNode=C,t.Lazy=class{constructor(t){this._func=t,this._value=void 0}get computed(){return!this._func}get rawValue(){return this._value}get value(){return this._func&&(this._value=this._func(),this._func=void 0),this._value}},t.Ref=class{constructor(){this._value=void 0,this._onChanged=void 0}get onChanged(){return this._onChanged||(this._onChanged=new ot),this._onChanged}get value(){return this._value}set value(t){this._value=t,this._onChanged&&this.onChanged.invoke(this)}},t.Semaphore=class{constructor(t){this.queue=new Array,this.maxCount=1,this.runningCount=0,Z(this,t)}enter(){if(this.runningCount===this.maxCount){var t,e=new Promise((e=>{t=e}));return this.queue.push(t),e}return this.runningCount++,Promise.resolve()}exit(){this.runningCount===this.maxCount&&this.queue.length?window.queueMicrotask?window.queueMicrotask(this.queue.shift()):setTimeout(this.queue.shift(),0):this.runningCount--}run(t){return S(this,void 0,void 0,(function*(){yield this.enter();try{yield t()}finally{this.exit()}}))}},t.SettingItem=it,t.TextCompositionWatcher=class{constructor(t){this.onCompositingChanged=new ot,this._isCompositing=!1,this.dom=o(t),this.dom.addEventListener("compositionstart",(t=>{this.isCompositing=!0})),this.dom.addEventListener("compositionend",(t=>{this.isCompositing=!1}))}get isCompositing(){return this._isCompositing}set isCompositing(t){this._isCompositing=t,this.onCompositingChanged.invoke()}},t.Timer=nt,t.View=n,t.addChild=r,t.appendView=s,t.arrayFind=H,t.arrayForeach=K,t.arrayInsert=G,t.arrayMap=J,t.arrayRemove=W,t.arraySum=X,t.base64EncodeUtf8=N,t.buildDOM=y,t.buildView=_,t.clearChildren=P,t.createName=T,t.fadeout=R,t.foreachFlaten=Y,t.formatDateTime=L,t.formatFileSize=A,t.formatTime=k,t.getDOM=o,t.injectCss=$,t.jsx=V,t.jsxBuild=function(t,e){return b(t,64,e||new l)},t.jsxFactory=E,t.listenEvent=B,t.listenEvents=q,t.listenPointerEvents=z,t.mod=tt,t.mountView=function(e,n){n.mountStateChanged(t.MountState.Mounting),e.appendChild(n.dom),n.mountStateChanged(t.MountState.Mounted)},t.numLimit=O,t.objectApply=Q,t.objectInit=Z,t.readBlobAsDataUrl=et,t.replaceChild=U,t.sleepAsync=F,t.startBlockingDetect=function(t=20){var e=Date.now(),n=Date.now();setInterval((()=>{var i=Date.now();i-n>=t&&console.info(`[Blocking] ${(i-e)/1e3}s: blocked for ${i-n} ms`),n=i}),1)},t.strPadLeft=M,t.toggleClass=j,t.tryGetDOM=i,t.unmountView=function(e,n){n.dom.remove(),n.mountStateChanged(t.MountState.Unmounted)},t.utils=st,t.version="1.9.11",Object.keys(e).forEach((function(n){"default"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})})),Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=webfxcore.min.js.map
