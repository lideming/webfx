{"version":3,"file":"webfx.min.js","sources":["../lib/utils.js","../lib/I18n.js","../lib/viewlib.js"],"sourcesContent":["// file: utils.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst _object_assign = Object.assign;\nconst _object_hasOwnProperty = Object.prototype.hasOwnProperty;\n/** The name \"utils\" tells it all. */\nexport var utils = new class Utils {\n    constructor() {\n        // Time & formatting utils:\n        this.fileSizeUnits = ['B', 'KB', 'MB', 'GB'];\n    }\n    strPadLeft(str, len, ch = ' ') {\n        while (str.length < len) {\n            str = ch + str;\n        }\n        return str;\n    }\n    formatTime(sec) {\n        if (typeof sec !== 'number' || isNaN(sec))\n            return '--:--';\n        sec = Math.round(sec);\n        var min = Math.floor(sec / 60);\n        sec %= 60;\n        return this.strPadLeft(min.toString(), 2, '0') + ':' + this.strPadLeft(sec.toString(), 2, '0');\n    }\n    formatFileSize(size) {\n        if (typeof size !== \"number\" || isNaN(size))\n            return 'NaN';\n        var unit = 0;\n        while (unit < this.fileSizeUnits.length - 1 && size >= 1024) {\n            unit++;\n            size /= 1024;\n        }\n        return size.toFixed(2) + ' ' + this.fileSizeUnits[unit];\n    }\n    formatDateTime(date) {\n        var now = new Date();\n        var sameday = date.getFullYear() === now.getFullYear()\n            && date.getMonth() === now.getMonth()\n            && date.getDate() === now.getDate();\n        return sameday ? date.toLocaleTimeString() : date.toLocaleString();\n    }\n    numLimit(num, min, max) {\n        return (num < min || typeof num != 'number' || isNaN(num)) ? min :\n            (num > max) ? max : num;\n    }\n    createName(nameFunc, existsFunc) {\n        for (let num = 0;; num++) {\n            let str = nameFunc(num);\n            if (!existsFunc(str))\n                return str;\n        }\n    }\n    /**\n     * btoa, but supports Unicode and uses UTF-8 encoding.\n     * @see https://stackoverflow.com/questions/30106476\n     */\n    base64EncodeUtf8(str) {\n        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {\n            return String.fromCharCode(('0x' + p1));\n        }));\n    }\n    sleepAsync(time) {\n        return new Promise((resolve) => {\n            setTimeout(resolve, time);\n        });\n    }\n    /** Remove all children from the node */\n    clearChildren(node) {\n        while (node.lastChild)\n            node.removeChild(node.lastChild);\n    }\n    /** Remove all children from the node (if needed) and append one (if present) */\n    replaceChild(node, newChild) {\n        this.clearChildren(node);\n        if (newChild)\n            node.appendChild(newChild);\n    }\n    /** Add or remove a classname for the element\n     * @param force - true -> add; false -> remove; undefined -> toggle.\n     */\n    toggleClass(element, clsName, force) {\n        var clsList = element.classList;\n        if (clsList.toggle)\n            return clsList.toggle(clsName, force);\n        if (force === undefined)\n            force = !clsList.contains(clsName);\n        if (force)\n            clsList.add(clsName);\n        else\n            clsList.remove(clsName);\n        return force;\n    }\n    /** Fade out the element and remove it */\n    fadeout(element) {\n        element.classList.add('fading-out');\n        var cb = null;\n        var end = () => {\n            if (!end)\n                return; // use a random variable as flag ;)\n            end = null;\n            element.removeEventListener('transitionend', onTransitionend);\n            element.classList.remove('fading-out');\n            element.remove();\n            cb && cb();\n        };\n        var onTransitionend = function (e) {\n            if (e.eventPhase === Event.AT_TARGET)\n                end();\n        };\n        element.addEventListener('transitionend', onTransitionend);\n        setTimeout(end, 350); // failsafe\n        return {\n            get finished() { return !end; },\n            onFinished(callback) {\n                if (!end)\n                    callback();\n                else\n                    cb = callback;\n            },\n            cancel() { end === null || end === void 0 ? void 0 : end(); }\n        };\n    }\n    listenPointerEvents(element, callback) {\n        element.addEventListener('mousedown', function (e) {\n            if (callback({ type: 'mouse', ev: e, point: e, action: 'down' }) === 'track') {\n                var mousemove = function (e) {\n                    callback({ type: 'mouse', ev: e, point: e, action: 'move' });\n                };\n                var mouseup = function (e) {\n                    document.removeEventListener('mousemove', mousemove, true);\n                    document.removeEventListener('mouseup', mouseup, true);\n                    callback({ type: 'mouse', ev: e, point: e, action: 'up' });\n                };\n                document.addEventListener('mousemove', mousemove, true);\n                document.addEventListener('mouseup', mouseup, true);\n            }\n        });\n        var touchDown = false;\n        element.addEventListener('touchstart', function (e) {\n            var ct = e.changedTouches[0];\n            var ret = callback({\n                type: 'touch', touch: 'start', ev: e, point: ct,\n                action: touchDown ? 'move' : 'down'\n            });\n            if (!touchDown && ret === 'track') {\n                touchDown = true;\n                var touchmove = function (e) {\n                    var ct = e.changedTouches[0];\n                    callback({ type: 'touch', touch: 'move', ev: e, point: ct, action: 'move' });\n                };\n                var touchend = function (e) {\n                    if (e.touches.length === 0) {\n                        touchDown = false;\n                        element.removeEventListener('touchmove', touchmove);\n                        element.removeEventListener('touchend', touchend);\n                    }\n                    var ct = e.changedTouches[0];\n                    callback({\n                        type: 'touch', touch: 'end', ev: e, point: ct,\n                        action: touchDown ? 'move' : 'up'\n                    });\n                };\n                element.addEventListener('touchmove', touchmove);\n                element.addEventListener('touchend', touchend);\n            }\n        });\n    }\n    addEvent(element, event, handler) {\n        element.addEventListener(event, handler);\n        return {\n            remove: () => element.removeEventListener(event, handler)\n        };\n    }\n    arrayRemove(array, val) {\n        for (let i = 0; i < array.length; i++) {\n            if (array[i] === val) {\n                array.splice(i, 1);\n                i--;\n            }\n        }\n    }\n    arrayInsert(array, val, pos) {\n        if (pos === undefined)\n            array.push(val);\n        else\n            array.splice(pos, 0, val);\n    }\n    arrayMap(arr, func) {\n        if (arr instanceof Array)\n            return arr.map(func);\n        var idx = 0;\n        var ret = new Array(arr.length);\n        for (var item of arr) {\n            ret[idx] = (func(item, idx));\n            idx++;\n        }\n        return ret;\n    }\n    arrayForeach(arr, func) {\n        var idx = 0;\n        for (var item of arr) {\n            func(item, idx++);\n        }\n    }\n    arrayFind(arr, func) {\n        if (arr instanceof Array)\n            return arr.find(func);\n        var idx = 0;\n        for (var item of arr) {\n            if (func(item, idx++))\n                return item;\n        }\n        return null;\n    }\n    arraySum(arr, func) {\n        var sum = 0;\n        this.arrayForeach(arr, (x) => {\n            var val = func(x);\n            if (val)\n                sum += val;\n        });\n        return sum;\n    }\n    objectApply(obj, kv, keys) {\n        if (kv) {\n            if (!keys)\n                return _object_assign(obj, kv);\n            for (const key in kv) {\n                if (_object_hasOwnProperty.call(kv, key) && (!keys || keys.indexOf(key) >= 0)) {\n                    const val = kv[key];\n                    obj[key] = val;\n                }\n            }\n        }\n        return obj;\n    }\n    mod(a, b) {\n        if (a < 0)\n            a = b + a;\n        return a % b;\n    }\n    readBlobAsDataUrl(blob) {\n        return new Promise((resolve, reject) => {\n            var reader = new FileReader();\n            reader.onload = (ev) => {\n                resolve(reader.result);\n            };\n            reader.onerror = (ev) => reject();\n            reader.readAsDataURL(blob);\n        });\n    }\n};\nArray.prototype.remove = function (item) {\n    utils.arrayRemove(this, item);\n};\nexport class Timer {\n    constructor(callback) {\n        this.callback = callback;\n        this.cancelFunc = undefined;\n    }\n    timeout(time) {\n        this.tryCancel();\n        var handle = setTimeout(this.callback, time);\n        this.cancelFunc = () => window.clearTimeout(handle);\n    }\n    interval(time) {\n        this.tryCancel();\n        var handle = setInterval(this.callback, time);\n        this.cancelFunc = () => window.clearInterval(handle);\n    }\n    animationFrame() {\n        this.tryCancel();\n        var handle = requestAnimationFrame(this.callback);\n        this.cancelFunc = () => cancelAnimationFrame(handle);\n    }\n    tryCancel() {\n        if (this.cancelFunc) {\n            this.cancelFunc();\n            this.cancelFunc = undefined;\n        }\n    }\n}\nutils.Timer = Timer;\nexport class BuildDOMCtx {\n    constructor(dict) {\n        this.dict = dict !== null && dict !== void 0 ? dict : {};\n    }\n    static EnsureCtx(ctxOrDict, origctx) {\n        var ctx;\n        if (ctxOrDict instanceof BuildDOMCtx)\n            ctx = ctxOrDict;\n        else\n            ctx = new BuildDOMCtx(ctxOrDict);\n        if (origctx) {\n            if (!origctx.actions)\n                origctx.actions = [];\n            ctx.actions = origctx.actions;\n        }\n        return ctx;\n    }\n    setDict(key, node) {\n        if (!this.dict)\n            this.dict = {};\n        this.dict[key] = node;\n    }\n    addUpdateAction(action) {\n        if (!this.actions)\n            this.actions = [];\n        this.actions.push(action);\n        // BuildDOMCtx.executeAction(action);\n    }\n    update() {\n        if (!this.actions)\n            return;\n        for (const a of this.actions) {\n            BuildDOMCtx.executeAction(a);\n        }\n    }\n    static executeAction(a) {\n        switch (a[0]) {\n            case 'text':\n                a[1].textContent = a[2]();\n                break;\n            case 'hidden':\n                a[1].hidden = a[2]();\n                break;\n            case 'update':\n                a[2](a[1]);\n                break;\n            default:\n                console.warn('unknown action', a);\n                break;\n        }\n    }\n}\nexport const buildDOM = utils.buildDOM = (() => {\n    var createElementFromTag = function (tag) {\n        var reg = /[#\\.^]?[\\w\\-]+/y;\n        var match;\n        var ele;\n        while (match = reg.exec(tag)) {\n            var val = match[0];\n            var ch = val[0];\n            if (ch === '.') {\n                ele.classList.add(val.substr(1));\n            }\n            else if (ch === '#') {\n                ele.id = val.substr(1);\n            }\n            else {\n                if (ele)\n                    throw new Error('unexpected multiple tags');\n                ele = document.createElement(val);\n            }\n        }\n        return ele;\n    };\n    var buildDomCore = function (obj, ttl, ctx) {\n        if (ttl-- < 0)\n            throw new Error('ran out of TTL');\n        if (typeof (obj) === 'string') {\n            return document.createTextNode(obj);\n        }\n        if (Node && obj instanceof Node)\n            return obj;\n        if ('getDOM' in obj)\n            return obj.getDOM();\n        const tag = obj.tag;\n        if (!tag)\n            throw new Error('no tag');\n        var node = createElementFromTag(tag);\n        if (obj['_ctx'])\n            ctx = BuildDOMCtx.EnsureCtx(obj['_ctx'], ctx);\n        for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                var val = obj[key];\n                if (key === 'child') {\n                    if (val instanceof Array) {\n                        val.forEach(function (x) {\n                            node.appendChild(buildDomCore(x, ttl, ctx));\n                        });\n                    }\n                    else {\n                        node.appendChild(buildDomCore(val, ttl, ctx));\n                    }\n                }\n                else if (key === '_key') {\n                    ctx.setDict(val, node);\n                }\n                else if (key === 'text') {\n                    if (typeof val === 'function') {\n                        ctx.addUpdateAction(['text', node, val]);\n                    }\n                    else {\n                        node.textContent = val;\n                    }\n                }\n                else if (key === 'hidden' && typeof val === 'function') {\n                    ctx.addUpdateAction(['hidden', node, val]);\n                }\n                else if (key === 'update' && typeof val === 'function') {\n                    ctx.addUpdateAction(['update', node, val]);\n                }\n                else if (key === 'init') {\n                    // no-op\n                }\n                else {\n                    node[key] = val;\n                }\n            }\n            const init = obj['init'];\n            if (init)\n                init(node);\n        }\n        return node;\n    };\n    return function (obj, ctx) {\n        return buildDomCore(obj, 32, ctx);\n    };\n})();\nexport class SettingItem {\n    constructor(key, type, initial) {\n        this.onRender = null;\n        this.key = key;\n        type = this.type = typeof type === 'string' ? SettingItem.types[type] : type;\n        if (!type || !type.serialize || !type.deserialize)\n            throw new Error(\"invalid 'type' arugment\");\n        this.readFromStorage(initial);\n    }\n    readFromStorage(initial) {\n        var str = this.key ? localStorage.getItem(this.key) : null;\n        this.isInitial = !str;\n        this.set(str ? this.type.deserialize(str) : initial, true);\n    }\n    render(fn, dontRaiseNow) {\n        if (!dontRaiseNow)\n            fn(this.data);\n        const oldFn = this.onRender;\n        const newFn = fn;\n        if (oldFn)\n            fn = function (x) { oldFn(x); newFn(x); };\n        this.onRender = fn;\n        return this;\n    }\n    bindToBtn(btn, prefix) {\n        if (this.type !== SettingItem.types.bool)\n            throw new Error('only for bool type');\n        var span = document.createElement('span');\n        btn.insertBefore(span, btn.firstChild);\n        this.render(function (x) {\n            btn.classList.toggle('disabled', !x);\n            prefix = prefix || [\"❌\", \"✅\"];\n            span.textContent = prefix[+x];\n        });\n        var thiz = this;\n        btn.addEventListener('click', function () { thiz.toggle(); });\n        return this;\n    }\n    remove() {\n        localStorage.removeItem(this.key);\n    }\n    save() {\n        this.isInitial = false;\n        localStorage.setItem(this.key, this.type.serialize(this.data));\n    }\n    set(data, dontSave) {\n        this.data = data;\n        this.isInitial = false;\n        this.onRender && this.onRender(data);\n        if (!dontSave && this.key)\n            this.save();\n    }\n    get() {\n        return this.data;\n    }\n    toggle() {\n        if (this.type !== SettingItem.types.bool)\n            throw new Error('only for bool type');\n        this.set((!this.data));\n    }\n    loop(arr) {\n        var curData = this.data;\n        var oldIndex = arr.findIndex(function (x) { return x === curData; });\n        var newData = arr[(oldIndex + 1) % arr.length];\n        this.set(newData);\n    }\n}\nSettingItem.types = {\n    bool: {\n        serialize: function (data) { return data ? 'true' : 'false'; },\n        deserialize: function (str) { return str === 'true' ? true : str === 'false' ? false : undefined; }\n    },\n    str: {\n        serialize: function (x) { return x; },\n        deserialize: function (x) { return x; }\n    },\n    json: {\n        serialize: function (x) { return JSON.stringify(x); },\n        deserialize: function (x) { return JSON.parse(x); }\n    }\n};\nexport class Callbacks {\n    constructor() {\n        this.list = null;\n    }\n    invoke(...args) {\n        var _a;\n        (_a = this.list) === null || _a === void 0 ? void 0 : _a.forEach((x) => x.apply(this, args));\n    }\n    add(callback) {\n        if (!this.list)\n            this.list = [callback];\n        else\n            this.list.push(callback);\n        return callback;\n    }\n    remove(callback) {\n        if (this.list)\n            this.list.remove(callback);\n    }\n}\nexport class Lazy {\n    constructor(func) {\n        this._func = func;\n        this._value = undefined;\n    }\n    get computed() { return !this._func; }\n    get rawValue() { return this._value; }\n    get value() {\n        if (this._func) {\n            this._value = this._func();\n            this._func = undefined;\n        }\n        return this._value;\n    }\n}\nexport class Semaphore {\n    constructor(init) {\n        this.queue = new Array();\n        this.maxCount = 1;\n        this.runningCount = 0;\n        utils.objectApply(this, init);\n    }\n    enter() {\n        if (this.runningCount === this.maxCount) {\n            var resolve;\n            var prom = new Promise((res) => { resolve = res; });\n            this.queue.push(resolve);\n            return prom;\n        }\n        else {\n            this.runningCount++;\n            return Promise.resolve();\n        }\n    }\n    exit() {\n        if (this.runningCount === this.maxCount && this.queue.length) {\n            if (window.queueMicrotask) {\n                window.queueMicrotask(this.queue.shift());\n            }\n            else {\n                setTimeout(this.queue.shift(), 0);\n            }\n        }\n        else {\n            this.runningCount--;\n        }\n    }\n    run(func) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.enter();\n            try {\n                yield func();\n            }\n            finally {\n                this.exit();\n            }\n        });\n    }\n}\n/** Just like CancellationToken[Source] on .NET */\nexport class CancelToken {\n    constructor() {\n        this.cancelled = false;\n        this.onCancelled = new Callbacks();\n    }\n    cancel() {\n        if (this.cancelled)\n            return;\n        this.cancelled = true;\n        this.onCancelled.invoke();\n    }\n    throwIfCancelled() {\n        if (this.cancelled)\n            throw new Error(\"operation cancelled.\");\n    }\n}\nexport class DataUpdatingHelper {\n    update(newData) {\n        const oldData = this.items;\n        var dataDict = {};\n        for (const n of newData) {\n            dataDict[this.dataSelectId(n)] = n;\n        }\n        var itemDict = {};\n        var removed = [];\n        for (const d of oldData) {\n            const id = this.selectId(d);\n            if (dataDict[id] !== undefined) {\n                itemDict[id] = d;\n            }\n            else {\n                removed.push(d);\n            }\n        }\n        for (let i = removed.length - 1; i >= 0; i--)\n            this.removeItem(removed[i]);\n        var pos = 0;\n        for (const n of newData) {\n            const d = itemDict[this.dataSelectId(n)];\n            if (d !== undefined) {\n                this.updateItem(d, n);\n            }\n            else {\n                this.addItem(n, pos);\n            }\n            pos++;\n        }\n    }\n    selectId(obj) { return obj.id; }\n    dataSelectId(obj) { return obj.id; }\n    addItem(obj, pos) { }\n    updateItem(old, data) { }\n    removeItem(obj) { }\n}\nexport class EventRegistrations {\n    constructor() {\n        this.list = [];\n    }\n    add(event, func) {\n        this.list.push({ event, func });\n        event.add(func);\n        return func;\n    }\n    removeAll() {\n        while (this.list.length) {\n            var r = this.list.pop();\n            r.event.remove(r.func);\n        }\n    }\n}\nexport class TextCompositionWatcher {\n    constructor(dom) {\n        this.isCompositing = false;\n        this.dom = dom.getDOM();\n        this.dom.addEventListener('compositionstart', (ev) => {\n            this.isCompositing = true;\n        });\n        this.dom.addEventListener('compositionend', (ev) => {\n            this.isCompositing = false;\n        });\n    }\n}\n","// file: I18n.ts\n/** Internationalization (aka i18n) helper class */\nexport class I18n {\n    constructor() {\n        this.data = {};\n        this.curLang = 'en';\n        this.missing = new Map();\n    }\n    /** Get i18n string for `key`, return `key` when not found. */\n    get(key, arg) {\n        return this.get2(key, arg) || key;\n    }\n    /** Get i18n string for `key`, return `null` when not found. */\n    get2(key, arg, lang) {\n        lang = lang || this.curLang;\n        var langObj = this.data[lang];\n        if (!langObj) {\n            console.log('i18n missing lang: ' + lang);\n            return null;\n        }\n        var r = langObj[key];\n        if (!r) {\n            if (!this.missing.has(key)) {\n                this.missing.set(key, 1);\n                console.log('i18n missing key: ' + key);\n            }\n            return null;\n        }\n        if (arg) {\n            for (const key in arg) {\n                if (arg.hasOwnProperty(key)) {\n                    const val = arg[key];\n                    r = r.replace('{' + key + '}', val);\n                    // Note that it only replaces the first occurrence.\n                }\n            }\n        }\n        return r;\n    }\n    /** Fills data with an 2darray */\n    add2dArray(array) {\n        const langObjs = [];\n        const langs = array[0];\n        for (const lang of langs) {\n            langObjs.push(this.data[lang] = this.data[lang] || {});\n        }\n        for (let i = 1; i < array.length; i++) {\n            const line = array[i];\n            const key = line[0];\n            for (let j = 0; j < line.length; j++) {\n                const val = line[j];\n                langObjs[j][key] = val;\n            }\n        }\n    }\n    renderElements(elements) {\n        console.log('i18n elements rendering');\n        elements.forEach(x => {\n            for (const node of x.childNodes) {\n                if (node.nodeType === Node.TEXT_NODE) {\n                    // console.log('node', node);\n                    var r = this.get2(node.beforeI18n || node.textContent);\n                    if (r) {\n                        node.beforeI18n = node.beforeI18n || node.textContent;\n                        node.textContent = r;\n                    }\n                    else {\n                        if (node.beforeI18n) {\n                            node.textContent = node.beforeI18n;\n                        }\n                        console.log('missing key for node', node);\n                    }\n                }\n            }\n        });\n    }\n    /**\n     * Detect the best available language using\n     * the user language preferences provided by the browser.\n     * @param langs Available languages\n     */\n    static detectLanguage(langs) {\n        var cur = null;\n        var curIdx = -1;\n        var languages = [];\n        // ['en-US'] -> ['en-US', 'en']\n        (navigator.languages || [navigator.language]).forEach(lang => {\n            languages.push(lang);\n            if (lang.indexOf('-') > 0)\n                languages.push(lang.substr(0, lang.indexOf('-')));\n        });\n        langs.forEach((l) => {\n            var idx = languages.indexOf(l);\n            if (!cur || (idx !== -1 && idx < curIdx)) {\n                cur = l;\n                curIdx = idx;\n            }\n        });\n        return cur || langs[0];\n    }\n}\nexport function createStringBuilder(i18n) {\n    var formatCache = new WeakMap();\n    return function (literals, ...placeholders) {\n        if (placeholders.length === 0) {\n            return i18n.get(literals[0]);\n        }\n        // Generate format string from template string if it's not cached:\n        let formatString = formatCache.get(literals);\n        if (formatString === undefined) {\n            formatString = '';\n            for (let i = 0; i < literals.length; i++) {\n                const lit = literals[i];\n                formatString += lit;\n                if (i < placeholders.length) {\n                    formatString += '{' + i + '}';\n                }\n            }\n            formatCache.set(literals, formatString);\n        }\n        var r = i18n.get(formatString);\n        for (var i = 0; i < placeholders.length; i++) {\n            r = r.replace('{' + i + '}', placeholders[i]);\n        }\n        return r;\n    };\n}\nexport var i18n = new I18n();\nexport const I = createStringBuilder(i18n);\n","// file: viewlib.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { utils, Callbacks, Timer, BuildDOMCtx } from \"./utils\";\nimport { I, i18n } from \"./I18n\";\nexport class View {\n    constructor(dom) {\n        this.parentView = undefined;\n        this._position = undefined;\n        this.domctx = new BuildDOMCtx();\n        this._dom = undefined;\n        this._onactive = undefined;\n        this._onActiveCbs = undefined;\n        if (dom)\n            this.domExprCreated(dom);\n    }\n    static getView(obj) { return obj instanceof View ? obj : new View(obj); }\n    get position() { return this._position; }\n    get domCreated() { return !!this._dom; }\n    get dom() {\n        this.ensureDom();\n        return this._dom;\n    }\n    get hidden() { return this.dom.hidden; }\n    set hidden(val) { this.dom.hidden = val; }\n    ensureDom() {\n        if (!this._dom) {\n            var r = this.createDom();\n            this.domExprCreated(r);\n        }\n    }\n    domExprCreated(r) {\n        this._dom = utils.buildDOM(r, this.domctx);\n        this.postCreateDom();\n        this.updateDom();\n    }\n    createDom() {\n        return document.createElement('div');\n    }\n    /** Will be called when the dom is created */\n    postCreateDom() {\n    }\n    /** Will be called when the dom is created, after postCreateDom() */\n    updateDom() {\n        this.domctx.update();\n    }\n    /** Assign key-values and call `updateDom()` */\n    updateWith(kv) {\n        utils.objectApply(this, kv);\n        this.updateDom();\n    }\n    toggleClass(clsName, force) {\n        utils.toggleClass(this.dom, clsName, force);\n    }\n    appendView(view) { return this.dom.appendView(view); }\n    getDOM() { return this.dom; }\n    get onactive() { return this._onactive; }\n    set onactive(val) {\n        if (!!this._onactive !== !!val) {\n            if (val) {\n                this._onActiveCbs = [\n                    (e) => {\n                        this._onactive();\n                    },\n                    (e) => {\n                        this.handleKeyDown(e, this._onactive);\n                    }\n                ];\n                this.dom.addEventListener('click', this._onActiveCbs[0]);\n                this.dom.addEventListener('keydown', this._onActiveCbs[1]);\n            }\n            else {\n                this.dom.removeEventListener('click', this._onActiveCbs[0]);\n                this.dom.removeEventListener('keydown', this._onActiveCbs[1]);\n                this._onActiveCbs = undefined;\n            }\n        }\n        this._onactive = val;\n    }\n    handleKeyDown(e, onactive) {\n        if (e.code === 'Enter') {\n            onactive();\n            e.preventDefault();\n        }\n    }\n}\nHTMLElement.prototype.getDOM = function () { return this; };\nNode.prototype.appendView = function (view) {\n    this.appendChild(view.dom);\n};\nexport class ContainerView extends View {\n    constructor() {\n        super(...arguments);\n        this.items = [];\n    }\n    appendView(view) {\n        this.addView(view);\n    }\n    addView(view, pos) {\n        var _a;\n        const items = this.items;\n        if (view.parentView)\n            throw new Error('the view is already in a container view');\n        view.parentView = this;\n        if (pos === undefined) {\n            view._position = items.length;\n            items.push(view);\n            this.dom.appendChild(view.dom);\n        }\n        else {\n            items.splice(pos, 0, view);\n            this.dom.insertBefore(view.dom, ((_a = items[pos + 1]) === null || _a === void 0 ? void 0 : _a.dom) || null);\n            for (let i = pos; i < items.length; i++) {\n                items[i]._position = i;\n            }\n        }\n    }\n    removeView(view) {\n        view = this._ensureItem(view);\n        view.dom.remove();\n        var pos = view._position;\n        view.parentView = view._position = undefined;\n        this.items.splice(pos, 1);\n        for (let i = pos; i < this.items.length; i++) {\n            this.items[i]._position = i;\n        }\n    }\n    removeAllView() {\n        while (this.length)\n            this.removeView(this.length - 1);\n    }\n    updateChildrenDom() {\n        for (const item of this.items) {\n            item.updateDom();\n        }\n    }\n    _ensureItem(item) {\n        if (typeof item === 'number')\n            item = this.items[item];\n        else if (!item)\n            throw new Error('item is null or undefined.');\n        else if (item.parentView !== this)\n            throw new Error('the item is not in this listview.');\n        return item;\n    }\n    [Symbol.iterator]() { return this.items[Symbol.iterator](); }\n    get length() { return this.items.length; }\n    get(idx) {\n        return this.items[idx];\n    }\n    map(func) { return utils.arrayMap(this, func); }\n    find(func) { return utils.arrayFind(this, func); }\n    forEach(func) { return utils.arrayForeach(this, func); }\n}\n/** DragManager is used to help exchange information between views */\nexport var dragManager = new class DragManager {\n    constructor() {\n        /** The item being dragged */\n        this._currentItem = null;\n        this._currentArray = null;\n        this.onDragStart = new Callbacks();\n        this.onDragEnd = new Callbacks();\n    }\n    get currentItem() { var _a, _b, _c; return (_c = (_a = this._currentItem) !== null && _a !== void 0 ? _a : (_b = this._currentArray) === null || _b === void 0 ? void 0 : _b[0]) !== null && _c !== void 0 ? _c : null; }\n    ;\n    get currentArray() {\n        if (this._currentItem)\n            return [this._currentItem];\n        return this._currentArray;\n    }\n    start(item) {\n        this._currentItem = item;\n        console.log('drag start', item);\n        this.onDragStart.invoke();\n    }\n    startArray(arr) {\n        this._currentArray = arr;\n        console.log('drag start array', arr);\n        this.onDragStart.invoke();\n    }\n    end() {\n        this._currentItem = null;\n        this._currentArray = null;\n        console.log('drag end');\n        this.onDragEnd.invoke();\n    }\n};\nexport class ListViewItem extends View {\n    constructor() {\n        super(...arguments);\n        this.dragging = undefined;\n        this._selected = false;\n        this.onSelectedChanged = new Callbacks();\n        // https://stackoverflow.com/questions/7110353\n        this.enterctr = 0;\n        this.dragoverPlaceholder = null;\n    }\n    get listview() { return this.parentView; }\n    get selectionHelper() { return this.listview.selectionHelper; }\n    get dragData() { return this.dom.textContent; }\n    get selected() { return this._selected; }\n    set selected(v) {\n        this._selected = v;\n        this.domCreated && this.updateDom();\n        this.onSelectedChanged.invoke();\n    }\n    remove() {\n        if (!this.listview)\n            return;\n        this.listview.remove(this);\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.dom.setAttribute('role', 'listitem');\n        this.dom.addEventListener('click', (ev) => {\n            var _a, _b, _c;\n            if ((_a = this.listview) === null || _a === void 0 ? void 0 : _a.selectionHelper.handleItemClicked(this, ev))\n                return;\n            (_c = (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onItemClicked) === null || _c === void 0 ? void 0 : _c.call(_b, this);\n        });\n        this.dom.addEventListener('keydown', (ev) => {\n            var _a, _b, _c, _d, _e, _f;\n            if (ev.code === 'Enter') {\n                if (ev.altKey) {\n                    const rect = this.dom.getBoundingClientRect();\n                    const mouseev = new MouseEvent('contextmenu', {\n                        clientX: rect.left, clientY: rect.top,\n                        relatedTarget: this.dom\n                    });\n                    (_c = ((_a = this.onContextMenu) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onContextMenu)) === null || _c === void 0 ? void 0 : _c(this, mouseev);\n                }\n                else {\n                    if ((_d = this.listview) === null || _d === void 0 ? void 0 : _d.selectionHelper.handleItemClicked(this, ev))\n                        return;\n                    (_f = (_e = this.listview) === null || _e === void 0 ? void 0 : _e.onItemClicked) === null || _f === void 0 ? void 0 : _f.call(_e, this);\n                }\n                ev.preventDefault();\n            }\n            else if (this.listview && (ev.code === 'ArrowUp' || ev.code === 'ArrowDown')) {\n                var offset = ev.code === 'ArrowUp' ? -1 : 1;\n                var item = this.listview.get(this.position + offset);\n                if (item) {\n                    item.dom.focus();\n                    ev.preventDefault();\n                }\n            }\n        });\n        this.dom.addEventListener('contextmenu', (ev) => {\n            var _a, _b, _c;\n            (_c = ((_a = this.onContextMenu) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onContextMenu)) === null || _c === void 0 ? void 0 : _c(this, ev);\n        });\n        this.dom.addEventListener('dragstart', (ev) => {\n            var _a, _b;\n            if (!((_a = this.dragging) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.dragging)) {\n                ev.preventDefault();\n                return;\n            }\n            var arr = [];\n            if (this.selected) {\n                arr = [...this.selectionHelper.selectedItems];\n                arr.sort((a, b) => a.position - b.position); // remove this line to get a new feature!\n            }\n            else {\n                arr = [this];\n            }\n            dragManager.startArray(arr);\n            ev.dataTransfer.setData('text/plain', arr.map(x => x.dragData).join('\\r\\n'));\n            arr.forEach(x => x.dom.style.opacity = '.5');\n        });\n        this.dom.addEventListener('dragend', (ev) => {\n            var arr = dragManager.currentArray;\n            dragManager.end();\n            ev.preventDefault();\n            arr.forEach(x => x.dom.style.opacity = '');\n        });\n        this.dom.addEventListener('dragover', (ev) => {\n            this.dragHandler(ev, 'dragover');\n        });\n        this.dom.addEventListener('dragenter', (ev) => {\n            this.dragHandler(ev, 'dragenter');\n        });\n        this.dom.addEventListener('dragleave', (ev) => {\n            this.dragHandler(ev, 'dragleave');\n        });\n        this.dom.addEventListener('drop', (ev) => {\n            this.dragHandler(ev, 'drop');\n        });\n    }\n    dragHandler(ev, type) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        const item = dragManager.currentItem;\n        let items = dragManager.currentArray;\n        const drop = type === 'drop';\n        const arg = {\n            source: item, target: this,\n            sourceItems: items,\n            event: ev, drop: drop,\n            accept: false\n        };\n        if (item instanceof ListViewItem) {\n            if (((_a = this.listview) === null || _a === void 0 ? void 0 : _a.moveByDragging) && item.listview === this.listview) {\n                ev.preventDefault();\n                const selfInside = (items.indexOf(this) >= 0);\n                const after = ev.clientY - this.dom.getBoundingClientRect().top > this.dom.offsetHeight / 2;\n                if (!(selfInside && drop))\n                    arg.accept = after ? 'move-after' : 'move';\n                if (!drop) {\n                    ev.dataTransfer.dropEffect = 'move';\n                }\n                else {\n                    if (items.indexOf(this) === -1) {\n                        let newpos = this.position;\n                        if (after)\n                            newpos++;\n                        for (const it of items) {\n                            if (it !== this) {\n                                if (newpos > it.position)\n                                    newpos--;\n                                this.listview.move(it, newpos);\n                                newpos++;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        const onDragover = (_b = this.onDragover) !== null && _b !== void 0 ? _b : (_c = this.listview) === null || _c === void 0 ? void 0 : _c.onDragover;\n        if (!arg.accept && onDragover) {\n            onDragover(arg);\n            if (drop || arg.accept)\n                ev.preventDefault();\n        }\n        const onContextMenu = (_d = this.onContextMenu) !== null && _d !== void 0 ? _d : (_e = this.listview) === null || _e === void 0 ? void 0 : _e.onContextMenu;\n        if (!arg.accept && item === this && onContextMenu) {\n            if (drop)\n                onContextMenu(this, ev);\n            else\n                ev.preventDefault();\n        }\n        if (type === 'dragenter' || type == 'dragover' || type === 'dragleave' || drop) {\n            if (type === 'dragenter') {\n                this.enterctr++;\n            }\n            else if (type === 'dragleave') {\n                this.enterctr--;\n            }\n            else if (type === 'drop') {\n                this.enterctr = 0;\n            }\n            let hover = this.enterctr > 0;\n            this.toggleClass('dragover', hover);\n            let placeholder = hover && (arg.accept === 'move' || arg.accept === 'move-after') && arg.accept;\n            if (placeholder != ((_g = (_f = this.dragoverPlaceholder) === null || _f === void 0 ? void 0 : _f[1]) !== null && _g !== void 0 ? _g : false)) {\n                (_h = this.dragoverPlaceholder) === null || _h === void 0 ? void 0 : _h[0].remove();\n                this.dragoverPlaceholder = null;\n                if (placeholder) {\n                    this.dragoverPlaceholder = [\n                        utils.buildDOM({ tag: 'div.dragover-placeholder' }),\n                        placeholder\n                    ];\n                    var before = this.dom;\n                    if (arg.accept === 'move-after')\n                        before = before.nextElementSibling;\n                    this.dom.parentElement.insertBefore(this.dragoverPlaceholder[0], before);\n                }\n            }\n        }\n    }\n    ;\n}\nexport class ListView extends ContainerView {\n    constructor(container) {\n        super(container);\n        // private items: Array<T> = [];\n        this.onItemClicked = null;\n        /**\n         * Allow user to drag an item.\n         */\n        this.dragging = false;\n        /**\n         * Allow user to drag an item and change its position.\n         */\n        this.moveByDragging = false;\n        this.selectionHelper = new SelectionHelper();\n        this.onItemMoved = null;\n        /**\n         * When dragover or drop\n         */\n        this.onDragover = null;\n        this.onContextMenu = null;\n        this.selectionHelper.itemProvider = this.get.bind(this);\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.dom.setAttribute('role', 'list');\n    }\n    add(item, pos) {\n        this.addView(item, pos);\n        if (this.dragging)\n            item.dom.draggable = true;\n    }\n    remove(item, keepSelected) {\n        item = this._ensureItem(item);\n        if (!keepSelected && item.selected)\n            this.selectionHelper.toggleItemSelection(item);\n        this.removeView(item);\n    }\n    move(item, newpos) {\n        var _a;\n        item = this._ensureItem(item);\n        this.remove(item, true);\n        this.add(item, newpos);\n        (_a = this.onItemMoved) === null || _a === void 0 ? void 0 : _a.call(this, item, item.position);\n    }\n    /** Remove all items */\n    removeAll() {\n        while (this.length)\n            this.remove(this.length - 1);\n    }\n    /** Remove all items and all DOM children */\n    clear() {\n        this.removeAll();\n        utils.clearChildren(this.dom);\n    }\n    ReplaceChild(dom) {\n        this.clear();\n        this.dom.appendChild(dom.getDOM());\n    }\n}\nexport class SelectionHelper {\n    constructor() {\n        this._enabled = false;\n        this.onEnabledChanged = new Callbacks();\n        this.itemProvider = null;\n        this.ctrlForceSelect = false;\n        this.selectedItems = [];\n        this.onSelectedItemsChanged = new Callbacks();\n        /** For shift-click */\n        this.lastToggledItem = null;\n    }\n    get enabled() { return this._enabled; }\n    set enabled(val) {\n        if (!!val === !!this._enabled)\n            return;\n        this._enabled = val;\n        while (this.selectedItems.length)\n            this.toggleItemSelection(this.selectedItems[0], false);\n        this.lastToggledItem = null;\n        this.onEnabledChanged.invoke();\n    }\n    get count() { return this.selectedItems.length; }\n    /** Returns true if it's handled by the helper. */\n    handleItemClicked(item, ev) {\n        if (!this.enabled) {\n            if (!this.ctrlForceSelect || !ev.ctrlKey)\n                return false;\n            this.enabled = true;\n        }\n        if (ev.shiftKey && this.lastToggledItem && this.itemProvider) {\n            var toSelect = !!this.lastToggledItem.selected;\n            var start = item.position, end = this.lastToggledItem.position;\n            if (start > end)\n                [start, end] = [end, start];\n            for (let i = start; i <= end; i++) {\n                this.toggleItemSelection(this.itemProvider(i), toSelect);\n            }\n            this.lastToggledItem = item;\n        }\n        else {\n            this.toggleItemSelection(item);\n        }\n        return true;\n    }\n    toggleItemSelection(item, force) {\n        if (force !== undefined && force === !!item.selected)\n            return;\n        if (item.selected) {\n            item.selected = false;\n            this.selectedItems.remove(item);\n            this.onSelectedItemsChanged.invoke('remove', item);\n        }\n        else {\n            item.selected = true;\n            this.selectedItems.push(item);\n            this.onSelectedItemsChanged.invoke('add', item);\n        }\n        this.lastToggledItem = item;\n        if (this.count === 0 && this.ctrlForceSelect)\n            this.enabled = false;\n    }\n}\nexport class ItemActiveHelper {\n    constructor(init) {\n        this.funcSetActive = (item, val) => item.toggleClass('active', val);\n        this.current = null;\n        utils.objectApply(this, init);\n    }\n    set(item) {\n        if (this.current === item)\n            return;\n        if (this.current)\n            this.funcSetActive(this.current, false);\n        this.current = item;\n        if (this.current)\n            this.funcSetActive(this.current, true);\n    }\n}\nexport class Section extends View {\n    constructor(arg) {\n        super();\n        this.titleView = new TextView({ tag: 'span.section-title' });\n        this.headerView = new View({\n            tag: 'div.section-header',\n            child: [\n                this.titleView\n            ]\n        });\n        this.ensureDom();\n        if (arg) {\n            if (arg.title)\n                this.setTitle(arg.title);\n            if (arg.content)\n                this.setContent(arg.content);\n            if (arg.actions)\n                arg.actions.forEach(x => this.addAction(x));\n        }\n    }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.section',\n            child: [\n                this.headerView\n            ]\n        };\n    }\n    setTitle(text) {\n        this.titleView.text = text;\n    }\n    setContent(view) {\n        var dom = this.dom;\n        var firstChild = dom.firstChild;\n        while (dom.lastChild !== firstChild)\n            dom.removeChild(dom.lastChild);\n        dom.appendChild(view.getDOM());\n    }\n    addAction(arg) {\n        var view = new View({\n            tag: 'div.section-action.clickable',\n            text: arg.text,\n            tabIndex: 0\n        });\n        view.onactive = arg.onclick;\n        this.headerView.dom.appendChild(view.dom);\n    }\n}\nexport class LoadingIndicator extends View {\n    constructor(init) {\n        super();\n        this._status = 'running';\n        this.onclick = null;\n        if (init)\n            utils.objectApply(this, init);\n    }\n    get state() { return this._status; }\n    set state(val) {\n        this._status = val;\n        ['running', 'error', 'normal'].forEach(x => this.toggleClass(x, val === x));\n    }\n    get content() { return this._text; }\n    set content(val) { this._text = val; this.ensureDom(); this._textdom.textContent = val; }\n    reset() {\n        this.state = 'running';\n        this.content = I `Loading`;\n        this.onclick = null;\n    }\n    error(err, retry) {\n        this.state = 'error';\n        this.content = I `Oh no! Something just goes wrong:` + '\\r\\n' + err;\n        if (retry) {\n            this.content += '\\r\\n' + I `[Click here to retry]`;\n        }\n        this.onclick = retry;\n    }\n    action(func) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield func();\n            }\n            catch (error) {\n                this.error(error, () => this.action(func));\n            }\n        });\n    }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.loading-indicator',\n            child: [{\n                    tag: 'div.loading-indicator-inner',\n                    child: [{ tag: 'div.loading-indicator-text', _key: '_textdom' }]\n                }],\n            onclick: (e) => this.onclick && this.onclick(e)\n        };\n    }\n    postCreateDom() {\n        this.reset();\n    }\n}\nexport class Overlay extends View {\n    createDom() {\n        return { tag: 'div.overlay' };\n    }\n    setCenterChild(centerChild) {\n        this.toggleClass('centerchild', centerChild);\n        return this;\n    }\n    setNoBg(nobg) {\n        this.toggleClass('nobg', nobg);\n        return this;\n    }\n}\nexport class EditableHelper {\n    constructor(element) {\n        this.editing = false;\n        this.beforeEdit = null;\n        this.onComplete = null;\n        this.element = element;\n    }\n    startEdit(onComplete) {\n        if (this.editing)\n            return;\n        this.editing = true;\n        var ele = this.element;\n        var beforeEdit = this.beforeEdit = ele.textContent;\n        utils.toggleClass(ele, 'editing', true);\n        var input = utils.buildDOM({\n            tag: 'input', type: 'text', value: beforeEdit\n        });\n        while (ele.firstChild)\n            ele.removeChild(ele.firstChild);\n        ele.appendChild(input);\n        input.select();\n        input.focus();\n        var stopEdit = () => {\n            var _a;\n            this.editing = false;\n            utils.toggleClass(ele, 'editing', false);\n            events.forEach(x => x.remove());\n            input.remove();\n            (_a = this.onComplete) === null || _a === void 0 ? void 0 : _a.call(this, input.value);\n            onComplete === null || onComplete === void 0 ? void 0 : onComplete(input.value);\n        };\n        var events = [\n            utils.addEvent(input, 'keydown', (evv) => {\n                if (evv.code === 'Enter') {\n                    stopEdit();\n                    evv.preventDefault();\n                }\n            }),\n            utils.addEvent(input, 'focusout', (evv) => { stopEdit(); }),\n        ];\n    }\n    startEditAsync() {\n        return new Promise((resolve) => this.startEdit(resolve));\n    }\n}\nexport class MenuItem extends ListViewItem {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.cls = 'normal';\n        this.onclick = null;\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'div.item.no-selection',\n            tabIndex: 0\n        };\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.onactive = () => {\n            var _a;\n            if (this.parentView instanceof ContextMenu) {\n                if (!this.parentView.keepOpen)\n                    this.parentView.close();\n            }\n            (_a = this.onclick) === null || _a === void 0 ? void 0 : _a.call(this);\n        };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n        if (this.cls !== this._lastcls) {\n            if (this._lastcls)\n                this.dom.classList.remove(this._lastcls);\n            if (this.cls)\n                this.dom.classList.add(this.cls);\n        }\n    }\n}\nexport class MenuLinkItem extends MenuItem {\n    constructor(init) {\n        super(init);\n        this.link = '';\n        this.download = '';\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        var dom = super.createDom();\n        dom.tag = 'a.item.no-selection';\n        dom.target = \"_blank\";\n        return dom;\n    }\n    updateDom() {\n        super.updateDom();\n        this.dom.href = this.link;\n        this.dom.download = this.download;\n    }\n}\nexport class MenuInfoItem extends MenuItem {\n    constructor(init) {\n        super(init);\n        this.text = '';\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'div.menu-info'\n        };\n    }\n    updateDom() {\n        super.updateDom();\n        this.dom.textContent = this.text;\n    }\n}\nexport class ContextMenu extends ListView {\n    constructor(items) {\n        super({ tag: 'div.context-menu', tabIndex: 0 });\n        this.keepOpen = false;\n        this.useOverlay = true;\n        this._visible = false;\n        this.overlay = null;\n        this.onClose = new Callbacks();\n        this._originalFocused = null;\n        items === null || items === void 0 ? void 0 : items.forEach(x => this.add(x));\n    }\n    get visible() { return this._visible; }\n    ;\n    postCreateDom() {\n        super.postCreateDom();\n        this.dom.addEventListener('focusout', (e) => {\n            !this.dom.contains(e.relatedTarget) && this.close();\n        });\n        this.dom.addEventListener('keydown', (e) => {\n            if (e.code === 'Escape') {\n                e.preventDefault();\n                this.close();\n            }\n        });\n    }\n    show(arg) {\n        if (this._visible) {\n            console.warn(\"[ContextMenu] show() called when it's already visible.\");\n            return;\n        }\n        if ('ev' in arg)\n            arg = {\n                x: arg.ev.pageX,\n                y: arg.ev.pageY\n            };\n        this._visible = true;\n        if (this.useOverlay) {\n            if (!this.overlay) {\n                this.overlay = new Overlay();\n                this.overlay.dom.style.background = 'rgba(0, 0, 0, .1)';\n                this.overlay.dom.addEventListener('mousedown', (ev) => {\n                    if (ev.eventPhase !== Event.AT_TARGET)\n                        return;\n                    ev.preventDefault();\n                    this.close();\n                });\n            }\n            this.overlay.appendView(this);\n            document.body.appendChild(this.overlay.dom);\n        }\n        else {\n            document.body.appendChild(this.dom);\n        }\n        this._originalFocused = document.activeElement;\n        this.dom.focus();\n        var width = this.dom.offsetWidth, height = this.dom.offsetHeight;\n        if (arg.x + width > document.body.offsetWidth)\n            arg.x -= width;\n        if (arg.y + height > document.body.offsetHeight)\n            arg.y -= height;\n        if (arg.x < 0)\n            arg.x = 0;\n        if (arg.y < 0)\n            arg.y = 0;\n        this.dom.style.left = arg.x + 'px';\n        this.dom.style.top = arg.y + 'px';\n    }\n    close() {\n        var _a, _b;\n        if (this._visible) {\n            this._visible = false;\n            this.onClose.invoke();\n            (_b = (_a = this._originalFocused) === null || _a === void 0 ? void 0 : _a['focus']) === null || _b === void 0 ? void 0 : _b.call(_a);\n            this._originalFocused = null;\n            if (this.overlay)\n                utils.fadeout(this.overlay.dom);\n            utils.fadeout(this.dom);\n        }\n    }\n}\nexport class Dialog extends View {\n    constructor() {\n        super();\n        this.content = new ContainerView({ tag: 'div.dialog-content' });\n        this.shown = false;\n        this.btnTitle = new TabBtn({ active: true, clickable: false });\n        this.btnClose = new TabBtn({ text: I `Close`, right: true });\n        this.title = 'Dialog';\n        this.allowClose = true;\n        this.showCloseButton = true;\n        this.onShown = new Callbacks();\n        this.onClose = new Callbacks();\n        this.focusTrap = new View({ tag: 'div.focustrap', tabIndex: 0 });\n        this.btnClose.onClick.add(() => this.allowClose && this.close());\n    }\n    get width() { return this.dom.style.width; }\n    set width(val) { this.dom.style.width = val; }\n    get contentFlex() { return this.content.dom.classList.contains('flex'); }\n    set contentFlex(val) { this.content.toggleClass('flex', !!val); }\n    get resizable() { return this.dom.classList.contains('resize'); }\n    set resizable(val) { this.toggleClass('resize', !!val); }\n    createDom() {\n        return {\n            _ctx: this,\n            _key: 'dialog',\n            tag: 'div.dialog',\n            tabIndex: 0,\n            style: 'width: 300px',\n            child: [\n                {\n                    _key: 'domheader',\n                    tag: 'div.dialog-title',\n                    child: [\n                        { tag: 'div', style: 'clear: both;' }\n                    ]\n                },\n                this.content,\n                this.focusTrap\n            ]\n        };\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.addBtn(this.btnTitle);\n        this.addBtn(this.btnClose);\n        this.overlay = new Overlay().setCenterChild(true).setNoBg(true);\n        this.overlay.dom.appendView(this);\n        this.overlay.dom.addEventListener('mousedown', (ev) => {\n            if (this.allowClose && ev.button === 0 && ev.target === this.overlay.dom) {\n                ev.preventDefault();\n                this.close();\n            }\n        });\n        this.overlay.dom.addEventListener('keydown', (ev) => {\n            if (this.allowClose && ev.keyCode === 27) { // ESC\n                ev.preventDefault();\n                this.close();\n            }\n            else if (ev.target === this.dom && ev.code === 'Tab' && ev.shiftKey) {\n                ev.preventDefault();\n                let tabables = this.dom.querySelectorAll('a, [tabindex]');\n                if (tabables.length >= 2 && tabables[tabables.length - 2]['focus']) {\n                    // the last tabable is `focusTrap`, so the index used here is `length - 2`\n                    tabables[tabables.length - 2]['focus']();\n                }\n            }\n        });\n        // title bar pointer event handler:\n        {\n            let offset;\n            utils.listenPointerEvents(this.domheader, (e) => {\n                if (e.action === 'down') {\n                    if (e.ev.target !== this.domheader && e.ev.target !== this.btnTitle.dom)\n                        return;\n                    e.ev.preventDefault();\n                    const rectOverlay = this.overlay.dom.getBoundingClientRect();\n                    const rect = this.dom.getBoundingClientRect();\n                    offset = {\n                        x: e.point.pageX - rectOverlay.x - rect.x,\n                        y: e.point.pageY - rectOverlay.y - rect.y\n                    };\n                    return 'track';\n                }\n                else if (e.action === 'move') {\n                    e.ev.preventDefault();\n                    const rect = this.overlay.dom.getBoundingClientRect();\n                    const pageX = utils.numLimit(e.point.pageX, rect.left, rect.right);\n                    const pageY = utils.numLimit(e.point.pageY, rect.top, rect.bottom);\n                    this.setOffset(pageX - offset.x, pageY - offset.y);\n                }\n            });\n        }\n        this.dom.addEventListener('resize', () => {\n            if (this.dom.style.width)\n                this.width = this.dom.style.width;\n        });\n        this.focusTrap.dom.addEventListener('focus', (ev) => {\n            this.dom.focus();\n        });\n    }\n    updateDom() {\n        this.btnTitle.updateWith({ text: this.title });\n        this.btnTitle.hidden = !this.title;\n        this.btnClose.hidden = !(this.allowClose && this.showCloseButton);\n    }\n    addBtn(btn) {\n        this.ensureDom();\n        this.domheader.insertBefore(btn.dom, this.domheader.lastChild);\n    }\n    addContent(view, replace) {\n        this.ensureDom();\n        if (replace)\n            this.content.removeAllView();\n        this.content.appendView(View.getView(view));\n    }\n    setOffset(x, y) {\n        this.dom.style.left = x ? x + 'px' : '';\n        this.dom.style.top = y ? y + 'px' : '';\n        this.overlay.setCenterChild(false);\n    }\n    getOffset() {\n        var x = this.dom.style.left ? parseFloat(this.dom.style.left) : 0;\n        var y = this.dom.style.top ? parseFloat(this.dom.style.top) : 0;\n        return { x, y };\n    }\n    center() {\n        this.setOffset(0, 0);\n        this.overlay.setCenterChild(true);\n    }\n    show() {\n        var _a;\n        if (this.shown)\n            return;\n        this.shown = true;\n        (_a = this._cancelFadeout) === null || _a === void 0 ? void 0 : _a.call(this);\n        this.ensureDom();\n        Dialog.defaultParent.onDialogShowing(this);\n        this.dom.focus();\n        (this.autoFocus || this).dom.focus();\n        this.onShown.invoke();\n    }\n    close() {\n        if (!this.shown)\n            return;\n        this.shown = false;\n        this.onClose.invoke();\n        this._cancelFadeout = utils.fadeout(this.overlay.dom).cancel;\n        Dialog.defaultParent.onDialogClosing(this);\n    }\n    waitClose() {\n        return new Promise((resolve) => {\n            var cb = this.onClose.add(() => {\n                this.onClose.remove(cb);\n                resolve();\n            });\n        });\n    }\n}\nexport class DialogParent extends View {\n    constructor(dom) {\n        super(dom !== null && dom !== void 0 ? dom : document.body);\n        this.bgOverlay = new Overlay();\n        this.dialogCount = 0;\n        this._cancelFadeout = null;\n    }\n    onDialogShowing(dialog) {\n        var _a;\n        if (this.dialogCount++ === 0) {\n            (_a = this._cancelFadeout) === null || _a === void 0 ? void 0 : _a.call(this);\n            this.appendView(this.bgOverlay);\n        }\n        this.appendView(dialog.overlay);\n    }\n    onDialogClosing(dialog) {\n        if (--this.dialogCount === 0) {\n            this._cancelFadeout = utils.fadeout(this.bgOverlay.dom).cancel;\n        }\n    }\n}\nexport class TabBtn extends View {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.clickable = true;\n        this.active = false;\n        this.right = false;\n        this.onclick = null;\n        this.onClick = new Callbacks();\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'span.tab.no-selection'\n        };\n    }\n    postCreateDom() {\n        this.onactive = () => {\n            var _a;\n            (_a = this.onclick) === null || _a === void 0 ? void 0 : _a.call(this);\n            this.onClick.invoke();\n        };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n        this.dom.tabIndex = this.clickable ? 0 : -1;\n        this.toggleClass('clickable', this.clickable);\n        this.toggleClass('active', this.active);\n        this.dom.style.float = this.right ? 'right' : 'left';\n    }\n}\nexport class InputView extends View {\n    constructor(init) {\n        super();\n        this.multiline = false;\n        this.type = 'text';\n        this.placeholder = '';\n        utils.objectApply(this, init);\n    }\n    get value() { return this.dom.value; }\n    set value(val) { this.dom.value = val; }\n    createDom() {\n        return this.multiline ? { tag: 'textarea.input-text' } : { tag: 'input.input-text' };\n    }\n    updateDom() {\n        super.updateDom();\n        if (this.dom instanceof HTMLInputElement) {\n            this.dom.type = this.type;\n            this.dom.placeholder = this.placeholder;\n        }\n    }\n}\nexport class TextView extends View {\n    get text() { return this.dom.textContent; }\n    set text(val) { this.dom.textContent = val; }\n}\nexport class ButtonView extends TextView {\n    constructor(init) {\n        super();\n        this.disabled = false;\n        this.type = 'normal';\n        utils.objectApply(this, init);\n        this.updateDom();\n    }\n    get onclick() { return this.onactive; }\n    set onclick(val) { this.onactive = val; }\n    createDom() {\n        return { tag: 'div.btn', tabIndex: 0 };\n    }\n    updateDom() {\n        super.updateDom();\n        this.toggleClass('disabled', this.disabled);\n        this.toggleClass('btn-big', this.type === 'big');\n    }\n}\nexport class LabeledInput extends View {\n    constructor(init) {\n        super();\n        this.label = '';\n        this.type = 'text';\n        this.input = new InputView();\n        utils.objectApply(this, init);\n    }\n    get dominput() { return this.input.dom; }\n    get value() { return this.dominput.value; }\n    set value(val) { this.dominput.value = val; }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.labeled-input',\n            child: [\n                { tag: 'div.input-label', text: () => this.label },\n                this.input\n            ]\n        };\n    }\n    updateDom() {\n        super.updateDom();\n        this.input.type = this.type;\n        this.input.domCreated && this.input.updateDom();\n    }\n}\nexport class ToastsContainer extends View {\n    constructor() {\n        super(...arguments);\n        this.parentDom = null;\n        this.toasts = [];\n    }\n    createDom() {\n        return { tag: 'div.toasts-container' };\n    }\n    addToast(toast) {\n        if (this.toasts.length === 0)\n            this.show();\n        this.toasts.push(toast);\n    }\n    removeToast(toast) {\n        this.toasts.remove(toast);\n        if (this.toasts.length === 0)\n            this.remove();\n    }\n    show() {\n        var parent = this.parentDom || document.body;\n        parent.appendChild(this.dom);\n    }\n    remove() {\n        this.dom.remove();\n    }\n}\nToastsContainer.default = new ToastsContainer();\nexport class Toast extends View {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.shown = false;\n        this.timer = new Timer(() => this.close());\n        utils.objectApply(this, init);\n        if (!this.container)\n            this.container = ToastsContainer.default;\n    }\n    show(timeout) {\n        if (!this.shown) {\n            this.container.addToast(this);\n            this.container.appendView(this);\n            this.shown = true;\n        }\n        if (timeout)\n            this.timer.timeout(timeout);\n        else\n            this.timer.tryCancel();\n    }\n    close() {\n        if (!this.shown)\n            return;\n        this.shown = false;\n        utils.fadeout(this.dom)\n            .onFinished(() => this.container.removeToast(this));\n    }\n    createDom() {\n        return { tag: 'div.toast' };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n    }\n    static show(text, timeout) {\n        var toast = new Toast({ text });\n        toast.show(timeout);\n        return toast;\n    }\n}\nexport class MessageBox extends Dialog {\n    constructor() {\n        super(...arguments);\n        this.allowClose = false;\n        this.title = 'Message';\n        this.result = 'none';\n    }\n    addResultBtns(results) {\n        for (const r of results) {\n            this.addBtnWithResult(new TabBtn({ text: i18n.get('msgbox_' + r), right: true }), r);\n        }\n        return this;\n    }\n    setTitle(title) {\n        this.title = title;\n        if (this.domCreated)\n            this.updateDom();\n        return this;\n    }\n    addText(text) {\n        this.addContent(new TextView({ tag: 'div.messagebox-text', textContent: text }));\n        return this;\n    }\n    allowCloseWithResult(result, showCloseButton) {\n        this.result = result;\n        this.allowClose = true;\n        this.showCloseButton = !!showCloseButton;\n        if (this.domCreated)\n            this.updateDom();\n        return this;\n    }\n    addBtnWithResult(btn, result) {\n        btn.onClick.add(() => { this.result = result; this.close(); });\n        this.addBtn(btn);\n        return this;\n    }\n    showAndWaitResult() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.show();\n            yield this.waitClose();\n            return this.result;\n        });\n    }\n}\n"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","_object_assign","Object","assign","_object_hasOwnProperty","prototype","hasOwnProperty","utils","[object Object]","fileSizeUnits","str","len","ch","length","sec","isNaN","Math","round","min","floor","strPadLeft","toString","size","unit","toFixed","date","now","Date","getFullYear","getMonth","getDate","toLocaleTimeString","toLocaleString","num","max","nameFunc","existsFunc","btoa","encodeURIComponent","replace","match","p1","String","fromCharCode","time","setTimeout","node","lastChild","removeChild","newChild","clearChildren","appendChild","element","clsName","force","clsList","classList","toggle","undefined","contains","add","remove","cb","end","removeEventListener","onTransitionend","eventPhase","Event","AT_TARGET","addEventListener","finished","callback","type","ev","point","action","mousemove","mouseup","document","touchDown","ct","changedTouches","ret","touch","touchmove","touchend","touches","event","handler","array","val","i","splice","pos","push","arr","func","Array","map","idx","item","find","sum","arrayForeach","x","obj","kv","keys","key","call","indexOf","a","b","blob","reader","FileReader","onload","onerror","readAsDataURL","arrayRemove","Timer","cancelFunc","tryCancel","handle","window","clearTimeout","setInterval","clearInterval","requestAnimationFrame","cancelAnimationFrame","BuildDOMCtx","dict","ctxOrDict","origctx","ctx","actions","executeAction","textContent","hidden","console","warn","buildDOM","buildDomCore","ttl","Error","createTextNode","Node","getDOM","tag","ele","reg","exec","substr","id","createElement","createElementFromTag","EnsureCtx","forEach","setDict","addUpdateAction","init","SettingItem","initial","onRender","types","serialize","deserialize","readFromStorage","localStorage","getItem","isInitial","set","fn","dontRaiseNow","data","oldFn","newFn","btn","prefix","bool","span","insertBefore","firstChild","render","thiz","removeItem","setItem","dontSave","save","curData","oldIndex","findIndex","newData","json","JSON","stringify","parse","Callbacks","list","args","_a","I18n","curLang","missing","Map","arg","get2","lang","langObj","log","r","has","langObjs","langs","line","j","elements","childNodes","nodeType","TEXT_NODE","beforeI18n","cur","curIdx","languages","navigator","language","l","createStringBuilder","i18n","formatCache","WeakMap","literals","placeholders","get","formatString","I","View","dom","parentView","_position","domctx","_dom","_onactive","_onActiveCbs","domExprCreated","position","domCreated","ensureDom","createDom","postCreateDom","updateDom","update","objectApply","toggleClass","view","appendView","onactive","handleKeyDown","code","preventDefault","HTMLElement","ContainerView","super","arguments","items","addView","_ensureItem","removeView","Symbol","iterator","arrayMap","arrayFind","dragManager","_currentItem","_currentArray","onDragStart","onDragEnd","currentItem","_b","_c","currentArray","invoke","ListViewItem","dragging","_selected","onSelectedChanged","enterctr","dragoverPlaceholder","listview","selectionHelper","dragData","selected","v","setAttribute","handleItemClicked","onItemClicked","_d","_e","_f","altKey","rect","getBoundingClientRect","mouseev","MouseEvent","clientX","left","clientY","top","relatedTarget","onContextMenu","offset","focus","selectedItems","sort","startArray","dataTransfer","setData","join","style","opacity","dragHandler","_g","_h","drop","source","target","sourceItems","accept","moveByDragging","selfInside","after","offsetHeight","newpos","it","move","dropEffect","onDragover","hover","placeholder","before","nextElementSibling","parentElement","ListView","container","SelectionHelper","onItemMoved","itemProvider","bind","draggable","keepSelected","toggleItemSelection","removeAll","clear","_enabled","onEnabledChanged","ctrlForceSelect","onSelectedItemsChanged","lastToggledItem","enabled","count","ctrlKey","shiftKey","toSelect","start","Overlay","centerChild","nobg","MenuItem","text","cls","onclick","tabIndex","ContextMenu","keepOpen","close","_lastcls","useOverlay","_visible","overlay","onClose","_originalFocused","visible","pageX","y","pageY","background","body","activeElement","width","offsetWidth","height","fadeout","Dialog","content","shown","btnTitle","TabBtn","active","clickable","btnClose","right","title","allowClose","showCloseButton","onShown","focusTrap","onClick","contentFlex","resizable","_ctx","_key","child","addBtn","setCenterChild","setNoBg","button","keyCode","tabables","querySelectorAll","listenPointerEvents","domheader","rectOverlay","numLimit","bottom","setOffset","updateWith","removeAllView","getView","parseFloat","_cancelFadeout","defaultParent","onDialogShowing","autoFocus","cancel","onDialogClosing","float","InputView","multiline","HTMLInputElement","TextView","ToastsContainer","parentDom","toasts","toast","show","default","Toast","timer","timeout","addToast","onFinished","removeToast","disabled","cancelled","onCancelled","oldData","dataDict","n","dataSelectId","itemDict","removed","d","selectId","updateItem","addItem","old","bgOverlay","dialogCount","dialog","editing","beforeEdit","onComplete","input","select","stopEdit","events","addEvent","evv","startEdit","pop","funcSetActive","current","label","dominput","_func","_value","computed","rawValue","_status","state","_text","_textdom","err","retry","error","reset","link","download","href","results","addBtnWithResult","addContent","waitClose","titleView","headerView","setTitle","setContent","addAction","queue","maxCount","runningCount","prom","res","queueMicrotask","shift","enter","exit","isCompositing"],"mappings":"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"}