{"version":3,"file":"webfx.min.js","sources":["../lib/utils.js","../lib/I18n.js","../lib/viewlib.js"],"sourcesContent":["// file: utils.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst _object_assign = Object.assign;\nconst _object_hasOwnProperty = Object.prototype.hasOwnProperty;\n/** The name \"utils\" tells it all. */\nexport var utils = new class Utils {\n    constructor() {\n        // Time & formatting utils:\n        this.fileSizeUnits = ['B', 'KB', 'MB', 'GB'];\n    }\n    strPadLeft(str, len, ch = ' ') {\n        while (str.length < len) {\n            str = ch + str;\n        }\n        return str;\n    }\n    formatTime(sec) {\n        if (typeof sec !== 'number' || isNaN(sec))\n            return '--:--';\n        sec = Math.round(sec);\n        var min = Math.floor(sec / 60);\n        sec %= 60;\n        return this.strPadLeft(min.toString(), 2, '0') + ':' + this.strPadLeft(sec.toString(), 2, '0');\n    }\n    formatFileSize(size) {\n        if (typeof size !== \"number\" || isNaN(size))\n            return 'NaN';\n        var unit = 0;\n        while (unit < this.fileSizeUnits.length - 1 && size >= 1024) {\n            unit++;\n            size /= 1024;\n        }\n        return size.toFixed(2) + ' ' + this.fileSizeUnits[unit];\n    }\n    formatDateTime(date) {\n        var now = new Date();\n        var sameday = date.getFullYear() === now.getFullYear()\n            && date.getMonth() === now.getMonth()\n            && date.getDate() === now.getDate();\n        return sameday ? date.toLocaleTimeString() : date.toLocaleString();\n    }\n    numLimit(num, min, max) {\n        return (num < min || typeof num != 'number' || isNaN(num)) ? min :\n            (num > max) ? max : num;\n    }\n    createName(nameFunc, existsFunc) {\n        for (let num = 0;; num++) {\n            let str = nameFunc(num);\n            if (!existsFunc(str))\n                return str;\n        }\n    }\n    /**\n     * btoa, but supports Unicode and uses UTF-8 encoding.\n     * @see https://stackoverflow.com/questions/30106476\n     */\n    base64EncodeUtf8(str) {\n        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {\n            return String.fromCharCode(('0x' + p1));\n        }));\n    }\n    sleepAsync(time) {\n        return new Promise((resolve) => {\n            setTimeout(resolve, time);\n        });\n    }\n    /** Remove all children from the node */\n    clearChildren(node) {\n        while (node.lastChild)\n            node.removeChild(node.lastChild);\n    }\n    /** Remove all children from the node (if needed) and append one (if present) */\n    replaceChild(node, newChild) {\n        this.clearChildren(node);\n        if (newChild)\n            node.appendChild(newChild);\n    }\n    /** Add or remove a classname for the element\n     * @param force - true -> add; false -> remove; undefined -> toggle.\n     */\n    toggleClass(element, clsName, force) {\n        var clsList = element.classList;\n        if (clsList.toggle)\n            return clsList.toggle(clsName, force);\n        if (force === undefined)\n            force = !clsList.contains(clsName);\n        if (force)\n            clsList.add(clsName);\n        else\n            clsList.remove(clsName);\n        return force;\n    }\n    /** Fade out the element and remove it */\n    fadeout(element) {\n        element.classList.add('fading-out');\n        var cb = null;\n        var end = () => {\n            if (!end)\n                return; // use a random variable as flag ;)\n            end = null;\n            element.removeEventListener('transitionend', onTransitionend);\n            element.classList.remove('fading-out');\n            element.remove();\n            cb && cb();\n        };\n        var onTransitionend = function (e) {\n            if (e.eventPhase === Event.AT_TARGET)\n                end();\n        };\n        element.addEventListener('transitionend', onTransitionend);\n        setTimeout(end, 350); // failsafe\n        return {\n            get finished() { return !end; },\n            onFinished(callback) {\n                if (!end)\n                    callback();\n                else\n                    cb = callback;\n            },\n            cancel() { end === null || end === void 0 ? void 0 : end(); }\n        };\n    }\n    listenPointerEvents(element, callback) {\n        element.addEventListener('mousedown', function (e) {\n            if (callback({ type: 'mouse', ev: e, point: e, action: 'down' }) === 'track') {\n                var mousemove = function (e) {\n                    callback({ type: 'mouse', ev: e, point: e, action: 'move' });\n                };\n                var mouseup = function (e) {\n                    document.removeEventListener('mousemove', mousemove, true);\n                    document.removeEventListener('mouseup', mouseup, true);\n                    callback({ type: 'mouse', ev: e, point: e, action: 'up' });\n                };\n                document.addEventListener('mousemove', mousemove, true);\n                document.addEventListener('mouseup', mouseup, true);\n            }\n        });\n        var touchDown = false;\n        element.addEventListener('touchstart', function (e) {\n            var ct = e.changedTouches[0];\n            var ret = callback({\n                type: 'touch', touch: 'start', ev: e, point: ct,\n                action: touchDown ? 'move' : 'down'\n            });\n            if (!touchDown && ret === 'track') {\n                touchDown = true;\n                var touchmove = function (e) {\n                    var ct = e.changedTouches[0];\n                    callback({ type: 'touch', touch: 'move', ev: e, point: ct, action: 'move' });\n                };\n                var touchend = function (e) {\n                    if (e.touches.length === 0) {\n                        touchDown = false;\n                        element.removeEventListener('touchmove', touchmove);\n                        element.removeEventListener('touchend', touchend);\n                    }\n                    var ct = e.changedTouches[0];\n                    callback({\n                        type: 'touch', touch: 'end', ev: e, point: ct,\n                        action: touchDown ? 'move' : 'up'\n                    });\n                };\n                element.addEventListener('touchmove', touchmove);\n                element.addEventListener('touchend', touchend);\n            }\n        });\n    }\n    addEvent(element, event, handler) {\n        element.addEventListener(event, handler);\n        return {\n            remove: () => element.removeEventListener(event, handler)\n        };\n    }\n    arrayRemove(array, val) {\n        for (let i = 0; i < array.length; i++) {\n            if (array[i] === val) {\n                array.splice(i, 1);\n                i--;\n            }\n        }\n    }\n    arrayInsert(array, val, pos) {\n        if (pos === undefined)\n            array.push(val);\n        else\n            array.splice(pos, 0, val);\n    }\n    arrayMap(arr, func) {\n        if (arr instanceof Array)\n            return arr.map(func);\n        var idx = 0;\n        var ret = new Array(arr.length);\n        for (var item of arr) {\n            ret[idx] = (func(item, idx));\n            idx++;\n        }\n        return ret;\n    }\n    arrayForeach(arr, func) {\n        var idx = 0;\n        for (var item of arr) {\n            func(item, idx++);\n        }\n    }\n    arrayFind(arr, func) {\n        if (arr instanceof Array)\n            return arr.find(func);\n        var idx = 0;\n        for (var item of arr) {\n            if (func(item, idx++))\n                return item;\n        }\n        return null;\n    }\n    arraySum(arr, func) {\n        var sum = 0;\n        this.arrayForeach(arr, (x) => {\n            var val = func(x);\n            if (val)\n                sum += val;\n        });\n        return sum;\n    }\n    objectApply(obj, kv, keys) {\n        if (kv) {\n            if (!keys)\n                return _object_assign(obj, kv);\n            for (const key in kv) {\n                if (_object_hasOwnProperty.call(kv, key) && (!keys || keys.indexOf(key) >= 0)) {\n                    const val = kv[key];\n                    obj[key] = val;\n                }\n            }\n        }\n        return obj;\n    }\n    mod(a, b) {\n        if (a < 0)\n            a = b + a;\n        return a % b;\n    }\n    readBlobAsDataUrl(blob) {\n        return new Promise((resolve, reject) => {\n            var reader = new FileReader();\n            reader.onload = (ev) => {\n                resolve(reader.result);\n            };\n            reader.onerror = (ev) => reject();\n            reader.readAsDataURL(blob);\n        });\n    }\n};\nArray.prototype.remove = function (item) {\n    utils.arrayRemove(this, item);\n};\nexport class Timer {\n    constructor(callback) {\n        this.callback = callback;\n        this.cancelFunc = undefined;\n    }\n    timeout(time) {\n        this.tryCancel();\n        var handle = setTimeout(this.callback, time);\n        this.cancelFunc = () => window.clearTimeout(handle);\n    }\n    interval(time) {\n        this.tryCancel();\n        var handle = setInterval(this.callback, time);\n        this.cancelFunc = () => window.clearInterval(handle);\n    }\n    animationFrame() {\n        this.tryCancel();\n        var handle = requestAnimationFrame(this.callback);\n        this.cancelFunc = () => cancelAnimationFrame(handle);\n    }\n    tryCancel() {\n        if (this.cancelFunc) {\n            this.cancelFunc();\n            this.cancelFunc = undefined;\n        }\n    }\n}\nutils.Timer = Timer;\nexport class BuildDOMCtx {\n    constructor(dict) {\n        this.dict = dict !== null && dict !== void 0 ? dict : {};\n    }\n    static EnsureCtx(ctxOrDict, origctx) {\n        var ctx;\n        if (ctxOrDict instanceof BuildDOMCtx)\n            ctx = ctxOrDict;\n        else\n            ctx = new BuildDOMCtx(ctxOrDict);\n        if (origctx) {\n            if (!origctx.actions)\n                origctx.actions = [];\n            ctx.actions = origctx.actions;\n        }\n        return ctx;\n    }\n    setDict(key, node) {\n        if (!this.dict)\n            this.dict = {};\n        this.dict[key] = node;\n    }\n    addUpdateAction(action) {\n        if (!this.actions)\n            this.actions = [];\n        this.actions.push(action);\n        // BuildDOMCtx.executeAction(action);\n    }\n    update() {\n        if (!this.actions)\n            return;\n        for (const a of this.actions) {\n            BuildDOMCtx.executeAction(a);\n        }\n    }\n    static executeAction(a) {\n        switch (a[0]) {\n            case 'text':\n                a[1].textContent = a[2]();\n                break;\n            case 'hidden':\n                a[1].hidden = a[2]();\n                break;\n            case 'update':\n                a[2](a[1]);\n                break;\n            default:\n                console.warn('unknown action', a);\n                break;\n        }\n    }\n}\nexport const buildDOM = utils.buildDOM = (() => {\n    var createElementFromTag = function (tag) {\n        var reg = /[#\\.^]?[\\w\\-]+/y;\n        var match;\n        var ele;\n        while (match = reg.exec(tag)) {\n            var val = match[0];\n            var ch = val[0];\n            if (ch === '.') {\n                ele.classList.add(val.substr(1));\n            }\n            else if (ch === '#') {\n                ele.id = val.substr(1);\n            }\n            else {\n                if (ele)\n                    throw new Error('unexpected multiple tags');\n                ele = document.createElement(val);\n            }\n        }\n        return ele;\n    };\n    var buildDomCore = function (obj, ttl, ctx) {\n        if (ttl-- < 0)\n            throw new Error('ran out of TTL');\n        if (typeof (obj) === 'string') {\n            return document.createTextNode(obj);\n        }\n        if (Node && obj instanceof Node)\n            return obj;\n        if ('getDOM' in obj)\n            return obj.getDOM();\n        const tag = obj.tag;\n        if (!tag)\n            throw new Error('no tag');\n        var node = createElementFromTag(tag);\n        if (obj['_ctx'])\n            ctx = BuildDOMCtx.EnsureCtx(obj['_ctx'], ctx);\n        for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                var val = obj[key];\n                if (key === 'child') {\n                    if (val instanceof Array) {\n                        val.forEach(function (x) {\n                            node.appendChild(buildDomCore(x, ttl, ctx));\n                        });\n                    }\n                    else {\n                        node.appendChild(buildDomCore(val, ttl, ctx));\n                    }\n                }\n                else if (key === '_key') {\n                    ctx.setDict(val, node);\n                }\n                else if (key === 'text') {\n                    if (typeof val === 'function') {\n                        ctx.addUpdateAction(['text', node, val]);\n                    }\n                    else {\n                        node.textContent = val;\n                    }\n                }\n                else if (key === 'hidden' && typeof val === 'function') {\n                    ctx.addUpdateAction(['hidden', node, val]);\n                }\n                else if (key === 'update' && typeof val === 'function') {\n                    ctx.addUpdateAction(['update', node, val]);\n                }\n                else if (key === 'init') {\n                    // no-op\n                }\n                else {\n                    node[key] = val;\n                }\n            }\n            const init = obj['init'];\n            if (init)\n                init(node);\n        }\n        return node;\n    };\n    return function (obj, ctx) {\n        return buildDomCore(obj, 32, ctx);\n    };\n})();\nexport class SettingItem {\n    constructor(key, type, initial) {\n        this.onRender = null;\n        this.key = key;\n        type = this.type = typeof type === 'string' ? SettingItem.types[type] : type;\n        if (!type || !type.serialize || !type.deserialize)\n            throw new Error(\"invalid 'type' arugment\");\n        this.readFromStorage(initial);\n    }\n    readFromStorage(initial) {\n        var str = this.key ? localStorage.getItem(this.key) : null;\n        this.isInitial = !str;\n        this.set(str ? this.type.deserialize(str) : initial, true);\n    }\n    render(fn, dontRaiseNow) {\n        if (!dontRaiseNow)\n            fn(this.data);\n        const oldFn = this.onRender;\n        const newFn = fn;\n        if (oldFn)\n            fn = function (x) { oldFn(x); newFn(x); };\n        this.onRender = fn;\n        return this;\n    }\n    bindToBtn(btn, prefix) {\n        if (this.type !== SettingItem.types.bool)\n            throw new Error('only for bool type');\n        var span = document.createElement('span');\n        btn.insertBefore(span, btn.firstChild);\n        this.render(function (x) {\n            btn.classList.toggle('disabled', !x);\n            prefix = prefix || [\"❌\", \"✅\"];\n            span.textContent = prefix[+x];\n        });\n        var thiz = this;\n        btn.addEventListener('click', function () { thiz.toggle(); });\n        return this;\n    }\n    remove() {\n        localStorage.removeItem(this.key);\n    }\n    save() {\n        this.isInitial = false;\n        localStorage.setItem(this.key, this.type.serialize(this.data));\n    }\n    set(data, dontSave) {\n        this.data = data;\n        this.isInitial = false;\n        this.onRender && this.onRender(data);\n        if (!dontSave && this.key)\n            this.save();\n    }\n    get() {\n        return this.data;\n    }\n    toggle() {\n        if (this.type !== SettingItem.types.bool)\n            throw new Error('only for bool type');\n        this.set((!this.data));\n    }\n    loop(arr) {\n        var curData = this.data;\n        var oldIndex = arr.findIndex(function (x) { return x === curData; });\n        var newData = arr[(oldIndex + 1) % arr.length];\n        this.set(newData);\n    }\n}\nSettingItem.types = {\n    bool: {\n        serialize: function (data) { return data ? 'true' : 'false'; },\n        deserialize: function (str) { return str === 'true' ? true : str === 'false' ? false : undefined; }\n    },\n    str: {\n        serialize: function (x) { return x; },\n        deserialize: function (x) { return x; }\n    },\n    json: {\n        serialize: function (x) { return JSON.stringify(x); },\n        deserialize: function (x) { return JSON.parse(x); }\n    }\n};\nexport class Callbacks {\n    constructor() {\n        this.list = null;\n    }\n    invoke(...args) {\n        if (this.list)\n            this.list.forEach((x) => x.apply(this, args));\n    }\n    add(callback) {\n        if (!this.list)\n            this.list = [];\n        this.list.push(callback);\n        return callback;\n    }\n    remove(callback) {\n        if (this.list)\n            this.list.remove(callback);\n    }\n}\nexport class Lazy {\n    constructor(func) {\n        this._func = func;\n        this._value = undefined;\n    }\n    get computed() { return !this._func; }\n    get rawValue() { return this._value; }\n    get value() {\n        if (this._func) {\n            this._value = this._func();\n            this._func = undefined;\n        }\n        return this._value;\n    }\n}\nexport class Semaphore {\n    constructor(init) {\n        this.queue = new Array();\n        this.maxCount = 1;\n        this.runningCount = 0;\n        utils.objectApply(this, init);\n    }\n    enter() {\n        if (this.runningCount === this.maxCount) {\n            var resolve;\n            var prom = new Promise((res) => { resolve = res; });\n            this.queue.push(resolve);\n            return prom;\n        }\n        else {\n            this.runningCount++;\n            return Promise.resolve();\n        }\n    }\n    exit() {\n        if (this.runningCount === this.maxCount && this.queue.length) {\n            if (window.queueMicrotask) {\n                window.queueMicrotask(this.queue.shift());\n            }\n            else {\n                setTimeout(this.queue.shift(), 0);\n            }\n        }\n        else {\n            this.runningCount--;\n        }\n    }\n    run(func) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.enter();\n            try {\n                yield func();\n            }\n            finally {\n                this.exit();\n            }\n        });\n    }\n}\n/** Just like CancellationToken[Source] on .NET */\nexport class CancelToken {\n    constructor() {\n        this.cancelled = false;\n        this.onCancelled = new Callbacks();\n    }\n    cancel() {\n        if (this.cancelled)\n            return;\n        this.cancelled = true;\n        this.onCancelled.invoke();\n    }\n    throwIfCancelled() {\n        if (this.cancelled)\n            throw new Error(\"operation cancelled.\");\n    }\n}\nexport class DataUpdatingHelper {\n    update(newData) {\n        const oldData = this.items;\n        var dataDict = {};\n        for (const n of newData) {\n            dataDict[this.dataSelectId(n)] = n;\n        }\n        var itemDict = {};\n        var removed = [];\n        for (const d of oldData) {\n            const id = this.selectId(d);\n            if (dataDict[id] !== undefined) {\n                itemDict[id] = d;\n            }\n            else {\n                removed.push(d);\n            }\n        }\n        for (let i = removed.length - 1; i >= 0; i--)\n            this.removeItem(removed[i]);\n        var pos = 0;\n        for (const n of newData) {\n            const d = itemDict[this.dataSelectId(n)];\n            if (d !== undefined) {\n                this.updateItem(d, n);\n            }\n            else {\n                this.addItem(n, pos);\n            }\n            pos++;\n        }\n    }\n    selectId(obj) { return obj.id; }\n    dataSelectId(obj) { return obj.id; }\n    addItem(obj, pos) { }\n    updateItem(old, data) { }\n    removeItem(obj) { }\n}\nexport class EventRegistrations {\n    constructor() {\n        this.list = [];\n    }\n    add(event, func) {\n        this.list.push({ event, func });\n        event.add(func);\n        return func;\n    }\n    removeAll() {\n        while (this.list.length) {\n            var r = this.list.pop();\n            r.event.remove(r.func);\n        }\n    }\n}\nexport class TextCompositionWatcher {\n    constructor(dom) {\n        this.isCompositing = false;\n        this.dom = dom.getDOM();\n        this.dom.addEventListener('compositionstart', (ev) => {\n            this.isCompositing = true;\n        });\n        this.dom.addEventListener('compositionend', (ev) => {\n            this.isCompositing = false;\n        });\n    }\n}\n","// file: I18n.ts\n/** Internationalization (aka i18n) helper class */\nexport class I18n {\n    constructor() {\n        this.data = {};\n        this.curLang = 'en';\n        this.missing = new Map();\n    }\n    /** Get i18n string for `key`, return `key` when not found. */\n    get(key, arg) {\n        return this.get2(key, arg) || key;\n    }\n    /** Get i18n string for `key`, return `null` when not found. */\n    get2(key, arg, lang) {\n        lang = lang || this.curLang;\n        var langObj = this.data[lang];\n        if (!langObj) {\n            console.log('i18n missing lang: ' + lang);\n            return null;\n        }\n        var r = langObj[key];\n        if (!r) {\n            if (!this.missing.has(key)) {\n                this.missing.set(key, 1);\n                console.log('i18n missing key: ' + key);\n            }\n            return null;\n        }\n        if (arg) {\n            for (const key in arg) {\n                if (arg.hasOwnProperty(key)) {\n                    const val = arg[key];\n                    r = r.replace('{' + key + '}', val);\n                    // Note that it only replaces the first occurrence.\n                }\n            }\n        }\n        return r;\n    }\n    /** Fills data with an 2darray */\n    add2dArray(array) {\n        const langObjs = [];\n        const langs = array[0];\n        for (const lang of langs) {\n            langObjs.push(this.data[lang] = this.data[lang] || {});\n        }\n        for (let i = 1; i < array.length; i++) {\n            const line = array[i];\n            const key = line[0];\n            for (let j = 0; j < line.length; j++) {\n                const val = line[j];\n                langObjs[j][key] = val;\n            }\n        }\n    }\n    renderElements(elements) {\n        console.log('i18n elements rendering');\n        elements.forEach(x => {\n            for (const node of x.childNodes) {\n                if (node.nodeType === Node.TEXT_NODE) {\n                    // console.log('node', node);\n                    var r = this.get2(node.beforeI18n || node.textContent);\n                    if (r) {\n                        node.beforeI18n = node.beforeI18n || node.textContent;\n                        node.textContent = r;\n                    }\n                    else {\n                        if (node.beforeI18n) {\n                            node.textContent = node.beforeI18n;\n                        }\n                        console.log('missing key for node', node);\n                    }\n                }\n            }\n        });\n    }\n    /**\n     * Detect the best available language using\n     * the user language preferences provided by the browser.\n     * @param langs Available languages\n     */\n    static detectLanguage(langs) {\n        var cur = null;\n        var curIdx = -1;\n        var languages = [];\n        // ['en-US'] -> ['en-US', 'en']\n        (navigator.languages || [navigator.language]).forEach(lang => {\n            languages.push(lang);\n            if (lang.indexOf('-') > 0)\n                languages.push(lang.substr(0, lang.indexOf('-')));\n        });\n        langs.forEach((l) => {\n            var idx = languages.indexOf(l);\n            if (!cur || (idx !== -1 && idx < curIdx)) {\n                cur = l;\n                curIdx = idx;\n            }\n        });\n        return cur || langs[0];\n    }\n}\nexport function createStringBuilder(i18n) {\n    var formatCache = new WeakMap();\n    return function (literals, ...placeholders) {\n        if (placeholders.length === 0) {\n            return i18n.get(literals[0]);\n        }\n        // Generate format string from template string if it's not cached:\n        let formatString = formatCache.get(literals);\n        if (formatString === undefined) {\n            formatString = '';\n            for (let i = 0; i < literals.length; i++) {\n                const lit = literals[i];\n                formatString += lit;\n                if (i < placeholders.length) {\n                    formatString += '{' + i + '}';\n                }\n            }\n            formatCache.set(literals, formatString);\n        }\n        var r = i18n.get(formatString);\n        for (var i = 0; i < placeholders.length; i++) {\n            r = r.replace('{' + i + '}', placeholders[i]);\n        }\n        return r;\n    };\n}\nexport var i18n = new I18n();\nexport const I = createStringBuilder(i18n);\n","// file: viewlib.ts\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { utils, Callbacks, Timer, BuildDOMCtx } from \"./utils\";\nimport { I, i18n } from \"./I18n\";\nexport class View {\n    constructor(dom) {\n        this.parentView = undefined;\n        this._position = undefined;\n        this.domctx = new BuildDOMCtx();\n        this._dom = undefined;\n        this._onactive = undefined;\n        this._onActiveCbs = undefined;\n        if (dom)\n            this.domExprCreated(dom);\n    }\n    static getView(obj) { return obj instanceof View ? obj : new View(obj); }\n    get position() { return this._position; }\n    get domCreated() { return !!this._dom; }\n    get dom() {\n        this.ensureDom();\n        return this._dom;\n    }\n    get hidden() { return this.dom.hidden; }\n    set hidden(val) { this.dom.hidden = val; }\n    ensureDom() {\n        if (!this._dom) {\n            var r = this.createDom();\n            this.domExprCreated(r);\n        }\n    }\n    domExprCreated(r) {\n        this._dom = utils.buildDOM(r, this.domctx);\n        this.postCreateDom();\n        this.updateDom();\n    }\n    createDom() {\n        return document.createElement('div');\n    }\n    /** Will be called when the dom is created */\n    postCreateDom() {\n    }\n    /** Will be called when the dom is created, after postCreateDom() */\n    updateDom() {\n        this.domctx.update();\n    }\n    /** Assign key-values and call `updateDom()` */\n    updateWith(kv) {\n        utils.objectApply(this, kv);\n        this.updateDom();\n    }\n    toggleClass(clsName, force) {\n        utils.toggleClass(this.dom, clsName, force);\n    }\n    appendView(view) { return this.dom.appendView(view); }\n    getDOM() { return this.dom; }\n    get onactive() { return this._onactive; }\n    set onactive(val) {\n        if (!!this._onactive !== !!val) {\n            if (val) {\n                this._onActiveCbs = [\n                    (e) => {\n                        this._onactive();\n                    },\n                    (e) => {\n                        this.handleKeyDown(e, this._onactive);\n                    }\n                ];\n                this.dom.addEventListener('click', this._onActiveCbs[0]);\n                this.dom.addEventListener('keydown', this._onActiveCbs[1]);\n            }\n            else {\n                this.dom.removeEventListener('click', this._onActiveCbs[0]);\n                this.dom.removeEventListener('keydown', this._onActiveCbs[1]);\n                this._onActiveCbs = undefined;\n            }\n        }\n        this._onactive = val;\n    }\n    handleKeyDown(e, onactive) {\n        if (e.code === 'Enter') {\n            onactive();\n            e.preventDefault();\n        }\n    }\n}\nHTMLElement.prototype.getDOM = function () { return this; };\nNode.prototype.appendView = function (view) {\n    this.appendChild(view.dom);\n};\nexport class ContainerView extends View {\n    constructor() {\n        super(...arguments);\n        this.items = [];\n    }\n    appendView(view) {\n        this.addView(view);\n    }\n    addView(view, pos) {\n        var _a;\n        const items = this.items;\n        if (view.parentView)\n            throw new Error('the view is already in a container view');\n        view.parentView = this;\n        if (pos === undefined) {\n            view._position = items.length;\n            items.push(view);\n            this.dom.appendChild(view.dom);\n        }\n        else {\n            items.splice(pos, 0, view);\n            this.dom.insertBefore(view.dom, ((_a = items[pos + 1]) === null || _a === void 0 ? void 0 : _a.dom) || null);\n            for (let i = pos; i < items.length; i++) {\n                items[i]._position = i;\n            }\n        }\n    }\n    removeView(view) {\n        view = this._ensureItem(view);\n        view.dom.remove();\n        var pos = view._position;\n        view.parentView = view._position = undefined;\n        this.items.splice(pos, 1);\n        for (let i = pos; i < this.items.length; i++) {\n            this.items[i]._position = i;\n        }\n    }\n    removeAllView() {\n        while (this.length)\n            this.removeView(this.length - 1);\n    }\n    updateChildrenDom() {\n        for (const item of this.items) {\n            item.updateDom();\n        }\n    }\n    _ensureItem(item) {\n        if (typeof item === 'number')\n            item = this.items[item];\n        else if (!item)\n            throw new Error('item is null or undefined.');\n        else if (item.parentView !== this)\n            throw new Error('the item is not in this listview.');\n        return item;\n    }\n    [Symbol.iterator]() { return this.items[Symbol.iterator](); }\n    get length() { return this.items.length; }\n    get(idx) {\n        return this.items[idx];\n    }\n    map(func) { return utils.arrayMap(this, func); }\n    find(func) { return utils.arrayFind(this, func); }\n    forEach(func) { return utils.arrayForeach(this, func); }\n}\n/** DragManager is used to help exchange information between views */\nexport var dragManager = new class DragManager {\n    constructor() {\n        /** The item being dragged */\n        this._currentItem = null;\n        this._currentArray = null;\n        this.onDragStart = new Callbacks();\n        this.onDragEnd = new Callbacks();\n    }\n    get currentItem() { var _a, _b, _c; return (_c = (_a = this._currentItem) !== null && _a !== void 0 ? _a : (_b = this._currentArray) === null || _b === void 0 ? void 0 : _b[0]) !== null && _c !== void 0 ? _c : null; }\n    ;\n    get currentArray() {\n        if (this._currentItem)\n            return [this._currentItem];\n        return this._currentArray;\n    }\n    start(item) {\n        this._currentItem = item;\n        console.log('drag start', item);\n        this.onDragStart.invoke();\n    }\n    startArray(arr) {\n        this._currentArray = arr;\n        console.log('drag start array', arr);\n        this.onDragStart.invoke();\n    }\n    end() {\n        this._currentItem = null;\n        this._currentArray = null;\n        console.log('drag end');\n        this.onDragEnd.invoke();\n    }\n};\nexport class ListViewItem extends View {\n    constructor() {\n        super(...arguments);\n        this.dragging = undefined;\n        this._selected = false;\n        this.onSelectedChanged = new Callbacks();\n        // https://stackoverflow.com/questions/7110353\n        this.enterctr = 0;\n        this.dragoverPlaceholder = null;\n    }\n    get listview() { return this.parentView; }\n    get selectionHelper() { return this.listview.selectionHelper; }\n    get dragData() { return this.dom.textContent; }\n    get selected() { return this._selected; }\n    set selected(v) {\n        this._selected = v;\n        this.domCreated && this.updateDom();\n        this.onSelectedChanged.invoke();\n    }\n    remove() {\n        if (!this.listview)\n            return;\n        this.listview.remove(this);\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.dom.setAttribute('role', 'listitem');\n        this.dom.addEventListener('click', (ev) => {\n            var _a, _b, _c;\n            if ((_a = this.listview) === null || _a === void 0 ? void 0 : _a.selectionHelper.handleItemClicked(this, ev))\n                return;\n            (_c = (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onItemClicked) === null || _c === void 0 ? void 0 : _c.call(_b, this);\n        });\n        this.dom.addEventListener('keydown', (ev) => {\n            var _a, _b, _c, _d, _e, _f;\n            if (ev.code === 'Enter') {\n                if (ev.altKey) {\n                    const rect = this.dom.getBoundingClientRect();\n                    const mouseev = new MouseEvent('contextmenu', {\n                        clientX: rect.left, clientY: rect.top,\n                        relatedTarget: this.dom\n                    });\n                    (_c = ((_a = this.onContextMenu) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onContextMenu)) === null || _c === void 0 ? void 0 : _c(this, mouseev);\n                }\n                else {\n                    if ((_d = this.listview) === null || _d === void 0 ? void 0 : _d.selectionHelper.handleItemClicked(this, ev))\n                        return;\n                    (_f = (_e = this.listview) === null || _e === void 0 ? void 0 : _e.onItemClicked) === null || _f === void 0 ? void 0 : _f.call(_e, this);\n                }\n                ev.preventDefault();\n            }\n            else if (this.listview && (ev.code === 'ArrowUp' || ev.code === 'ArrowDown')) {\n                var offset = ev.code === 'ArrowUp' ? -1 : 1;\n                var item = this.listview.get(this.position + offset);\n                if (item) {\n                    item.dom.focus();\n                    ev.preventDefault();\n                }\n            }\n        });\n        this.dom.addEventListener('contextmenu', (ev) => {\n            var _a, _b, _c;\n            (_c = ((_a = this.onContextMenu) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.onContextMenu)) === null || _c === void 0 ? void 0 : _c(this, ev);\n        });\n        this.dom.addEventListener('dragstart', (ev) => {\n            var _a, _b;\n            if (!((_a = this.dragging) !== null && _a !== void 0 ? _a : (_b = this.listview) === null || _b === void 0 ? void 0 : _b.dragging)) {\n                ev.preventDefault();\n                return;\n            }\n            var arr = [];\n            if (this.selected) {\n                arr = [...this.selectionHelper.selectedItems];\n                arr.sort((a, b) => a.position - b.position); // remove this line to get a new feature!\n            }\n            else {\n                arr = [this];\n            }\n            dragManager.startArray(arr);\n            ev.dataTransfer.setData('text/plain', arr.map(x => x.dragData).join('\\r\\n'));\n            arr.forEach(x => x.dom.style.opacity = '.5');\n        });\n        this.dom.addEventListener('dragend', (ev) => {\n            var arr = dragManager.currentArray;\n            dragManager.end();\n            ev.preventDefault();\n            arr.forEach(x => x.dom.style.opacity = '');\n        });\n        this.dom.addEventListener('dragover', (ev) => {\n            this.dragHandler(ev, 'dragover');\n        });\n        this.dom.addEventListener('dragenter', (ev) => {\n            this.dragHandler(ev, 'dragenter');\n        });\n        this.dom.addEventListener('dragleave', (ev) => {\n            this.dragHandler(ev, 'dragleave');\n        });\n        this.dom.addEventListener('drop', (ev) => {\n            this.dragHandler(ev, 'drop');\n        });\n    }\n    dragHandler(ev, type) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        const item = dragManager.currentItem;\n        let items = dragManager.currentArray;\n        const drop = type === 'drop';\n        const arg = {\n            source: item, target: this,\n            sourceItems: items,\n            event: ev, drop: drop,\n            accept: false\n        };\n        if (item instanceof ListViewItem) {\n            if (((_a = this.listview) === null || _a === void 0 ? void 0 : _a.moveByDragging) && item.listview === this.listview) {\n                ev.preventDefault();\n                const selfInside = (items.indexOf(this) >= 0);\n                const after = ev.clientY - this.dom.getBoundingClientRect().top > this.dom.offsetHeight / 2;\n                if (!(selfInside && drop))\n                    arg.accept = after ? 'move-after' : 'move';\n                if (!drop) {\n                    ev.dataTransfer.dropEffect = 'move';\n                }\n                else {\n                    if (items.indexOf(this) === -1) {\n                        let newpos = this.position;\n                        if (after)\n                            newpos++;\n                        for (const it of items) {\n                            if (it !== this) {\n                                if (newpos > it.position)\n                                    newpos--;\n                                this.listview.move(it, newpos);\n                                newpos++;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        const onDragover = (_b = this.onDragover) !== null && _b !== void 0 ? _b : (_c = this.listview) === null || _c === void 0 ? void 0 : _c.onDragover;\n        if (!arg.accept && onDragover) {\n            onDragover(arg);\n            if (drop || arg.accept)\n                ev.preventDefault();\n        }\n        const onContextMenu = (_d = this.onContextMenu) !== null && _d !== void 0 ? _d : (_e = this.listview) === null || _e === void 0 ? void 0 : _e.onContextMenu;\n        if (!arg.accept && item === this && onContextMenu) {\n            if (drop)\n                onContextMenu(this, ev);\n            else\n                ev.preventDefault();\n        }\n        if (type === 'dragenter' || type == 'dragover' || type === 'dragleave' || drop) {\n            if (type === 'dragenter') {\n                this.enterctr++;\n            }\n            else if (type === 'dragleave') {\n                this.enterctr--;\n            }\n            else if (type === 'drop') {\n                this.enterctr = 0;\n            }\n            let hover = this.enterctr > 0;\n            this.toggleClass('dragover', hover);\n            let placeholder = hover && (arg.accept === 'move' || arg.accept === 'move-after') && arg.accept;\n            if (placeholder != ((_g = (_f = this.dragoverPlaceholder) === null || _f === void 0 ? void 0 : _f[1]) !== null && _g !== void 0 ? _g : false)) {\n                (_h = this.dragoverPlaceholder) === null || _h === void 0 ? void 0 : _h[0].remove();\n                this.dragoverPlaceholder = null;\n                if (placeholder) {\n                    this.dragoverPlaceholder = [\n                        utils.buildDOM({ tag: 'div.dragover-placeholder' }),\n                        placeholder\n                    ];\n                    var before = this.dom;\n                    if (arg.accept === 'move-after')\n                        before = before.nextElementSibling;\n                    this.dom.parentElement.insertBefore(this.dragoverPlaceholder[0], before);\n                }\n            }\n        }\n    }\n    ;\n}\nexport class ListView extends ContainerView {\n    constructor(container) {\n        super(container);\n        // private items: Array<T> = [];\n        this.onItemClicked = null;\n        /**\n         * Allow user to drag an item.\n         */\n        this.dragging = false;\n        /**\n         * Allow user to drag an item and change its position.\n         */\n        this.moveByDragging = false;\n        this.selectionHelper = new SelectionHelper();\n        this.onItemMoved = null;\n        /**\n         * When dragover or drop\n         */\n        this.onDragover = null;\n        this.onContextMenu = null;\n        this.selectionHelper.itemProvider = this.get.bind(this);\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.dom.setAttribute('role', 'list');\n    }\n    add(item, pos) {\n        this.addView(item, pos);\n        if (this.dragging)\n            item.dom.draggable = true;\n    }\n    remove(item, keepSelected) {\n        item = this._ensureItem(item);\n        if (!keepSelected && item.selected)\n            this.selectionHelper.toggleItemSelection(item);\n        this.removeView(item);\n    }\n    move(item, newpos) {\n        var _a;\n        item = this._ensureItem(item);\n        this.remove(item, true);\n        this.add(item, newpos);\n        (_a = this.onItemMoved) === null || _a === void 0 ? void 0 : _a.call(this, item, item.position);\n    }\n    /** Remove all items */\n    removeAll() {\n        while (this.length)\n            this.remove(this.length - 1);\n    }\n    /** Remove all items and all DOM children */\n    clear() {\n        this.removeAll();\n        utils.clearChildren(this.dom);\n    }\n    ReplaceChild(dom) {\n        this.clear();\n        this.dom.appendChild(dom.getDOM());\n    }\n}\nexport class SelectionHelper {\n    constructor() {\n        this._enabled = false;\n        this.onEnabledChanged = new Callbacks();\n        this.itemProvider = null;\n        this.ctrlForceSelect = false;\n        this.selectedItems = [];\n        this.onSelectedItemsChanged = new Callbacks();\n        /** For shift-click */\n        this.lastToggledItem = null;\n    }\n    get enabled() { return this._enabled; }\n    set enabled(val) {\n        if (!!val === !!this._enabled)\n            return;\n        this._enabled = val;\n        while (this.selectedItems.length)\n            this.toggleItemSelection(this.selectedItems[0], false);\n        this.lastToggledItem = null;\n        this.onEnabledChanged.invoke();\n    }\n    get count() { return this.selectedItems.length; }\n    /** Returns true if it's handled by the helper. */\n    handleItemClicked(item, ev) {\n        if (!this.enabled) {\n            if (!this.ctrlForceSelect || !ev.ctrlKey)\n                return false;\n            this.enabled = true;\n        }\n        if (ev.shiftKey && this.lastToggledItem && this.itemProvider) {\n            var toSelect = !!this.lastToggledItem.selected;\n            var start = item.position, end = this.lastToggledItem.position;\n            if (start > end)\n                [start, end] = [end, start];\n            for (let i = start; i <= end; i++) {\n                this.toggleItemSelection(this.itemProvider(i), toSelect);\n            }\n            this.lastToggledItem = item;\n        }\n        else {\n            this.toggleItemSelection(item);\n        }\n        return true;\n    }\n    toggleItemSelection(item, force) {\n        if (force !== undefined && force === !!item.selected)\n            return;\n        if (item.selected) {\n            item.selected = false;\n            this.selectedItems.remove(item);\n            this.onSelectedItemsChanged.invoke('remove', item);\n        }\n        else {\n            item.selected = true;\n            this.selectedItems.push(item);\n            this.onSelectedItemsChanged.invoke('add', item);\n        }\n        this.lastToggledItem = item;\n        if (this.count === 0 && this.ctrlForceSelect)\n            this.enabled = false;\n    }\n}\nexport class ItemActiveHelper {\n    constructor(init) {\n        this.funcSetActive = (item, val) => item.toggleClass('active', val);\n        this.current = null;\n        utils.objectApply(this, init);\n    }\n    set(item) {\n        if (this.current === item)\n            return;\n        if (this.current)\n            this.funcSetActive(this.current, false);\n        this.current = item;\n        if (this.current)\n            this.funcSetActive(this.current, true);\n    }\n}\nexport class Section extends View {\n    constructor(arg) {\n        super();\n        this.titleView = new TextView({ tag: 'span.section-title' });\n        this.headerView = new View({\n            tag: 'div.section-header',\n            child: [\n                this.titleView\n            ]\n        });\n        this.ensureDom();\n        if (arg) {\n            if (arg.title)\n                this.setTitle(arg.title);\n            if (arg.content)\n                this.setContent(arg.content);\n            if (arg.actions)\n                arg.actions.forEach(x => this.addAction(x));\n        }\n    }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.section',\n            child: [\n                this.headerView\n            ]\n        };\n    }\n    setTitle(text) {\n        this.titleView.text = text;\n    }\n    setContent(view) {\n        var dom = this.dom;\n        var firstChild = dom.firstChild;\n        while (dom.lastChild !== firstChild)\n            dom.removeChild(dom.lastChild);\n        dom.appendChild(view.getDOM());\n    }\n    addAction(arg) {\n        var view = new View({\n            tag: 'div.section-action.clickable',\n            text: arg.text,\n            tabIndex: 0\n        });\n        view.onactive = arg.onclick;\n        this.headerView.dom.appendChild(view.dom);\n    }\n}\nexport class LoadingIndicator extends View {\n    constructor(init) {\n        super();\n        this._status = 'running';\n        this.onclick = null;\n        if (init)\n            utils.objectApply(this, init);\n    }\n    get state() { return this._status; }\n    set state(val) {\n        this._status = val;\n        ['running', 'error', 'normal'].forEach(x => this.toggleClass(x, val === x));\n    }\n    get content() { return this._text; }\n    set content(val) { this._text = val; this.ensureDom(); this._textdom.textContent = val; }\n    reset() {\n        this.state = 'running';\n        this.content = I `Loading`;\n        this.onclick = null;\n    }\n    error(err, retry) {\n        this.state = 'error';\n        this.content = I `Oh no! Something just goes wrong:` + '\\r\\n' + err;\n        if (retry) {\n            this.content += '\\r\\n' + I `[Click here to retry]`;\n        }\n        this.onclick = retry;\n    }\n    action(func) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield func();\n            }\n            catch (error) {\n                this.error(error, () => this.action(func));\n            }\n        });\n    }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.loading-indicator',\n            child: [{\n                    tag: 'div.loading-indicator-inner',\n                    child: [{ tag: 'div.loading-indicator-text', _key: '_textdom' }]\n                }],\n            onclick: (e) => this.onclick && this.onclick(e)\n        };\n    }\n    postCreateDom() {\n        this.reset();\n    }\n}\nexport class Overlay extends View {\n    createDom() {\n        return { tag: 'div.overlay' };\n    }\n    setCenterChild(centerChild) {\n        this.toggleClass('centerchild', centerChild);\n        return this;\n    }\n    setNoBg(nobg) {\n        this.toggleClass('nobg', nobg);\n        return this;\n    }\n}\nexport class EditableHelper {\n    constructor(element) {\n        this.editing = false;\n        this.beforeEdit = null;\n        this.onComplete = null;\n        this.element = element;\n    }\n    startEdit(onComplete) {\n        if (this.editing)\n            return;\n        this.editing = true;\n        var ele = this.element;\n        var beforeEdit = this.beforeEdit = ele.textContent;\n        utils.toggleClass(ele, 'editing', true);\n        var input = utils.buildDOM({\n            tag: 'input', type: 'text', value: beforeEdit\n        });\n        while (ele.firstChild)\n            ele.removeChild(ele.firstChild);\n        ele.appendChild(input);\n        input.select();\n        input.focus();\n        var stopEdit = () => {\n            var _a;\n            this.editing = false;\n            utils.toggleClass(ele, 'editing', false);\n            events.forEach(x => x.remove());\n            input.remove();\n            (_a = this.onComplete) === null || _a === void 0 ? void 0 : _a.call(this, input.value);\n            onComplete === null || onComplete === void 0 ? void 0 : onComplete(input.value);\n        };\n        var events = [\n            utils.addEvent(input, 'keydown', (evv) => {\n                if (evv.code === 'Enter') {\n                    stopEdit();\n                    evv.preventDefault();\n                }\n            }),\n            utils.addEvent(input, 'focusout', (evv) => { stopEdit(); }),\n        ];\n    }\n    startEditAsync() {\n        return new Promise((resolve) => this.startEdit(resolve));\n    }\n}\nexport class MenuItem extends ListViewItem {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.cls = 'normal';\n        this.onclick = null;\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'div.item.no-selection',\n            tabIndex: 0\n        };\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.onactive = () => {\n            var _a;\n            if (this.parentView instanceof ContextMenu) {\n                if (!this.parentView.keepOpen)\n                    this.parentView.close();\n            }\n            (_a = this.onclick) === null || _a === void 0 ? void 0 : _a.call(this);\n        };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n        if (this.cls !== this._lastcls) {\n            if (this._lastcls)\n                this.dom.classList.remove(this._lastcls);\n            if (this.cls)\n                this.dom.classList.add(this.cls);\n        }\n    }\n}\nexport class MenuLinkItem extends MenuItem {\n    constructor(init) {\n        super(init);\n        this.link = '';\n        this.download = '';\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        var dom = super.createDom();\n        dom.tag = 'a.item.no-selection';\n        dom.target = \"_blank\";\n        return dom;\n    }\n    updateDom() {\n        super.updateDom();\n        this.dom.href = this.link;\n        this.dom.download = this.download;\n    }\n}\nexport class MenuInfoItem extends MenuItem {\n    constructor(init) {\n        super(init);\n        this.text = '';\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'div.menu-info'\n        };\n    }\n    updateDom() {\n        super.updateDom();\n        this.dom.textContent = this.text;\n    }\n}\nexport class ContextMenu extends ListView {\n    constructor(items) {\n        super({ tag: 'div.context-menu', tabIndex: 0 });\n        this.keepOpen = false;\n        this.useOverlay = true;\n        this._visible = false;\n        this.overlay = null;\n        this._onclose = null;\n        this._originalFocused = null;\n        items === null || items === void 0 ? void 0 : items.forEach(x => this.add(x));\n    }\n    get visible() { return this._visible; }\n    ;\n    show(arg) {\n        if ('ev' in arg)\n            arg = {\n                x: arg.ev.pageX,\n                y: arg.ev.pageY\n            };\n        this.close();\n        this._visible = true;\n        if (this.useOverlay) {\n            if (!this.overlay) {\n                this.overlay = new Overlay();\n                this.overlay.dom.style.background = 'rgba(0, 0, 0, .1)';\n                this.overlay.dom.addEventListener('mousedown', (ev) => {\n                    if (ev.eventPhase !== Event.AT_TARGET)\n                        return;\n                    ev.preventDefault();\n                    this.close();\n                });\n            }\n            this.overlay.appendView(this);\n            document.body.appendChild(this.overlay.dom);\n        }\n        else {\n            document.body.appendChild(this.dom);\n        }\n        this._originalFocused = document.activeElement;\n        this.dom.focus();\n        var onfocusout = (e) => {\n            !this.dom.contains(e.relatedTarget) && this.close();\n        };\n        var onkeydown = (e) => {\n            if (e.code === 'Escape') {\n                e.preventDefault();\n                this.close();\n            }\n        };\n        this.dom.addEventListener('focusout', onfocusout);\n        this.dom.addEventListener('keydown', onkeydown);\n        this._onclose = () => {\n            this.dom.removeEventListener('focusout', onfocusout);\n            this.dom.removeEventListener('keydown', onkeydown);\n        };\n        var width = this.dom.offsetWidth, height = this.dom.offsetHeight;\n        if (arg.x + width > document.body.offsetWidth)\n            arg.x -= width;\n        if (arg.y + height > document.body.offsetHeight)\n            arg.y -= height;\n        if (arg.x < 0)\n            arg.x = 0;\n        if (arg.y < 0)\n            arg.y = 0;\n        this.dom.style.left = arg.x + 'px';\n        this.dom.style.top = arg.y + 'px';\n    }\n    close() {\n        var _a, _b, _c;\n        if (this._visible) {\n            this._visible = false;\n            (_a = this._onclose) === null || _a === void 0 ? void 0 : _a.call(this);\n            this._onclose = null;\n            (_c = (_b = this._originalFocused) === null || _b === void 0 ? void 0 : _b['focus']) === null || _c === void 0 ? void 0 : _c.call(_b);\n            this._originalFocused = null;\n            if (this.overlay)\n                utils.fadeout(this.overlay.dom);\n            utils.fadeout(this.dom);\n        }\n    }\n}\nexport class Dialog extends View {\n    constructor() {\n        super();\n        this.content = new ContainerView({ tag: 'div.dialog-content' });\n        this.shown = false;\n        this.btnTitle = new TabBtn({ active: true, clickable: false });\n        this.btnClose = new TabBtn({ text: I `Close`, right: true });\n        this.title = 'Dialog';\n        this.allowClose = true;\n        this.showCloseButton = true;\n        this.onShown = new Callbacks();\n        this.onClose = new Callbacks();\n        this.focusTrap = new View({ tag: 'div.focustrap', tabIndex: 0 });\n        this.btnClose.onClick.add(() => this.allowClose && this.close());\n    }\n    get width() { return this.dom.style.width; }\n    set width(val) { this.dom.style.width = val; }\n    get contentFlex() { return this.content.dom.classList.contains('flex'); }\n    set contentFlex(val) { this.content.toggleClass('flex', !!val); }\n    get resizable() { return this.dom.classList.contains('resize'); }\n    set resizable(val) { this.toggleClass('resize', !!val); }\n    createDom() {\n        return {\n            _ctx: this,\n            _key: 'dialog',\n            tag: 'div.dialog',\n            tabIndex: 0,\n            style: 'width: 300px',\n            child: [\n                {\n                    _key: 'domheader',\n                    tag: 'div.dialog-title',\n                    child: [\n                        { tag: 'div', style: 'clear: both;' }\n                    ]\n                },\n                this.content,\n                this.focusTrap\n            ]\n        };\n    }\n    postCreateDom() {\n        super.postCreateDom();\n        this.addBtn(this.btnTitle);\n        this.addBtn(this.btnClose);\n        this.overlay = new Overlay().setCenterChild(true).setNoBg(true);\n        this.overlay.dom.appendView(this);\n        this.overlay.dom.addEventListener('mousedown', (ev) => {\n            if (this.allowClose && ev.button === 0 && ev.target === this.overlay.dom) {\n                ev.preventDefault();\n                this.close();\n            }\n        });\n        this.overlay.dom.addEventListener('keydown', (ev) => {\n            if (this.allowClose && ev.keyCode === 27) { // ESC\n                ev.preventDefault();\n                this.close();\n            }\n            else if (ev.target === this.dom && ev.code === 'Tab' && ev.shiftKey) {\n                ev.preventDefault();\n                let tabables = this.dom.querySelectorAll('a, [tabindex]');\n                if (tabables.length >= 2 && tabables[tabables.length - 2]['focus']) {\n                    // the last tabable is `focusTrap`, so the index used here is `length - 2`\n                    tabables[tabables.length - 2]['focus']();\n                }\n            }\n        });\n        // title bar pointer event handler:\n        {\n            let offset;\n            utils.listenPointerEvents(this.domheader, (e) => {\n                if (e.action === 'down') {\n                    if (e.ev.target !== this.domheader && e.ev.target !== this.btnTitle.dom)\n                        return;\n                    e.ev.preventDefault();\n                    const rectOverlay = this.overlay.dom.getBoundingClientRect();\n                    const rect = this.dom.getBoundingClientRect();\n                    offset = {\n                        x: e.point.pageX - rectOverlay.x - rect.x,\n                        y: e.point.pageY - rectOverlay.y - rect.y\n                    };\n                    return 'track';\n                }\n                else if (e.action === 'move') {\n                    e.ev.preventDefault();\n                    const rect = this.overlay.dom.getBoundingClientRect();\n                    const pageX = utils.numLimit(e.point.pageX, rect.left, rect.right);\n                    const pageY = utils.numLimit(e.point.pageY, rect.top, rect.bottom);\n                    this.setOffset(pageX - offset.x, pageY - offset.y);\n                }\n            });\n        }\n        this.dom.addEventListener('resize', () => {\n            if (this.dom.style.width)\n                this.width = this.dom.style.width;\n        });\n        this.focusTrap.dom.addEventListener('focus', (ev) => {\n            this.dom.focus();\n        });\n    }\n    updateDom() {\n        this.btnTitle.updateWith({ text: this.title });\n        this.btnTitle.hidden = !this.title;\n        this.btnClose.hidden = !(this.allowClose && this.showCloseButton);\n    }\n    addBtn(btn) {\n        this.ensureDom();\n        this.domheader.insertBefore(btn.dom, this.domheader.lastChild);\n    }\n    addContent(view, replace) {\n        this.ensureDom();\n        if (replace)\n            this.content.removeAllView();\n        this.content.appendView(View.getView(view));\n    }\n    setOffset(x, y) {\n        this.dom.style.left = x ? x + 'px' : '';\n        this.dom.style.top = y ? y + 'px' : '';\n        this.overlay.setCenterChild(false);\n    }\n    getOffset() {\n        var x = this.dom.style.left ? parseFloat(this.dom.style.left) : 0;\n        var y = this.dom.style.top ? parseFloat(this.dom.style.top) : 0;\n        return { x, y };\n    }\n    center() {\n        this.setOffset(0, 0);\n        this.overlay.setCenterChild(true);\n    }\n    show() {\n        var _a;\n        if (this.shown)\n            return;\n        this.shown = true;\n        (_a = this._cancelFadeout) === null || _a === void 0 ? void 0 : _a.call(this);\n        this.ensureDom();\n        Dialog.defaultParent.onDialogShowing(this);\n        this.dom.focus();\n        (this.autoFocus || this).dom.focus();\n        this.onShown.invoke();\n    }\n    close() {\n        if (!this.shown)\n            return;\n        this.shown = false;\n        this.onClose.invoke();\n        this._cancelFadeout = utils.fadeout(this.overlay.dom).cancel;\n        Dialog.defaultParent.onDialogClosing(this);\n    }\n    waitClose() {\n        return new Promise((resolve) => {\n            var cb = this.onClose.add(() => {\n                this.onClose.remove(cb);\n                resolve();\n            });\n        });\n    }\n}\nexport class DialogParent extends View {\n    constructor(dom) {\n        super(dom !== null && dom !== void 0 ? dom : document.body);\n        this.bgOverlay = new Overlay();\n        this.dialogCount = 0;\n        this._cancelFadeout = null;\n    }\n    onDialogShowing(dialog) {\n        var _a;\n        if (this.dialogCount++ === 0) {\n            (_a = this._cancelFadeout) === null || _a === void 0 ? void 0 : _a.call(this);\n            this.appendView(this.bgOverlay);\n        }\n        this.appendView(dialog.overlay);\n    }\n    onDialogClosing(dialog) {\n        if (--this.dialogCount === 0) {\n            this._cancelFadeout = utils.fadeout(this.bgOverlay.dom).cancel;\n        }\n    }\n}\nexport class TabBtn extends View {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.clickable = true;\n        this.active = false;\n        this.right = false;\n        this.onclick = null;\n        this.onClick = new Callbacks();\n        utils.objectApply(this, init);\n    }\n    createDom() {\n        return {\n            tag: 'span.tab.no-selection'\n        };\n    }\n    postCreateDom() {\n        this.onactive = () => {\n            var _a;\n            (_a = this.onclick) === null || _a === void 0 ? void 0 : _a.call(this);\n            this.onClick.invoke();\n        };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n        this.dom.tabIndex = this.clickable ? 0 : -1;\n        this.toggleClass('clickable', this.clickable);\n        this.toggleClass('active', this.active);\n        this.dom.style.float = this.right ? 'right' : 'left';\n    }\n}\nexport class InputView extends View {\n    constructor(init) {\n        super();\n        this.multiline = false;\n        this.type = 'text';\n        this.placeholder = '';\n        utils.objectApply(this, init);\n    }\n    get value() { return this.dom.value; }\n    set value(val) { this.dom.value = val; }\n    createDom() {\n        return this.multiline ? { tag: 'textarea.input-text' } : { tag: 'input.input-text' };\n    }\n    updateDom() {\n        super.updateDom();\n        if (this.dom instanceof HTMLInputElement) {\n            this.dom.type = this.type;\n            this.dom.placeholder = this.placeholder;\n        }\n    }\n}\nexport class TextView extends View {\n    get text() { return this.dom.textContent; }\n    set text(val) { this.dom.textContent = val; }\n}\nexport class ButtonView extends TextView {\n    constructor(init) {\n        super();\n        this.disabled = false;\n        this.type = 'normal';\n        utils.objectApply(this, init);\n        this.updateDom();\n    }\n    get onclick() { return this.onactive; }\n    set onclick(val) { this.onactive = val; }\n    createDom() {\n        return { tag: 'div.btn', tabIndex: 0 };\n    }\n    updateDom() {\n        super.updateDom();\n        this.toggleClass('disabled', this.disabled);\n        this.toggleClass('btn-big', this.type === 'big');\n    }\n}\nexport class LabeledInput extends View {\n    constructor(init) {\n        super();\n        this.label = '';\n        this.type = 'text';\n        this.input = new InputView();\n        utils.objectApply(this, init);\n    }\n    get dominput() { return this.input.dom; }\n    get value() { return this.dominput.value; }\n    set value(val) { this.dominput.value = val; }\n    createDom() {\n        return {\n            _ctx: this,\n            tag: 'div.labeled-input',\n            child: [\n                { tag: 'div.input-label', text: () => this.label },\n                this.input\n            ]\n        };\n    }\n    updateDom() {\n        super.updateDom();\n        this.input.type = this.type;\n        this.input.domCreated && this.input.updateDom();\n    }\n}\nexport class ToastsContainer extends View {\n    constructor() {\n        super(...arguments);\n        this.parentDom = null;\n        this.toasts = [];\n    }\n    createDom() {\n        return { tag: 'div.toasts-container' };\n    }\n    addToast(toast) {\n        if (this.toasts.length === 0)\n            this.show();\n        this.toasts.push(toast);\n    }\n    removeToast(toast) {\n        this.toasts.remove(toast);\n        if (this.toasts.length === 0)\n            this.remove();\n    }\n    show() {\n        var parent = this.parentDom || document.body;\n        parent.appendChild(this.dom);\n    }\n    remove() {\n        this.dom.remove();\n    }\n}\nToastsContainer.default = new ToastsContainer();\nexport class Toast extends View {\n    constructor(init) {\n        super();\n        this.text = '';\n        this.shown = false;\n        this.timer = new Timer(() => this.close());\n        utils.objectApply(this, init);\n        if (!this.container)\n            this.container = ToastsContainer.default;\n    }\n    show(timeout) {\n        if (!this.shown) {\n            this.container.addToast(this);\n            this.container.appendView(this);\n            this.shown = true;\n        }\n        if (timeout)\n            this.timer.timeout(timeout);\n        else\n            this.timer.tryCancel();\n    }\n    close() {\n        if (!this.shown)\n            return;\n        this.shown = false;\n        utils.fadeout(this.dom)\n            .onFinished(() => this.container.removeToast(this));\n    }\n    createDom() {\n        return { tag: 'div.toast' };\n    }\n    updateDom() {\n        this.dom.textContent = this.text;\n    }\n    static show(text, timeout) {\n        var toast = new Toast({ text });\n        toast.show(timeout);\n        return toast;\n    }\n}\nexport class MessageBox extends Dialog {\n    constructor() {\n        super(...arguments);\n        this.allowClose = false;\n        this.title = 'Message';\n        this.result = 'none';\n    }\n    addResultBtns(results) {\n        for (const r of results) {\n            this.addBtnWithResult(new TabBtn({ text: i18n.get('msgbox_' + r), right: true }), r);\n        }\n        return this;\n    }\n    setTitle(title) {\n        this.title = title;\n        if (this.domCreated)\n            this.updateDom();\n        return this;\n    }\n    addText(text) {\n        this.addContent(new TextView({ tag: 'div.messagebox-text', textContent: text }));\n        return this;\n    }\n    allowCloseWithResult(result, showCloseButton) {\n        this.result = result;\n        this.allowClose = true;\n        this.showCloseButton = !!showCloseButton;\n        if (this.domCreated)\n            this.updateDom();\n        return this;\n    }\n    addBtnWithResult(btn, result) {\n        btn.onClick.add(() => { this.result = result; this.close(); });\n        this.addBtn(btn);\n        return this;\n    }\n    showAndWaitResult() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.show();\n            yield this.waitClose();\n            return this.result;\n        });\n    }\n}\n"],"names":["__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","_object_assign","Object","assign","_object_hasOwnProperty","prototype","hasOwnProperty","utils","[object Object]","fileSizeUnits","str","len","ch","length","sec","isNaN","Math","round","min","floor","strPadLeft","toString","size","unit","toFixed","date","now","Date","getFullYear","getMonth","getDate","toLocaleTimeString","toLocaleString","num","max","nameFunc","existsFunc","btoa","encodeURIComponent","replace","match","p1","String","fromCharCode","time","setTimeout","node","lastChild","removeChild","newChild","clearChildren","appendChild","element","clsName","force","clsList","classList","toggle","undefined","contains","add","remove","cb","end","removeEventListener","onTransitionend","eventPhase","Event","AT_TARGET","addEventListener","finished","callback","type","ev","point","action","mousemove","mouseup","document","touchDown","ct","changedTouches","ret","touch","touchmove","touchend","touches","event","handler","array","val","i","splice","pos","push","arr","func","Array","map","idx","item","find","sum","arrayForeach","x","obj","kv","keys","key","call","indexOf","a","b","blob","reader","FileReader","onload","onerror","readAsDataURL","arrayRemove","Timer","cancelFunc","tryCancel","handle","window","clearTimeout","setInterval","clearInterval","requestAnimationFrame","cancelAnimationFrame","BuildDOMCtx","dict","ctxOrDict","origctx","ctx","actions","executeAction","textContent","hidden","console","warn","buildDOM","buildDomCore","ttl","Error","createTextNode","Node","getDOM","tag","ele","reg","exec","substr","id","createElement","createElementFromTag","EnsureCtx","forEach","setDict","addUpdateAction","init","SettingItem","initial","onRender","types","serialize","deserialize","readFromStorage","localStorage","getItem","isInitial","set","fn","dontRaiseNow","data","oldFn","newFn","btn","prefix","bool","span","insertBefore","firstChild","render","thiz","removeItem","setItem","dontSave","save","curData","oldIndex","findIndex","newData","json","JSON","stringify","parse","Callbacks","list","args","I18n","curLang","missing","Map","arg","get2","lang","langObj","log","r","has","langObjs","langs","line","j","elements","childNodes","nodeType","TEXT_NODE","beforeI18n","cur","curIdx","languages","navigator","language","l","createStringBuilder","i18n","formatCache","WeakMap","literals","placeholders","get","formatString","I","View","dom","parentView","_position","domctx","_dom","_onactive","_onActiveCbs","domExprCreated","position","domCreated","ensureDom","createDom","postCreateDom","updateDom","update","objectApply","toggleClass","view","appendView","onactive","handleKeyDown","code","preventDefault","HTMLElement","ContainerView","super","arguments","items","addView","_a","_ensureItem","removeView","Symbol","iterator","arrayMap","arrayFind","dragManager","_currentItem","_currentArray","onDragStart","onDragEnd","currentItem","_b","_c","currentArray","invoke","ListViewItem","dragging","_selected","onSelectedChanged","enterctr","dragoverPlaceholder","listview","selectionHelper","dragData","selected","v","setAttribute","handleItemClicked","onItemClicked","_d","_e","_f","altKey","rect","getBoundingClientRect","mouseev","MouseEvent","clientX","left","clientY","top","relatedTarget","onContextMenu","offset","focus","selectedItems","sort","startArray","dataTransfer","setData","join","style","opacity","dragHandler","_g","_h","drop","source","target","sourceItems","accept","moveByDragging","selfInside","after","offsetHeight","newpos","it","move","dropEffect","onDragover","hover","placeholder","before","nextElementSibling","parentElement","ListView","container","SelectionHelper","onItemMoved","itemProvider","bind","draggable","keepSelected","toggleItemSelection","removeAll","clear","_enabled","onEnabledChanged","ctrlForceSelect","onSelectedItemsChanged","lastToggledItem","enabled","count","ctrlKey","shiftKey","toSelect","start","Overlay","centerChild","nobg","MenuItem","text","cls","onclick","tabIndex","ContextMenu","keepOpen","close","_lastcls","useOverlay","_visible","overlay","_onclose","_originalFocused","visible","pageX","y","pageY","background","body","activeElement","onfocusout","onkeydown","width","offsetWidth","height","fadeout","Dialog","content","shown","btnTitle","TabBtn","active","clickable","btnClose","right","title","allowClose","showCloseButton","onShown","onClose","focusTrap","onClick","contentFlex","resizable","_ctx","_key","child","addBtn","setCenterChild","setNoBg","button","keyCode","tabables","querySelectorAll","listenPointerEvents","domheader","rectOverlay","numLimit","bottom","setOffset","updateWith","removeAllView","getView","parseFloat","_cancelFadeout","defaultParent","onDialogShowing","autoFocus","cancel","onDialogClosing","float","InputView","multiline","HTMLInputElement","TextView","ToastsContainer","parentDom","toasts","toast","show","default","Toast","timer","timeout","addToast","onFinished","removeToast","disabled","cancelled","onCancelled","oldData","dataDict","n","dataSelectId","itemDict","removed","d","selectId","updateItem","addItem","old","bgOverlay","dialogCount","dialog","editing","beforeEdit","onComplete","input","select","stopEdit","events","addEvent","evv","startEdit","pop","funcSetActive","current","label","dominput","_func","_value","computed","rawValue","_status","state","_text","_textdom","err","retry","error","reset","link","download","href","results","addBtnWithResult","addContent","waitClose","titleView","headerView","setTitle","setContent","addAction","queue","maxCount","runningCount","prom","res","queueMicrotask","shift","enter","exit","isCompositing"],"mappings":"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"}